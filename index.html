<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurant Menu Builder Pro</title>
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+Arabic:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .rtl {
            direction: rtl;
            font-family: 'Noto Sans Arabic', sans-serif;
        }
        
        .section {
            display: none;
        }
        
        .section.active {
            display: block;
            animation: fadeIn 0.5s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-30px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .animate-fade-in { animation: fadeIn 0.6s ease-out; }
        .animate-slide-in { animation: slideIn 0.5s ease-out; }
        .animate-float { animation: float 3s ease-in-out infinite; }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 14px;
            text-decoration: none;
            border: none;
            outline: none;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: white;
            color: #374151;
            border: 2px solid #e5e7eb;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .btn-secondary:hover {
            background: #f9fafb;
            border-color: #9ca3af;
            transform: translateY(-1px);
        }
        
        .btn-ghost {
            background: transparent;
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .btn-ghost:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.4);
        }
        
        .input-field {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 16px;
            background: white;
            transition: all 0.3s ease;
        }
        
        .input-field:focus {
            border-color: #667eea;
            outline: none;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            transform: translateY(-1px);
        }
        
        .card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            overflow: hidden;
        }
        
        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
        }
        
        .template-card {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .template-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }
        
        .menu-item-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 16px 0;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
        }
        
        .menu-item-card:hover {
            transform: translateX(8px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            border-left-color: #667eea;
        }
        
        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            padding: 16px 24px;
        }
        
        .nav-btn {
            background: transparent;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .nav-btn.active {
            background: #667eea;
            color: white;
        }
        
        .nav-btn:hover:not(.active) {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
        }
        
        .upload-area {
            border: 2px dashed #d1d5db;
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f9fafb;
        }
        
        .upload-area:hover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.05);
        }
        
        .upload-area.dragover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
        }
        
        .preview-frame {
            border: 8px solid #374151;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            position: relative;
            background: white;
        }
        
        .preview-frame.mobile {
            width: 375px;
            height: 812px;
            border-radius: 40px;
        }
        
        .preview-frame.desktop {
            width: 1000px;
            height: 600px;
            border-radius: 12px;
        }
        
        .loader {
            width: 32px;
            height: 32px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .main-content {
            padding-top: 80px;
            min-height: 100vh;
        }
        
        .sidebar {
            background: white;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            height: calc(100vh - 80px);
            overflow-y: auto;
        }
        
        /* Font classes */
        .font-inter { font-family: 'Inter', sans-serif; }
        .font-poppins { font-family: 'Poppins', sans-serif; }
        .font-playfair { font-family: 'Playfair Display', serif; }
        .font-arabic { font-family: 'Noto Sans Arabic', sans-serif; }
        
        /* Color themes */
        .theme-modern { --primary: #667eea; --secondary: #764ba2; }
        .theme-elegant { --primary: #8b5cf6; --secondary: #a855f7; }
        .theme-nature { --primary: #10b981; --secondary: #059669; }
        .theme-sunset { --primary: #f59e0b; --secondary: #d97706; }
        
        /* Hide scrollbar but keep functionality */
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="flex items-center justify-between max-w-7xl mx-auto">
            <div class="flex items-center gap-4">
                <h1 class="text-xl font-bold text-gray-800">üçΩÔ∏è Menu Builder Pro</h1>
            </div>
            <div class="flex items-center gap-2">
                <button class="nav-btn active" onclick="showSection('login')" id="nav-login">Login</button>
                <button class="nav-btn" onclick="showSection('dashboard')" id="nav-dashboard">Dashboard</button>
                <button class="nav-btn" onclick="showSection('builder')" id="nav-builder">Builder</button>
                <button class="nav-btn" onclick="showSection('preview')" id="nav-preview">Preview</button>
                <button class="btn btn-secondary btn-sm" onclick="toggleLanguage()" id="lang-toggle">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="main-content">
        <!-- LOGIN SECTION -->
        <section id="login-section" class="section active">
            <div class="min-h-screen flex items-center justify-center p-8">
                <div class="glass-effect rounded-2xl p-8 w-full max-w-md animate-fade-in">
                    <div class="text-center mb-8">
                        <div class="text-6xl mb-4 animate-float">üçΩÔ∏è</div>
                        <h1 class="text-3xl font-bold text-white mb-2">Welcome to Menu Builder Pro</h1>
                        <p class="text-white opacity-80">Create beautiful restaurant menus with ease</p>
                    </div>

                    <form class="space-y-6" onsubmit="handleLogin(event)">
                        <div>
                            <label class="block text-white text-sm font-semibold mb-2">Email Address</label>
                            <input type="email" class="input-field" placeholder="your@email.com" required>
                        </div>

                        <div>
                            <label class="block text-white text-sm font-semibold mb-2">Password</label>
                            <input type="password" class="input-field" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                        </div>

                        <button type="submit" class="btn btn-primary w-full">Sign In</button>

                        <div class="relative">
                            <div class="absolute inset-0 flex items-center">
                                <div class="w-full border-t border-white border-opacity-30"></div>
                            </div>
                            <div class="relative flex justify-center text-sm">
                                <span class="px-2 bg-transparent text-white opacity-70">or</span>
                            </div>
                        </div>

                        <button type="button" class="btn btn-ghost w-full" onclick="guestLogin()">
                            <span class="mr-2">üë§</span>
                            Continue as Guest
                        </button>

                        <div class="text-center">
                            <span class="text-white opacity-70">Don't have an account?</span>
                            <button type="button" class="ml-2 text-white font-semibold hover:underline" onclick="toggleAuthMode()">
                                Sign Up
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </section>

        <!-- DASHBOARD SECTION -->
        <section id="dashboard-section" class="section">
            <div class="min-h-screen p-8">
                <div class="max-w-7xl mx-auto">
                    <div class="text-center mb-12 animate-fade-in">
                        <h1 class="text-5xl font-bold text-white mb-4">Welcome back, User!</h1>
                        <p class="text-xl text-white opacity-80">Create and manage your restaurant menus</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-12">
                        <div class="card p-8 text-center animate-slide-in">
                            <div class="text-4xl mb-4">‚ú®</div>
                            <h3 class="text-xl font-bold mb-4">Create New Menu</h3>
                            <p class="text-gray-600 mb-6">Start fresh with a new menu design</p>
                            <button class="btn btn-primary w-full" onclick="showSection('templates')">Get Started</button>
                        </div>

                        <div class="card p-8 text-center animate-slide-in" style="animation-delay: 0.1s">
                            <div class="text-4xl mb-4">üìã</div>
                            <h3 class="text-xl font-bold mb-4">Load Existing Menu</h3>
                            <p class="text-gray-600 mb-6">Continue working on saved menus</p>
                            <button class="btn btn-secondary w-full" onclick="loadExistingMenu()">Load Menu</button>
                        </div>

                        <div class="card p-8 text-center animate-slide-in" style="animation-delay: 0.2s">
                            <div class="text-4xl mb-4">üé®</div>
                            <h3 class="text-xl font-bold mb-4">Choose Template</h3>
                            <p class="text-gray-600 mb-6">Browse professional templates</p>
                            <button class="btn btn-secondary w-full" onclick="showSection('templates')">Browse Templates</button>
                        </div>
                    </div>

                    <div class="card p-8">
                        <h2 class="text-2xl font-bold mb-6">Recent Menus</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="recent-menus">
                            <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center">
                                <div class="text-4xl mb-4 text-gray-400">üìù</div>
                                <p class="text-gray-500">No menus yet. Create your first menu!</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- TEMPLATES SECTION -->
        <section id="templates-section" class="section">
            <div class="min-h-screen p-8">
                <div class="max-w-7xl mx-auto">
                    <div class="text-center mb-16 animate-fade-in">
                        <h1 class="text-6xl font-bold text-white mb-6">Choose Your Template</h1>
                        <p class="text-xl text-white opacity-90 max-w-2xl mx-auto">
                            Select a professional template that matches your restaurant's style
                        </p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        <div class="template-card card" onclick="selectTemplate('modern')">
                            <div class="h-64 bg-gradient-to-br from-indigo-400 to-purple-600 flex items-center justify-center">
                                <div class="text-white text-center">
                                    <div class="text-2xl font-bold mb-4">Restaurant Name</div>
                                    <div class="text-sm opacity-80">Modern & Clean</div>
                                </div>
                            </div>
                            <div class="p-6">
                                <h3 class="text-xl font-bold mb-2">Modern</h3>
                                <p class="text-gray-600 mb-4">Clean and contemporary design perfect for modern restaurants</p>
                                <button class="btn btn-primary w-full">Use Template</button>
                            </div>
                        </div>

                        <div class="template-card card" onclick="selectTemplate('elegant')">
                            <div class="h-64 bg-gradient-to-br from-rose-400 to-pink-600 flex items-center justify-center">
                                <div class="text-white text-center">
                                    <div class="text-2xl font-bold mb-4 font-playfair">Restaurant Name</div>
                                    <div class="text-sm opacity-80">Elegant & Sophisticated</div>
                                </div>
                            </div>
                            <div class="p-6">
                                <h3 class="text-xl font-bold mb-2">Elegant</h3>
                                <p class="text-gray-600 mb-4">Sophisticated styling ideal for fine dining restaurants</p>
                                <button class="btn btn-primary w-full">Use Template</button>
                            </div>
                        </div>

                        <div class="template-card card" onclick="selectTemplate('casual')">
                            <div class="h-64 bg-gradient-to-br from-emerald-400 to-teal-600 flex items-center justify-center">
                                <div class="text-white text-center">
                                    <div class="text-2xl font-bold mb-4 font-poppins">Restaurant Name</div>
                                    <div class="text-sm opacity-80">Friendly & Casual</div>
                                </div>
                            </div>
                            <div class="p-6">
                                <h3 class="text-xl font-bold mb-2">Casual</h3>
                                <p class="text-gray-600 mb-4">Friendly design perfect for family restaurants</p>
                                <button class="btn btn-primary w-full">Use Template</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- MENU BUILDER SECTION -->
        <section id="builder-section" class="section">
            <div class="flex">
                <!-- Sidebar -->
                <div class="sidebar w-80 p-6">
                    <div class="space-y-6">
                        <!-- Restaurant Info -->
                        <div>
                            <h3 class="text-lg font-bold mb-4">Restaurant Information</h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-semibold mb-2">Restaurant Name</label>
                                    <input type="text" class="input-field" placeholder="Enter restaurant name" 
                                           onchange="updateRestaurantName(this.value)" id="restaurant-name">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold mb-2">Tagline</label>
                                    <input type="text" class="input-field" placeholder="Enter tagline"
                                           onchange="updateTagline(this.value)" id="restaurant-tagline">
                                </div>
                            </div>
                        </div>

                        <!-- Design Controls -->
                        <div>
                            <h3 class="text-lg font-bold mb-4">Design</h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-semibold mb-2">Font Style</label>
                                    <select class="input-field" onchange="updateFont(this.value)" id="font-selector">
                                        <option value="font-inter">Inter (Modern)</option>
                                        <option value="font-poppins">Poppins (Friendly)</option>
                                        <option value="font-playfair">Playfair (Elegant)</option>
                                        <option value="font-arabic">Arabic</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold mb-2">Color Theme</label>
                                    <select class="input-field" onchange="updateTheme(this.value)" id="theme-selector">
                                        <option value="theme-modern">Modern Blue</option>
                                        <option value="theme-elegant">Elegant Purple</option>
                                        <option value="theme-nature">Nature Green</option>
                                        <option value="theme-sunset">Sunset Orange</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Menu Sections -->
                        <div>
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-bold">Menu Sections</h3>
                                <button class="btn btn-primary btn-sm" onclick="addSection()">Add Section</button>
                            </div>
                            <div id="sections-list" class="space-y-3">
                                <!-- Sections will be added here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Main Editor Area -->
                <div class="flex-1 p-6 bg-gray-50">
                    <div class="max-w-4xl mx-auto">
                        <div class="flex items-center justify-between mb-6">
                            <h2 class="text-2xl font-bold">Menu Builder</h2>
                            <div class="flex gap-4">
                                <button class="btn btn-secondary" onclick="saveMenu()">Save Menu</button>
                                <button class="btn btn-primary" onclick="showSection('preview')">Preview</button>
                            </div>
                        </div>

                        <div id="menu-content" class="space-y-8">
                            <div class="text-center py-16 bg-white rounded-lg">
                                <div class="text-6xl mb-4">üìã</div>
                                <h3 class="text-xl font-semibold mb-2">Start Building Your Menu</h3>
                                <p class="text-gray-600 mb-6">Add sections and menu items using the sidebar</p>
                                <button class="btn btn-primary" onclick="addSection()">Add Your First Section</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- PREVIEW SECTION -->
        <section id="preview-section" class="section">
            <div class="min-h-screen p-8 bg-gray-100">
                <div class="max-w-7xl mx-auto">
                    <div class="flex items-center justify-between mb-8">
                        <h1 class="text-3xl font-bold text-gray-800">Menu Preview</h1>
                        <div class="flex items-center gap-4">
                            <div class="flex bg-white rounded-lg p-1 shadow">
                                <button class="px-4 py-2 rounded bg-blue-500 text-white" onclick="setPreviewMode('desktop')">
                                    üñ•Ô∏è Desktop
                                </button>
                                <button class="px-4 py-2 rounded" onclick="setPreviewMode('mobile')">
                                    üì± Mobile
                                </button>
                            </div>
                            <button class="btn btn-secondary" onclick="toggleRTL()">Toggle Arabic</button>
                            <button class="btn btn-primary" onclick="exportMenu()">Export Menu</button>
                        </div>
                    </div>

                    <div class="flex justify-center">
                        <div id="preview-frame" class="preview-frame desktop">
                            <div id="menu-preview" class="w-full h-full overflow-y-auto p-8 bg-white">
                                <!-- Menu preview content will be rendered here -->
                                <div class="text-center py-16">
                                    <div class="text-6xl mb-4">üçΩÔ∏è</div>
                                    <h2 class="text-3xl font-bold mb-4" id="preview-restaurant-name">Your Restaurant</h2>
                                    <p class="text-gray-600 mb-8" id="preview-tagline">Delicious food, great atmosphere</p>
                                    <div class="text-gray-500">
                                        <p>Add menu sections and items to see your menu preview here</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Modal for Adding/Editing Items -->
    <div id="item-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" style="display: none;">
        <div class="bg-white rounded-lg p-8 w-full max-w-2xl max-h-90vh overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold" id="modal-title">Add Menu Item</h3>
                <button class="text-gray-400 hover:text-gray-600 text-2xl" onclick="closeModal()">&times;</button>
            </div>
            
            <form onsubmit="saveItem(event)" class="space-y-6">
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-semibold mb-2">Item Name (English)</label>
                        <input type="text" class="input-field" placeholder="e.g., Grilled Salmon" id="item-name" required>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2">Item Name (Arabic)</label>
                        <input type="text" class="input-field" placeholder="e.g., ÿ≥ŸÖŸÉ ÿßŸÑÿ≥ŸÑŸÖŸàŸÜ ÿßŸÑŸÖÿ¥ŸàŸä" id="item-name-ar" dir="rtl">
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-semibold mb-2">Description (English)</label>
                        <textarea class="input-field" rows="3" placeholder="Describe this delicious item..." id="item-description"></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2">Description (Arabic)</label>
                        <textarea class="input-field" rows="3" placeholder="ÿµŸÅ Ÿáÿ∞ÿß ÿßŸÑÿ∑ÿ®ŸÇ ÿßŸÑŸÑÿ∞Ÿäÿ∞..." id="item-description-ar" dir="rtl"></textarea>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-semibold mb-2">Price ($)</label>
                    <input type="number" step="0.01" class="input-field" placeholder="0.00" id="item-price" required>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-semibold mb-2">Food Image</label>
                        <div class="upload-area" onclick="document.getElementById('image-upload').click()">
                            <div class="text-4xl mb-2">üì∑</div>
                            <p class="text-gray-600">Click to upload image</p>
                            <input type="file" id="image-upload" accept="image/*" style="display: none;" onchange="handleImageUpload(event)">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2">3D Model (.glb)</label>
                        <div class="upload-area" onclick="document.getElementById('model-upload').click()">
                            <div class="text-4xl mb-2">üéÆ</div>
                            <p class="text-gray-600">Click to upload 3D model</p>
                            <input type="file" id="model-upload" accept=".glb,.gltf" style="display: none;" onchange="handleModelUpload(event)">
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-3 gap-4">
                    <label class="flex items-center cursor-pointer p-3 bg-gray-50 rounded-lg">
                        <input type="checkbox" id="item-spicy" class="mr-2">
                        <span>üå∂Ô∏è Spicy</span>
                    </label>
                    <label class="flex items-center cursor-pointer p-3 bg-gray-50 rounded-lg">
                        <input type="checkbox" id="item-vegetarian" class="mr-2">
                        <span>üå± Vegetarian</span>
                    </label>
                    <label class="flex items-center cursor-pointer p-3 bg-gray-50 rounded-lg">
                        <input type="checkbox" id="item-popular" class="mr-2">
                        <span>‚≠ê Popular</span>
                    </label>
                </div>

                <div class="flex gap-4 pt-6 border-t">
                    <button type="submit" class="btn btn-primary flex-1">Save Item</button>
                    <button type="button" class="btn btn-secondary flex-1" onclick="closeModal()">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Global state
        let currentLanguage = 'en';
        let currentMenu = {
            restaurantName: '',
            tagline: '',
            font: 'font-inter',
            theme: 'theme-modern',
            sections: []
        };
        let previewMode = 'desktop';
        let isRTL = false;
        let editingItemIndex = -1;
        let editingSectionIndex = -1;

        // Navigation
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });

            // Show target section
            document.getElementById(sectionName + '-section').classList.add('active');

            // Update navigation
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById('nav-' + sectionName).classList.add('active');

            // Special handling for specific sections
            if (sectionName === 'preview') {
                renderPreview();
            }
        }

        // Authentication
        function handleLogin(event) {
            event.preventDefault();
            showSection('dashboard');
        }

        function guestLogin() {
            showSection('dashboard');
        }

        function toggleAuthMode() {
            // Toggle between login and signup
            alert('Sign up functionality would be implemented here');
        }

        // Language toggle
        function toggleLanguage() {
            currentLanguage = currentLanguage === 'en' ? 'ar' : 'en';
            const langToggle = document.getElementById('lang-toggle');
            langToggle.textContent = currentLanguage === 'en' ? 'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©' : 'English';
            
            if (currentLanguage === 'ar') {
                document.body.classList.add('rtl');
            } else {
                document.body.classList.remove('rtl');
            }
        }

        // Template selection
        function selectTemplate(templateName) {
            currentMenu.theme = 'theme-' + templateName;
            if (templateName === 'elegant') {
                currentMenu.font = 'font-playfair';
            } else if (templateName === 'casual') {
                currentMenu.font = 'font-poppins';
            }
            showSection('builder');
            updatePreview();
        }

        // Load existing menu
        function loadExistingMenu() {
            const saved = localStorage.getItem('menuBuilderData');
            if (saved) {
                currentMenu = JSON.parse(saved);
                updateBuilderUI();
                showSection('builder');
            } else {
                alert('No saved menus found. Create a new menu instead.');
            }
        }

        // Restaurant info updates
        function updateRestaurantName(value) {
            currentMenu.restaurantName = value;
            updatePreview();
        }

        function updateTagline(value) {
            currentMenu.tagline = value;
            updatePreview();
        }

        function updateFont(value) {
            currentMenu.font = value;
            updatePreview();
        }

        function updateTheme(value) {
            currentMenu.theme = value;
            updatePreview();
        }

        // Section management
        function addSection() {
            const sectionName = prompt('Enter section name (e.g., Appetizers, Main Courses):');
            if (sectionName) {
                const section = {
                    name: sectionName,
                    nameAr: '',
                    items: []
                };
                currentMenu.sections.push(section);
                renderSections();
                updatePreview();
            }
        }

        function editSection(index) {
            const section = currentMenu.sections[index];
            const newName = prompt('Edit section name:', section.name);
            if (newName !== null) {
                section.name = newName;
                renderSections();
                updatePreview();
            }
        }

        function deleteSection(index) {
            if (confirm('Are you sure you want to delete this section?')) {
                currentMenu.sections.splice(index, 1);
                renderSections();
                updatePreview();
            }
        }

        function addItem(sectionIndex) {
            editingSectionIndex = sectionIndex;
            editingItemIndex = -1;
            openModal();
        }

        function editItem(sectionIndex, itemIndex) {
            editingSectionIndex = sectionIndex;
            editingItemIndex = itemIndex;
            const item = currentMenu.sections[sectionIndex].items[itemIndex];
            
            // Populate form
            document.getElementById('item-name').value = item.name || '';
            document.getElementById('item-name-ar').value = item.nameAr || '';
            document.getElementById('item-description').value = item.description || '';
            document.getElementById('item-description-ar').value = item.descriptionAr || '';
            document.getElementById('item-price').value = item.price || '';
            document.getElementById('item-spicy').checked = item.spicy || false;
            document.getElementById('item-vegetarian').checked = item.vegetarian || false;
            document.getElementById('item-popular').checked = item.popular || false;
            
            document.getElementById('modal-title').textContent = 'Edit Menu Item';
            openModal();
        }

        function deleteItem(sectionIndex, itemIndex) {
            if (confirm('Are you sure you want to delete this item?')) {
                currentMenu.sections[sectionIndex].items.splice(itemIndex, 1);
                renderSections();
                updatePreview();
            }
        }

        // Modal management
        function openModal() {
            document.getElementById('item-modal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('item-modal').style.display = 'none';
            // Clear form
            document.getElementById('item-name').value = '';
            document.getElementById('item-name-ar').value = '';
            document.getElementById('item-description').value = '';
            document.getElementById('item-description-ar').value = '';
            document.getElementById('item-price').value = '';
            document.getElementById('item-spicy').checked = false;
            document.getElementById('item-vegetarian').checked = false;
            document.getElementById('item-popular').checked = false;
            document.getElementById('modal-title').textContent = 'Add Menu Item';
        }

        function saveItem(event) {
            event.preventDefault();
            
            const item = {
                name: document.getElementById('item-name').value,
                nameAr: document.getElementById('item-name-ar').value,
                description: document.getElementById('item-description').value,
                descriptionAr: document.getElementById('item-description-ar').value,
                price: parseFloat(document.getElementById('item-price').value),
                spicy: document.getElementById('item-spicy').checked,
                vegetarian: document.getElementById('item-vegetarian').checked,
                popular: document.getElementById('item-popular').checked,
                image: '',
                model3d: ''
            };

            if (editingItemIndex === -1) {
                // Adding new item
                currentMenu.sections[editingSectionIndex].items.push(item);
            } else {
                // Editing existing item
                currentMenu.sections[editingSectionIndex].items[editingItemIndex] = item;
            }

            closeModal();
            renderSections();
            updatePreview();
        }

        // File upload handlers
        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    // Store image data (in real app, would upload to server)
                    console.log('Image uploaded:', file.name);
                };
                reader.readAsDataURL(file);
            }
        }

        function handleModelUpload(event) {
            const file = event.target.files[0];
            if (file) {
                console.log('3D Model uploaded:', file.name);
            }
        }

        // Render functions
        function renderSections() {
            const container = document.getElementById('sections-list');
            const menuContent = document.getElementById('menu-content');
            
            if (currentMenu.sections.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-sm">No sections added yet</p>';
                menuContent.innerHTML = `
                    <div class="text-center py-16 bg-white rounded-lg">
                        <div class="text-6xl mb-4">üìã</div>
                        <h3 class="text-xl font-semibold mb-2">Start Building Your Menu</h3>
                        <p class="text-gray-600 mb-6">Add sections and menu items using the sidebar</p>
                        <button class="btn btn-primary" onclick="addSection()">Add Your First Section</button>
                    </div>
                `;
                return;
            }

            // Render sections in sidebar
            container.innerHTML = currentMenu.sections.map((section, sectionIndex) => `
                <div class="border rounded-lg p-4 bg-gray-50">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-semibold">${section.name}</h4>
                        <div class="flex gap-2">
                            <button class="text-blue-600 hover:text-blue-800 text-sm" onclick="editSection(${sectionIndex})">Edit</button>
                            <button class="text-red-600 hover:text-red-800 text-sm" onclick="deleteSection(${sectionIndex})">Delete</button>
                        </div>
                    </div>
                    <div class="space-y-2">
                        ${section.items.map((item, itemIndex) => `
                            <div class="flex items-center justify-between text-sm bg-white p-2 rounded">
                                <span>${item.name} - $${item.price}</span>
                                <div class="flex gap-1">
                                    <button class="text-blue-600 hover:text-blue-800" onclick="editItem(${sectionIndex}, ${itemIndex})">Edit</button>
                                    <button class="text-red-600 hover:text-red-800" onclick="deleteItem(${sectionIndex}, ${itemIndex})">Del</button>
                                </div>
                            </div>
                        `).join('')}
                        <button class="w-full text-left text-sm text-blue-600 hover:text-blue-800 p-2 hover:bg-blue-50 rounded" 
                                onclick="addItem(${sectionIndex})">+ Add Item</button>
                    </div>
                </div>
            `).join('');

            // Render sections in main editor
            menuContent.innerHTML = currentMenu.sections.map((section, sectionIndex) => `
                <div class="card p-6">
                    <h3 class="text-xl font-bold mb-4">${section.name}</h3>
                    ${section.items.length > 0 ? `
                        <div class="grid gap-4">
                            ${section.items.map((item, itemIndex) => `
                                <div class="menu-item-card">
                                    <div class="flex justify-between items-start">
                                        <div class="flex-1">
                                            <div class="flex items-center gap-2 mb-2">
                                                <h4 class="font-semibold text-lg">${item.name}</h4>
                                                ${item.spicy ? '<span class="text-red-500">üå∂Ô∏è</span>' : ''}
                                                ${item.vegetarian ? '<span class="text-green-500">üå±</span>' : ''}
                                                ${item.popular ? '<span class="text-yellow-500">‚≠ê</span>' : ''}
                                            </div>
                                            ${item.description ? `<p class="text-gray-600 mb-2">${item.description}</p>` : ''}
                                        </div>
                                        <div class="text-right">
                                            <div class="font-bold text-xl text-blue-600">$${item.price.toFixed(2)}</div>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    ` : `
                        <div class="text-center py-8 text-gray-500">
                            <p>No items in this section yet</p>
                            <button class="btn btn-secondary mt-4" onclick="addItem(${sectionIndex})">Add First Item</button>
                        </div>
                    `}
                </div>
            `).join('');
        }

        function updatePreview() {
            const previewName = document.getElementById('preview-restaurant-name');
            const previewTagline = document.getElementById('preview-tagline');
            
            if (previewName) {
                previewName.textContent = currentMenu.restaurantName || 'Your Restaurant';
            }
            if (previewTagline) {
                previewTagline.textContent = currentMenu.tagline || 'Delicious food, great atmosphere';
            }
        }

        function renderPreview() {
            const preview = document.getElementById('menu-preview');
            const isArabic = currentLanguage === 'ar';
            
            preview.className = `w-full h-full overflow-y-auto p-8 bg-white ${currentMenu.font} ${isArabic ? 'rtl' : ''}`;
            preview.dir = isArabic ? 'rtl' : 'ltr';
            
            if (currentMenu.sections.length === 0) {
                preview.innerHTML = `
                    <div class="text-center py-16">
                        <div class="text-6xl mb-4">üçΩÔ∏è</div>
                        <h2 class="text-3xl font-bold mb-4">${currentMenu.restaurantName || 'Your Restaurant'}</h2>
                        <p class="text-gray-600 mb-8">${currentMenu.tagline || 'Delicious food, great atmosphere'}</p>
                        <div class="text-gray-500">
                            <p>Add menu sections and items to see your menu preview here</p>
                        </div>
                    </div>
                `;
                return;
            }

            preview.innerHTML = `
                <div class="text-center mb-12">
                    <h1 class="text-5xl font-bold mb-4" style="color: var(--primary, #667eea)">${currentMenu.restaurantName || 'Your Restaurant'}</h1>
                    ${currentMenu.tagline ? `<p class="text-xl text-gray-600">${currentMenu.tagline}</p>` : ''}
                </div>
                
                ${currentMenu.sections.map(section => `
                    <div class="mb-12">
                        <h2 class="text-3xl font-bold mb-6 pb-2 border-b-2" style="border-color: var(--primary, #667eea)">
                            ${isArabic && section.nameAr ? section.nameAr : section.name}
                        </h2>
                        ${section.items.length > 0 ? `
                            <div class="space-y-6">
                                ${section.items.map(item => `
                                    <div class="flex justify-between items-start p-4 border-b border-gray-100">
                                        <div class="flex-1">
                                            <div class="flex items-center gap-2 mb-2">
                                                <h3 class="text-xl font-semibold">${isArabic && item.nameAr ? item.nameAr : item.name}</h3>
                                                ${item.spicy ? '<span class="text-red-500 text-lg">üå∂Ô∏è</span>' : ''}
                                                ${item.vegetarian ? '<span class="text-green-500 text-lg">üå±</span>' : ''}
                                                ${item.popular ? '<span class="bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded-full">‚≠ê Popular</span>' : ''}
                                            </div>
                                            ${item.description || item.descriptionAr ? `
                                                <p class="text-gray-600">${isArabic && item.descriptionAr ? item.descriptionAr : item.description}</p>
                                            ` : ''}
                                        </div>
                                        <div class="font-bold text-2xl ml-4" style="color: var(--primary, #667eea)">
                                            $${item.price.toFixed(2)}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : ''}
                    </div>
                `).join('')}
            `;
        }

        // Preview controls
        function setPreviewMode(mode) {
            previewMode = mode;
            const frame = document.getElementById('preview-frame');
            frame.className = `preview-frame ${mode}`;
            
            // Update button states
            document.querySelectorAll('[onclick*="setPreviewMode"]').forEach(btn => {
                btn.className = btn.onclick.toString().includes(mode) ? 
                    'px-4 py-2 rounded bg-blue-500 text-white' : 
                    'px-4 py-2 rounded';
            });
        }

        function toggleRTL() {
            currentLanguage = currentLanguage === 'en' ? 'ar' : 'en';
            renderPreview();
        }

        // Save and export
        function saveMenu() {
            localStorage.setItem('menuBuilderData', JSON.stringify(currentMenu));
            alert('Menu saved successfully!');
        }

        function exportMenu() {
            // Generate QR code
            const canvas = document.createElement('canvas');
            const url = `https://your-domain.com/menu/${currentMenu.restaurantName?.toLowerCase().replace(/\s+/g, '-') || 'my-restaurant'}`;
            
            if (typeof QRCode !== 'undefined') {
                QRCode.toCanvas(canvas, url, function (error) {
                    if (error) {
                        console.error(error);
                        alert('QR code generation failed');
                    } else {
                        // Download QR code
                        const link = document.createElement('a');
                        link.download = 'menu-qr-code.png';
                        link.href = canvas.toDataURL();
                        link.click();
                        
                        // Show export options
                        alert(`Menu exported! Share this URL: ${url}`);
                    }
                });
            } else {
                alert(`Menu ready for export! Share this URL: ${url}`);
            }
        }

        function updateBuilderUI() {
            // Update form fields
            if (currentMenu.restaurantName) {
                document.getElementById('restaurant-name').value = currentMenu.restaurantName;
            }
            if (currentMenu.tagline) {
                document.getElementById('restaurant-tagline').value = currentMenu.tagline;
            }
            if (currentMenu.font) {
                document.getElementById('font-selector').value = currentMenu.font;
            }
            if (currentMenu.theme) {
                document.getElementById('theme-selector').value = currentMenu.theme;
            }
            
            renderSections();
            updatePreview();
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Set up initial state
            renderSections();
            updatePreview();
            
            // Load saved data if available
            const saved = localStorage.getItem('menuBuilderData');
            if (saved) {
                try {
                    currentMenu = JSON.parse(saved);
                    updateBuilderUI();
                } catch (e) {
                    console.error('Failed to load saved data:', e);
                }
            }
        });
    </script>
</body>
</html>
