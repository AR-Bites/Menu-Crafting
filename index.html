<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurant Menu Builder - Create Beautiful Digital Menus</title>
    <meta name="description" content="Create stunning restaurant menus with drag-and-drop interface, 3D models, multilingual support, and QR code generation. Perfect for modern restaurants.">
    
    <!-- External Dependencies -->
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/localforage/1.10.0/localforage.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+Arabic:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 25%, #8b5cf6 75%, #ec4899 100%);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(59, 130, 246, 0.2) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }
        
        /* Screen transition animations */
        .screen {
            min-height: 100vh;
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .screen.hidden {
            display: none;
        }
        
        .screen.fade-in {
            animation: fadeInScreen 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .screen.fade-out {
            animation: fadeOutScreen 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        @keyframes fadeInScreen {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.98);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        @keyframes fadeOutScreen {
            from {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            to {
                opacity: 0;
                transform: translateY(-30px) scale(0.98);
            }
        }
        
        /* Enhanced Language Switch with Instant Direction Changes */
        .language-switch {
            animation: enhancedLanguageSwitch 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        @keyframes enhancedLanguageSwitch {
            0% { 
                opacity: 1; 
                transform: translateX(0) scale(1); 
            }
            25% { 
                opacity: 0.3; 
                transform: translateX(var(--switch-direction, 20px)) scale(0.95); 
            }
            50% { 
                opacity: 0; 
                transform: translateX(var(--switch-direction, 20px)) scale(0.9) rotateY(90deg); 
            }
            75% { 
                opacity: 0.3; 
                transform: translateX(calc(var(--switch-direction, 20px) * -1)) scale(0.95) rotateY(-90deg); 
            }
            100% { 
                opacity: 1; 
                transform: translateX(0) scale(1) rotateY(0deg); 
            }
        }
        
        .rtl {
            direction: rtl;
            font-family: 'Noto Sans Arabic', sans-serif;
            --switch-direction: -20px;
        }

        .ltr {
            direction: ltr;
            font-family: 'Inter', sans-serif;
            --switch-direction: 20px;
        }

        /* Instant direction change for all elements */
        .rtl * {
            direction: rtl !important;
        }

        .ltr * {
            direction: ltr !important;
        }

        /* Language button enhancement */
        .language-button {
            position: relative;
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .language-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.6s ease;
        }

        .language-button:hover::before {
            left: 100%;
        }

        .language-button:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .font-serif {
            font-family: 'Playfair Display', serif;
        }
        
        .font-sans {
            font-family: system-ui, -apple-system, sans-serif;
        }
        
        .template-card {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transform-style: preserve-3d;
            perspective: 1000px;
        }
        
        .template-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0) 100%);
            opacity: 0;
            transition: all 0.4s ease;
            z-index: 1;
        }
        
        .template-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: inherit;
            background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%);
            opacity: 0;
            transform: translateX(-100%);
            transition: all 0.6s ease;
            z-index: 2;
        }
        
        .template-card:hover::before {
            opacity: 1;
        }
        
        .template-card:hover::after {
            opacity: 1;
            transform: translateX(100%);
        }
        
        .template-card:hover {
            transform: translateY(-12px) scale(1.03) rotateX(5deg);
            box-shadow: 0 30px 60px rgba(0,0,0,0.2);
            border: 2px solid rgba(255,255,255,0.3);
        }
        
        .template-card.selected {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 25px 50px rgba(102, 126, 234, 0.3);
            border: 3px solid #667eea;
            animation: selectedPulse 2s infinite;
        }
        
        @keyframes selectedPulse {
            0%, 100% { box-shadow: 0 25px 50px rgba(102, 126, 234, 0.3); }
            50% { box-shadow: 0 25px 50px rgba(102, 126, 234, 0.5); }
        }
        
        .template-card-content {
            position: relative;
            z-index: 3;
            transition: transform 0.3s ease;
        }
        
        .template-card:hover .template-card-content {
            transform: translateZ(20px);
        }
        
        .template-selecting {
            animation: templateSelect 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        @keyframes templateSelect {
            0% { transform: scale(1); }
            50% { transform: scale(1.1) rotateY(10deg); }
            100% { transform: scale(1); }
        }
        
        .menu-item {
            transition: all 0.2s ease;
            position: relative;
        }
        
        .menu-item:hover {
            background-color: #f8fafc;
            transform: scale(1.01);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }
        
        .animate-fade-in {
            animation: fadeIn 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .animate-slide-up {
            animation: slideUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        @keyframes fadeIn {
            from { 
                opacity: 0; 
                transform: translateY(30px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }
        
        @keyframes slideUp {
            from { 
                opacity: 0; 
                transform: translateY(20px) scale(0.95); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            }
        }
        
        .btn {
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            border: none;
            outline: none;
            position: relative;
            overflow: hidden;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: white;
            color: #374151;
            border: 2px solid #e5e7eb;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .btn-secondary:hover {
            background: #f9fafb;
            border-color: #9ca3af;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
        }
        
        .btn-danger:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);
        }
        
        .input-field {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.2s ease;
            background: white;
        }
        
        .input-field:focus {
            border-color: #667eea;
            outline: none;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            transform: translateY(-1px);
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            background: white;
            padding: 32px;
            border-radius: 20px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px rgba(0,0,0,0.25);
            position: relative;
        }
        
        .color-scheme-indigo { 
            --primary: #667eea; 
            --secondary: #764ba2; 
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .color-scheme-emerald { 
            --primary: #10b981; 
            --secondary: #059669; 
            --gradient: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        .color-scheme-amber { 
            --primary: #f59e0b; 
            --secondary: #d97706; 
            --gradient: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }
        .color-scheme-rose { 
            --primary: #f43f5e; 
            --secondary: #e11d48; 
            --gradient: linear-gradient(135deg, #f43f5e 0%, #e11d48 100%);
        }
        
        model-viewer {
            width: 100%;
            height: 250px;
            background: linear-gradient(45deg, #f3f4f6, #e5e7eb);
            border-radius: 12px;
            border: 2px solid #e5e7eb;
        }
        
        .drag-handle {
            cursor: grab;
            padding: 8px;
            border-radius: 6px;
            transition: background-color 0.2s;
        }
        
        .drag-handle:hover {
            background-color: #f3f4f6;
        }
        
        .drag-handle:active {
            cursor: grabbing;
        }
        
        .sidebar {
            background: linear-gradient(180deg, #ffffff 0%, #f8fafc 100%);
            border-right: 1px solid #e5e7eb;
            box-shadow: 4px 0 20px rgba(0,0,0,0.1);
        }
        
        /* Enhanced customization panel */
        .customization-section {
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            margin-bottom: 16px;
            overflow: hidden;
            background: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }
        
        .customization-section:hover {
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
            border-color: #667eea;
        }
        
        .section-header {
            padding: 16px 20px;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border-bottom: 1px solid #e5e7eb;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: between;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .section-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.1), transparent);
            transition: left 0.5s ease;
        }
        
        .section-header:hover::before {
            left: 100%;
        }
        
        .section-header:hover {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .section-title {
            font-weight: 600;
            font-size: 16px;
            flex: 1;
            position: relative;
            z-index: 1;
        }
        
        .section-toggle {
            font-size: 20px;
            transition: transform 0.3s ease;
            position: relative;
            z-index: 1;
        }
        
        .section-toggle.expanded {
            transform: rotate(180deg);
        }
        
        .section-content {
            max-height: 0;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            opacity: 0;
        }
        
        .section-content.expanded {
            max-height: 500px;
            opacity: 1;
            padding: 20px;
        }
        
        /* Enhanced form controls */
        .form-group {
            margin-bottom: 20px;
            animation: slideInUp 0.3s ease;
        }
        
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .form-label {
            display: block;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .enhanced-select {
            position: relative;
            display: block;
        }
        
        .enhanced-select select {
            width: 100%;
            padding: 12px 40px 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 16px;
            background: white;
            color: #374151;
            cursor: pointer;
            transition: all 0.3s ease;
            appearance: none;
            background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iOCIgdmlld0JveD0iMCAwIDEyIDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGQ9Ik0xIDFMNiA2TDExIDEiIHN0cm9rZT0iIzY2NmVlYSIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4KPC9zdmc+');
            background-repeat: no-repeat;
            background-position: right 12px center;
        }
        
        .enhanced-select select:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            outline: none;
        }
        
        .enhanced-select select:hover {
            border-color: #9ca3af;
        }
        
        /* Toggle switches */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #ccc;
            transition: 0.4s;
            border-radius: 34px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background: white;
            transition: 0.4s;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .toggle-switch input:checked + .toggle-slider {
            background: #667eea;
        }
        
        .toggle-switch input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }
        
        .preview-area {
            background: linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%);
        }
        
        .section-card {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 16px;
            transition: all 0.2s ease;
        }
        
        .section-card:hover {
            border-color: #667eea;
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.1);
        }
        
        .item-card {
            background: #f8fafc;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 12px;
            margin: 8px 0;
            transition: all 0.2s ease;
        }
        
        .item-card:hover {
            background: white;
            border-color: #667eea;
            box-shadow: 0 2px 12px rgba(102, 126, 234, 0.1);
        }
        
        .loading-spinner {
            border: 3px solid #f3f4f6;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .qr-container {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            display: inline-block;
        }
        
        /* Preview device animations */
        .preview-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 600px;
            position: relative;
        }
        
        .preview-device {
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            overflow: hidden;
        }
        
        .preview-device.desktop {
            width: 100%;
            max-width: 1000px;
            height: 600px;
            border: 16px solid #1a1a1a;
            border-radius: 12px;
        }
        
        .preview-device.tablet {
            width: 600px;
            height: 800px;
            border: 12px solid #2d2d2d;
            border-radius: 24px;
        }
        
        .preview-device.mobile {
            width: 375px;
            height: 812px;
            background: #000;
            border-radius: 40px;
            padding: 8px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }
        
        .preview-device.mobile::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 140px;
            height: 6px;
            background: #333;
            border-radius: 3px;
            z-index: 10;
        }
        
        .preview-screen {
            width: 100%;
            height: 100%;
            background: white;
            overflow: hidden;
            position: relative;
        }
        
        .preview-device.mobile .preview-screen {
            border-radius: 32px;
            padding-top: 40px;
        }
        
        .preview-device.tablet .preview-screen {
            border-radius: 12px;
        }
        
        .preview-device.desktop .preview-screen {
            border-radius: 4px;
        }
        
        /* View mode transition animations */
        .view-switching {
            animation: viewModeSwitch 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        @keyframes viewModeSwitch {
            0% { transform: scale(1) rotateY(0deg); opacity: 1; }
            50% { transform: scale(0.8) rotateY(90deg); opacity: 0.3; }
            100% { transform: scale(1) rotateY(0deg); opacity: 1; }
        }
        
        .preview-content {
            width: 100%;
            height: 100%;
            overflow-y: auto;
            transition: all 0.4s ease;
        }
        
        /* View toggle enhanced buttons */
        .view-toggle {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 6px;
            display: flex;
            gap: 4px;
        }
        
        .view-toggle-btn {
            padding: 12px 16px;
            border-radius: 12px;
            border: none;
            background: transparent;
            color: rgba(255, 255, 255, 0.7);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            gap: 8px;
            position: relative;
            overflow: hidden;
        }
        
        .view-toggle-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s ease;
        }
        
        .view-toggle-btn:hover::before {
            left: 100%;
        }
        
        .view-toggle-btn.active {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        
        .view-toggle-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            transform: translateY(-1px);
        }
        
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 16px 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            z-index: 1001;
            animation: slideInRight 0.3s ease;
        }
        
        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .language-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 100;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 8px 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .language-toggle:hover {
            background: rgba(255, 255, 255, 1);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .modal-content {
                width: 95%;
                padding: 24px;
                max-height: 85vh;
            }
            
            .preview-phone {
                width: 300px;
                height: 600px;
            }
            
            .btn {
                padding: 10px 20px;
                font-size: 14px;
            }
            
            .sidebar {
                width: 100%;
                max-width: none;
            }
        }
        
        /* CRITICAL FIX: Template Selection - Realistic Live Mini Previews */
        .template-card-enhanced {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 15px 40px rgba(0,0,0,0.12);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            opacity: 0;
            transform: translateY(60px) scale(0.9);
            animation: slideInUp 0.8s ease-out forwards;
            border: 4px solid transparent;
            position: relative;
            width: 100%;
            height: 500px;
            display: flex;
            flex-direction: column;
        }

        .template-card-enhanced:hover {
            transform: translateY(-15px) scale(1.03);
            box-shadow: 0 30px 60px rgba(0,0,0,0.25);
            border-color: rgba(59, 130, 246, 0.4);
        }

        .template-card-enhanced:hover .realistic-preview {
            transform: scale(1.02);
        }

        /* INSTANT visual selection feedback with dramatic effects */
        .template-card-enhanced.selected {
            transform: translateY(-20px) scale(1.05) !important;
            box-shadow: 0 0 0 6px #3b82f6, 0 40px 80px rgba(59, 130, 246, 0.5) !important;
            border: 4px solid #3b82f6 !important;
            background: linear-gradient(135deg, #ffffff 0%, #f0f9ff 100%) !important;
            animation: selectedPulse 2s ease-in-out infinite;
        }

        .template-card-enhanced.selected::after {
            content: '✓ SELECTED';
            position: absolute;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 700;
            z-index: 100;
            animation: selectedBadge 0.6s ease-out;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
        }

        .template-card-enhanced.selected .realistic-preview {
            transform: scale(1.02);
            box-shadow: inset 0 0 0 3px rgba(59, 130, 246, 0.3);
        }

        @keyframes selectedPulse {
            0%, 100% { 
                box-shadow: 0 0 0 6px #3b82f6, 0 40px 80px rgba(59, 130, 246, 0.5);
            }
            50% { 
                box-shadow: 0 0 0 8px #3b82f6, 0 45px 90px rgba(59, 130, 246, 0.6);
            }
        }

        @keyframes selectedBadge {
            0% { 
                transform: scale(0) rotate(-180deg);
                opacity: 0;
            }
            50% { 
                transform: scale(1.2) rotate(-90deg);
                opacity: 1;
            }
            100% { 
                transform: scale(1) rotate(0deg);
                opacity: 1;
            }
        }

        /* Enhanced realistic preview container */
        .realistic-preview {
            flex: 1;
            position: relative;
            overflow: hidden;
            border-radius: 16px 16px 0 0;
            height: 340px;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        /* Template info section with better styling */
        .template-info {
            padding: 24px;
            background: white;
            border-top: 1px solid #f1f5f9;
            height: 160px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .template-name {
            font-size: 1.4rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 8px;
        }

        .template-description {
            font-size: 0.9rem;
            color: #64748b;
            line-height: 1.4;
            margin-bottom: 16px;
        }

        .template-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .template-tag {
            background: #f1f5f9;
            color: #475569;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .template-preview-container {
            position: relative;
            overflow: hidden;
        }

        .template-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(0,0,0,0.7), rgba(0,0,0,0.5));
            backdrop-filter: blur(8px);
            opacity: 0;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }

        .template-card-enhanced:hover .template-overlay {
            opacity: 1;
        }

        .overlay-content {
            text-align: center;
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }

        .template-card-enhanced:hover .overlay-content {
            transform: translateY(0);
        }

        .feature-badge {
            background: rgba(255,255,255,0.2);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
            backdrop-filter: blur(10px);
        }

        .template-info {
            background: white;
            border-top: 1px solid #f1f5f9;
        }

        .selection-indicator {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
            border: 2px solid #e2e8f0;
            color: #94a3b8;
        }

        .selection-indicator.selected {
            background: #3b82f6;
            border-color: #3b82f6;
            color: white;
            animation: bounceIn 0.5s ease;
        }

        /* Realistic Preview Styles */
        .realistic-preview {
            border-radius: 12px;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.1);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .template-card-enhanced:hover .realistic-preview {
            transform: scale(1.03);
            box-shadow: inset 0 4px 20px rgba(0,0,0,0.15);
        }

        /* Dark Neon Template Specific Styles */
        .template-card-enhanced:hover .realistic-preview[style*="0f0f23"] {
            box-shadow: 
                inset 0 4px 20px rgba(0,0,0,0.15),
                0 0 30px rgba(0, 245, 255, 0.3),
                0 0 60px rgba(255, 0, 170, 0.2);
            animation: neonPulse 2s ease-in-out infinite;
        }

        .neon-card {
            transition: all 0.3s ease;
        }

        .template-card-enhanced:hover .neon-card {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 245, 255, 0.3);
        }

        /* Elegant Template Specific Styles */
        .template-card-enhanced:hover .realistic-preview[style*="f7f1e3"] {
            box-shadow: 
                inset 0 4px 20px rgba(0,0,0,0.1),
                0 0 25px rgba(212, 175, 55, 0.4);
        }

        /* Image Grid Template Specific Styles */
        .template-card-enhanced:hover .realistic-preview[style*="ff6b35"] {
            box-shadow: 
                inset 0 4px 20px rgba(0,0,0,0.15),
                0 0 30px rgba(255, 107, 53, 0.4);
        }

        /* Minimal Template Specific Styles */
        .template-card-enhanced:hover .realistic-preview[style*="ffffff"] {
            box-shadow: 
                inset 0 4px 20px rgba(0,0,0,0.05),
                0 0 20px rgba(45, 55, 72, 0.1);
        }

        @keyframes neonPulse {
            0%, 100% {
                box-shadow: 
                    inset 0 4px 20px rgba(0,0,0,0.15),
                    0 0 30px rgba(0, 245, 255, 0.3),
                    0 0 60px rgba(255, 0, 170, 0.2);
            }
            50% {
                box-shadow: 
                    inset 0 4px 20px rgba(0,0,0,0.15),
                    0 0 40px rgba(0, 245, 255, 0.5),
                    0 0 80px rgba(255, 0, 170, 0.3);
            }
        }

        .preview-header {
            position: relative;
            z-index: 2;
        }

        .preview-restaurant-name {
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }

        .template-card-enhanced:hover .preview-restaurant-name {
            transform: scale(1.05);
        }

        .preview-content {
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(255,255,255,0.2);
        }

        .preview-item {
            transition: all 0.2s ease;
            padding: 2px 0;
            border-radius: 4px;
        }

        .preview-item:hover {
            background: rgba(255,255,255,0.1);
            transform: translateX(4px);
        }

        /* Confirmation Section Styles */
        .confirmation-section {
            opacity: 0;
            transform: translateY(30px);
            animation: slideInUp 0.6s ease-out 0.3s forwards;
        }

        .confirmation-content {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .confirmation-icon {
            font-size: 4rem;
            animation: bounceIn 0.8s ease-out 0.5s both;
        }

        /* Enhanced Button Loading State */
        .btn.loading {
            position: relative;
            color: transparent;
        }

        .btn.loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 2px solid transparent;
            border-top: 2px solid currentColor;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        /* Keyframe Animations */
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulseSelection {
            0%, 100% {
                box-shadow: 0 0 0 3px #3b82f6, 0 20px 40px rgba(59, 130, 246, 0.3);
            }
            50% {
                box-shadow: 0 0 0 6px rgba(59, 130, 246, 0.4), 0 20px 40px rgba(59, 130, 246, 0.5);
            }
        }

        @keyframes bounceIn {
            0% {
                opacity: 0;
                transform: scale(0.3);
            }
            50% {
                opacity: 1;
                transform: scale(1.05);
            }
            70% {
                transform: scale(0.9);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Dark Neon Theme Effects */
        .template-card-enhanced:hover .live-preview[style*="0f0f23"] {
            box-shadow: 0 0 30px rgba(0, 245, 255, 0.3), 0 0 60px rgba(255, 0, 170, 0.2);
        }

        /* Elegant Theme Effects */
        .template-card-enhanced:hover .live-preview[style*="f7f1e3"] {
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.4);
        }

        /* Vibrant Theme Effects */
        .template-card-enhanced:hover .live-preview[style*="ff6b35"] {
            box-shadow: 0 0 25px rgba(255, 107, 53, 0.4);
        }

        /* Collapsible Section Styles */
        .customization-section {
            margin-bottom: 24px;
            border-radius: 12px;
            overflow: hidden;
            background: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }

        .customization-section:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .section-header {
            padding: 16px 20px;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border-bottom: 1px solid #e2e8f0;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: between;
            transition: all 0.2s ease;
        }

        .section-header:hover {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
        }

        .section-title {
            font-size: 16px;
            font-weight: 600;
            color: #1e293b;
            flex: 1;
        }

        .section-toggle {
            font-size: 12px;
            color: #64748b;
            transition: transform 0.3s ease;
            margin-left: auto;
        }

        .section-toggle.expanded {
            transform: rotate(180deg);
        }

        .section-content {
            max-height: 0;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            opacity: 0;
        }

        .section-content.expanded {
            max-height: 500px;
            opacity: 1;
            padding: 20px;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
        }

        .enhanced-select {
            position: relative;
        }

        /* CRITICAL FIX: Input Fields - Zero Freezing, Instant Response */
        .input-field {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 16px;
            background: white;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
            font-weight: 500;
            color: #374151;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            /* Critical: Prevent input lag */
            will-change: border-color, box-shadow;
            /* Ensure stable focus */
            position: relative;
            z-index: 1;
        }
        
        .input-field:focus {
            outline: none !important;
            border-color: #3b82f6 !important;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15), 0 4px 12px rgba(0,0,0,0.1) !important;
            /* Critical: Maintain focus stability */
            position: relative;
            z-index: 2;
        }

        .input-field:hover:not(:focus) {
            border-color: #9ca3af;
            box-shadow: 0 3px 8px rgba(0,0,0,0.08);
        }

        .input-field::placeholder {
            color: #9ca3af;
            font-weight: 400;
        }

        /* Prevent any unwanted state changes during typing */
        .input-field:focus-within {
            border-color: #3b82f6 !important;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15), 0 4px 12px rgba(0,0,0,0.1) !important;
        }

        .enhanced-select select {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            background: white;
            font-size: 14px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 16px center;
            background-repeat: no-repeat;
            background-size: 16px;
            font-weight: 500;
            color: #374151;
            cursor: pointer;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .enhanced-select select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1), 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(-1px);
        }

        .enhanced-select select:hover:not(:focus) {
            border-color: #9ca3af;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        /* ENHANCED DEVICE PREVIEW TOGGLE - ALWAYS VISIBLE LABELS + SMOOTH TRANSITIONS */
        .view-toggle {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.1));
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 24px;
            padding: 10px;
            display: flex;
            gap: 6px;
            box-shadow: 
                0 10px 40px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
        }

        .view-toggle::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: shimmer 3s ease-in-out infinite;
            pointer-events: none;
        }

        @keyframes shimmer {
            0%, 100% { transform: translateX(-100%); }
            50% { transform: translateX(100%); }
        }

        .view-toggle-btn {
            padding: 14px 24px;
            border: 2px solid rgba(0, 0, 0, 0.15);
            background: rgba(255, 255, 255, 0.9);
            color: #1a1a1a;
            border-radius: 18px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 13px;
            font-weight: 600;
            min-width: 120px;
            position: relative;
            z-index: 2;
            text-transform: capitalize;
            letter-spacing: 0.3px;
            overflow: hidden;
        }

        /* ALWAYS VISIBLE ICON AND LABEL WITH ENHANCED STYLING */
        .view-toggle-btn .view-icon {
            font-size: 18px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: block !important;
            opacity: 1 !important;
            visibility: visible !important;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
        }

        .view-toggle-btn .view-label {
            font-weight: 600;
            font-size: 13px;
            display: block !important;
            white-space: nowrap;
            opacity: 1 !important;
            visibility: visible !important;
            color: #1a1a1a;
            text-shadow: 0 1px 2px rgba(255, 255, 255, 0.3);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* ENHANCED HOVER EFFECTS */
        .view-toggle-btn:hover {
            background: linear-gradient(135deg, #ffffff, #f8fafc);
            color: #1a1a1a;
            transform: translateY(-3px) scale(1.02);
            box-shadow: 
                0 12px 30px rgba(0, 0, 0, 0.25),
                0 4px 15px rgba(59, 130, 246, 0.2);
            border-color: rgba(59, 130, 246, 0.6);
        }

        .view-toggle-btn:hover .view-icon {
            transform: scale(1.2) rotate(5deg);
            filter: drop-shadow(0 4px 8px rgba(59, 130, 246, 0.3));
        }

        .view-toggle-btn:hover .view-label {
            color: #1a1a1a;
            text-shadow: 0 2px 4px rgba(59, 130, 246, 0.2);
        }

        /* ENHANCED ACTIVE STATE WITH DISTINCT GLOW */
        .view-toggle-btn.active {
            background: linear-gradient(135deg, #ffffff, #f8fafc) !important;
            color: #1e293b !important;
            box-shadow: 
                0 15px 40px rgba(0, 0, 0, 0.3),
                0 0 20px rgba(59, 130, 246, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.5) !important;
            transform: translateY(-4px) scale(1.06);
            border: 3px solid #3b82f6 !important;
            animation: activeGlow 2s ease-in-out infinite alternate;
        }

        @keyframes activeGlow {
            0% { 
                box-shadow: 
                    0 15px 40px rgba(0, 0, 0, 0.3),
                    0 0 20px rgba(59, 130, 246, 0.4),
                    inset 0 1px 0 rgba(255, 255, 255, 0.5);
            }
            100% { 
                box-shadow: 
                    0 18px 45px rgba(0, 0, 0, 0.35),
                    0 0 30px rgba(59, 130, 246, 0.6),
                    inset 0 1px 0 rgba(255, 255, 255, 0.7);
            }
        }

        .view-toggle-btn.active .view-icon {
            color: #3b82f6 !important;
            transform: scale(1.15) rotate(0deg);
            filter: drop-shadow(0 2px 6px rgba(59, 130, 246, 0.3));
        }

        .view-toggle-btn.active .view-label {
            color: #1e293b !important;
            font-weight: 700;
            text-shadow: 0 1px 3px rgba(59, 130, 246, 0.2);
        }

        /* DISABLED STATE */
        .view-toggle-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            pointer-events: none;
        }

        .view-toggle-btn:disabled:hover {
            transform: none;
            background: rgba(255, 255, 255, 0.08);
        }

        /* Enhanced Landing Page Styling */
        .language-toggle-enhanced {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(15px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50px;
            padding: 16px 28px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            font-weight: 700;
            font-size: 16px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.1);
        }

        .language-toggle-enhanced:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
            border-color: rgba(255, 255, 255, 0.5);
        }

        /* Stunning Step Cards */
        .step-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 24px;
            padding: 32px 24px;
            text-align: center;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateY(20px);
            opacity: 0;
            animation: slideUpSteps 0.8s ease-out forwards;
        }

        .step-card:nth-child(1) { animation-delay: 0.2s; }
        .step-card:nth-child(2) { animation-delay: 0.4s; }
        .step-card:nth-child(3) { animation-delay: 0.6s; }

        .step-card:hover {
            transform: translateY(-8px) scale(1.03);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 20px 50px rgba(0,0,0,0.15);
        }

        .step-icon {
            font-size: 48px;
            margin-bottom: 16px;
            display: block;
        }

        .step-title {
            font-size: 24px;
            font-weight: 700;
            color: white;
            margin-bottom: 12px;
        }

        .step-description {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.5;
        }

        /* Enhanced CTA Button */
        .cta-button-enhanced {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            color: #1e293b;
            padding: 20px 48px;
            border-radius: 50px;
            border: none;
            font-size: 20px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
            position: relative;
            overflow: hidden;
        }

        .cta-button-enhanced::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.6s ease;
        }

        .cta-button-enhanced:hover::before {
            left: 100%;
        }

        .cta-button-enhanced:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 25px 60px rgba(0,0,0,0.25);
            background: linear-gradient(135deg, #f1f5f9 0%, #ffffff 100%);
        }

        .cta-text {
            position: relative;
            z-index: 1;
        }

        .cta-arrow {
            font-size: 24px;
            transition: transform 0.3s ease;
            position: relative;
            z-index: 1;
        }

        .cta-button-enhanced:hover .cta-arrow {
            transform: translateX(8px);
        }

        /* Floating Background Elements */
        .floating-circle {
            position: absolute;
            width: 100px;
            height: 100px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            animation: floatCircle 6s ease-in-out infinite;
        }

        @keyframes slideUpSteps {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes floatCircle {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        /* CRITICAL FIX: Enhanced Landing Page Visual Upgrade */
        .landing-hero-enhanced {
            position: relative;
            z-index: 10;
            text-align: center;
            padding: 4rem 2rem;
        }

        .landing-title-enhanced {
            font-size: clamp(3rem, 8vw, 6rem);
            font-weight: 900;
            color: white;
            margin-bottom: 2rem;
            text-shadow: 0 4px 20px rgba(0,0,0,0.3);
            animation: titlePulse 3s ease-in-out infinite;
        }

        .landing-subtitle-enhanced {
            font-size: clamp(1.2rem, 3vw, 1.8rem);
            color: rgba(255, 255, 255, 0.95);
            margin-bottom: 3rem;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.6;
            text-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .landing-cta-enhanced {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            color: #1e293b;
            padding: 1.5rem 3rem;
            border-radius: 50px;
            border: none;
            font-size: 1.3rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: inline-flex;
            align-items: center;
            gap: 1rem;
            box-shadow: 0 20px 50px rgba(0,0,0,0.2);
            margin-bottom: 4rem;
            position: relative;
            overflow: hidden;
        }

        .landing-cta-enhanced::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.6s ease;
        }

        .landing-cta-enhanced:hover::before {
            left: 100%;
        }

        .landing-cta-enhanced:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 30px 70px rgba(0,0,0,0.3);
        }

        .features-showcase {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            max-width: 1200px;
            margin: 0 auto 4rem;
            padding: 0 2rem;
        }

        .feature-showcase-card {
            background: rgba(255, 255, 255, 0.12);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 24px;
            padding: 2.5rem 2rem;
            text-align: center;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateY(30px);
            opacity: 0;
            animation: slideUpFeature 0.8s ease-out forwards;
        }

        .feature-showcase-card:nth-child(1) { animation-delay: 0.2s; }
        .feature-showcase-card:nth-child(2) { animation-delay: 0.4s; }
        .feature-showcase-card:nth-child(3) { animation-delay: 0.6s; }

        .feature-showcase-card:hover {
            transform: translateY(-10px) scale(1.03);
            background: rgba(255, 255, 255, 0.18);
            box-shadow: 0 25px 60px rgba(0,0,0,0.2);
        }

        .feature-icon-showcase {
            font-size: 4rem;
            margin-bottom: 1.5rem;
            display: block;
            animation: iconFloat 3s ease-in-out infinite;
        }

        .feature-icon-showcase:nth-child(1) { animation-delay: 0s; }
        .feature-icon-showcase:nth-child(2) { animation-delay: 1s; }
        .feature-icon-showcase:nth-child(3) { animation-delay: 2s; }

        .feature-title-showcase {
            font-size: 1.5rem;
            font-weight: 700;
            color: white;
            margin-bottom: 1rem;
        }

        .feature-desc-showcase {
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.6;
        }

        @keyframes titlePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        @keyframes slideUpFeature {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes iconFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* REDESIGNED LANDING PAGE - Fullscreen Hero */
        .hero-landing-redesigned {
            position: relative;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            overflow: hidden;
        }

        .hero-landing-redesigned::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 25% 25%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 75% 75%, rgba(255, 255, 255, 0.05) 0%, transparent 50%);
            animation: backgroundPulse 6s ease-in-out infinite;
        }

        .hero-logo-container {
            position: relative;
            z-index: 10;
            margin-bottom: 3rem;
            animation: logoFloat 3s ease-in-out infinite;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .hero-3d-logo {
            width: clamp(180px, 25vw, 260px);
            height: auto;
            filter: drop-shadow(0 15px 30px rgba(0, 0, 0, 0.25))
                    drop-shadow(0 0 20px rgba(147, 51, 234, 0.3))
                    drop-shadow(0 0 40px rgba(236, 72, 153, 0.2));
            animation: logoGlow 4s ease-in-out infinite alternate;
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            transform-origin: center;
        }

        .hero-3d-logo:hover {
            transform: scale(1.05) rotateY(5deg);
            filter: drop-shadow(0 25px 50px rgba(0, 0, 0, 0.4))
                    drop-shadow(0 0 40px rgba(147, 51, 234, 0.6))
                    drop-shadow(0 0 80px rgba(236, 72, 153, 0.5));
        }

        @keyframes logoGlow {
            0% {
                filter: drop-shadow(0 20px 40px rgba(0, 0, 0, 0.3))
                        drop-shadow(0 0 30px rgba(147, 51, 234, 0.4))
                        drop-shadow(0 0 60px rgba(236, 72, 153, 0.3));
            }
            100% {
                filter: drop-shadow(0 25px 50px rgba(0, 0, 0, 0.4))
                        drop-shadow(0 0 40px rgba(147, 51, 234, 0.6))
                        drop-shadow(0 0 80px rgba(236, 72, 153, 0.5));
            }
        }

        @media (max-width: 768px) {
            .hero-3d-logo {
                width: clamp(140px, 50vw, 200px);
            }
            
            .hero-logo-container {
                margin-bottom: 2rem;
            }
        }

        .hero-title-redesigned {
            font-size: clamp(3rem, 8vw, 5rem);
            font-weight: 900;
            color: white;
            text-align: center;
            margin-bottom: 1.5rem;
            text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            animation: titleSlideUp 1s ease-out 0.5s both;
            position: relative;
            z-index: 10;
        }

        .hero-subtitle-redesigned {
            font-size: clamp(1.2rem, 3vw, 1.6rem);
            color: rgba(255, 255, 255, 0.9);
            text-align: center;
            margin-bottom: 3rem;
            max-width: 600px;
            line-height: 1.6;
            animation: titleSlideUp 1s ease-out 0.7s both;
            position: relative;
            z-index: 10;
        }

        .hero-cta-redesigned {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            color: #1e293b;
            padding: 1.25rem 2.5rem;
            border-radius: 50px;
            border: none;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            animation: titleSlideUp 1s ease-out 0.9s both;
            position: relative;
            z-index: 10;
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
        }

        .hero-cta-redesigned:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
        }

        .scroll-indicator {
            position: absolute;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            animation: bounce 2s infinite;
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.5rem;
            z-index: 10;
        }

        @keyframes backgroundPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        @keyframes logoFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes titleSlideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateX(-50%) translateY(0); }
            40% { transform: translateX(-50%) translateY(-10px); }
            60% { transform: translateX(-50%) translateY(-5px); }
        }

        /* ENHANCED PREVIEW DEVICE ANIMATIONS WITH ULTRA-SMOOTH TRANSITIONS */
        .preview-container {
            transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            transform-origin: center center;
            position: relative;
            will-change: transform, opacity;
        }

        .preview-container.view-switching {
            opacity: 0.3;
            transform: scale(0.85) rotateY(25deg) translateZ(-50px);
            filter: blur(3px);
        }

        .preview-device {
            transition: all 0.9s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            transform-origin: center;
            position: relative;
            will-change: transform, opacity, filter;
            backface-visibility: hidden;
        }

        /* ENHANCED DEVICE-SPECIFIC ANIMATIONS */
        .preview-device.desktop {
            width: 100%;
            max-width: 1024px;
            margin: 0 auto;
            animation: slideInDesktop 1s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .preview-device.tablet {
            width: 768px;
            max-width: 90%;
            margin: 0 auto;
            transform: scale(0.9);
            animation: slideInTablet 1s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .preview-device.mobile {
            width: 375px;
            max-width: 80%;
            margin: 0 auto;
            transform: scale(0.8);
            animation: slideInMobile 1s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        /* SMOOTH DEVICE TRANSITION ANIMATIONS */
        @keyframes slideInDesktop {
            0% {
                opacity: 0;
                transform: scale(0.7) translateY(60px) rotateX(15deg);
                filter: blur(8px);
            }
            30% {
                opacity: 0.4;
                transform: scale(0.85) translateY(30px) rotateX(8deg);
                filter: blur(4px);
            }
            70% {
                opacity: 0.8;
                transform: scale(0.95) translateY(10px) rotateX(3deg);
                filter: blur(1px);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0) rotateX(0deg);
                filter: blur(0px);
            }
        }

        @keyframes slideInTablet {
            0% {
                opacity: 0;
                transform: scale(0.6) translateX(40px) rotateZ(8deg) rotateY(15deg);
                filter: blur(6px);
            }
            30% {
                opacity: 0.4;
                transform: scale(0.75) translateX(25px) rotateZ(5deg) rotateY(8deg);
                filter: blur(3px);
            }
            70% {
                opacity: 0.8;
                transform: scale(0.85) translateX(10px) rotateZ(2deg) rotateY(3deg);
                filter: blur(1px);
            }
            100% {
                opacity: 1;
                transform: scale(0.9) translateX(0) rotateZ(0deg) rotateY(0deg);
                filter: blur(0px);
            }
        }

        @keyframes slideInMobile {
            0% {
                opacity: 0;
                transform: scale(0.5) translateX(-40px) rotateZ(-8deg) rotateY(-15deg);
                filter: blur(6px);
            }
            30% {
                opacity: 0.4;
                transform: scale(0.65) translateX(-25px) rotateZ(-5deg) rotateY(-8deg);
                filter: blur(3px);
            }
            70% {
                opacity: 0.8;
                transform: scale(0.75) translateX(-10px) rotateZ(-2deg) rotateY(-3deg);
                filter: blur(1px);
            }
            100% {
                opacity: 1;
                transform: scale(0.8) translateX(0) rotateZ(0deg) rotateY(0deg);
                filter: blur(0px);
            }
        }

        /* PREVIEW CONTENT FADE TRANSITION */
        .preview-content {
            transition: all 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            will-change: transform, opacity;
        }

        .view-switching .preview-content {
            opacity: 0.5;
            transform: translateY(10px);
        }

        /* DEVICE SWITCH PULSE ANIMATION */
        @keyframes deviceSwitchPulse {
            0% { 
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.4);
            }
            50% { 
                transform: scale(1.02);
                box-shadow: 0 0 0 20px rgba(59, 130, 246, 0.1);
            }
            100% { 
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(59, 130, 246, 0);
            }
        }

        .preview-screen {
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            background: white;
        }

        .preview-content {
            transition: all 0.3s ease;
        }

        /* Print Styles */
        @media print {
            .sidebar, .language-toggle, .btn {
                display: none !important;
            }
            
            .preview-area {
                width: 100% !important;
                background: white !important;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback, useMemo } = React;

        // Comprehensive translations with more content
        const translations = {
            en: {
                // Main navigation
                title: "Restaurant Menu Builder",
                subtitle: "Create beautiful, multilingual digital menus with drag-and-drop ease",
                selectTemplate: "Choose Your Template",
                getStarted: "Get Started",
                
                // Templates
                "dark-neon": "Dark Neon",
                "elegant-script": "Elegant Script",
                "image-grid": "Image Grid", 
                "minimal-zen": "Minimal Zen",
                "dark-neonDesc": "Futuristic dark theme with neon accents and cyber styling",
                "elegant-scriptDesc": "Sophisticated French restaurant with gold accents and script fonts",
                "image-gridDesc": "Photo-focused layout with bold typography and vibrant colors",
                "minimal-zenDesc": "Clean, spacious design with mindful simplicity",
                useTemplate: "Use This Template",
                chooseTemplate: "Choose This Template",
                templateSelected: "Template Selected!",
                perfectChoice: "Perfect Choice!",
                selectedTemplate: "You selected",
                chooseDifferent: "Choose Different",
                startBuilding: "Start Building",
                
                // Editor
                menuEditor: "Menu Editor",
                restaurantInfo: "Restaurant Information",
                design: "Design Settings",
                sections: "Menu Sections",
                preview: "Preview",
                
                // Forms
                restaurantName: "Restaurant Name",
                tagline: "Restaurant Tagline",
                addSection: "Add Section",
                addItem: "Add Menu Item",
                editItem: "Edit Menu Item",
                editSection: "Edit Section",
                
                // Item fields
                itemName: "Item Name (English)",
                itemNameAr: "Item Name (Arabic)",
                description: "Description (English)",
                descriptionAr: "Description (Arabic)",
                price: "Price ($)",
                image: "Food Image",
                model3d: "3D Model (.glb)",
                
                // Item properties
                spicy: "Spicy 🌶️",
                vegetarian: "Vegetarian 🌱",
                vegan: "Vegan 🌿",
                glutenFree: "Gluten Free",
                popular: "Popular Choice",
                
                // Actions
                save: "Save Changes",
                cancel: "Cancel",
                delete: "Delete",
                edit: "Edit",
                duplicate: "Duplicate",
                publish: "Publish Menu",
                share: "Share Menu",
                
                // Design controls
                colorScheme: "Color Scheme",
                fontFamily: "Font Style",
                spacing: "Layout Spacing",
                headerStyle: "Header Style",
                
                // Preview modes
                desktop: "Desktop",
                mobile: "Mobile",
                tablet: "Tablet",
                desktopView: "Desktop View",
                mobileView: "Mobile View",
                tabletView: "Tablet View",
                
                // Sharing
                published: "🎉 Menu Published Successfully!",
                shareLink: "Share this link with your customers:",
                qrCode: "QR Code for Easy Access",
                copyLink: "Copy Link",
                downloadQR: "Download QR Code",
                linkCopied: "Link copied to clipboard!",
                
                // Status messages
                saving: "Saving...",
                loading: "Loading...",
                uploadingImage: "Uploading image...",
                uploading3D: "Uploading 3D model...",
                
                // Placeholders
                enterRestaurantName: "Enter your restaurant name",
                enterTagline: "Enter a catchy tagline",
                enterItemName: "e.g., Grilled Salmon",
                enterDescription: "Describe this delicious item...",
                enterPrice: "0.00",
                
                // Landing page features
                beautifulTemplates: "Beautiful Templates",
                beautifulTemplatesDesc: "Choose from professionally designed templates",
                multilingualSupport: "Multilingual Support", 
                multilingualSupportDesc: "Support for Arabic and English with RTL",
                mobileFriendly: "Mobile Friendly",
                mobileFriendlyDesc: "Perfect on all devices and screen sizes",
                
                // Welcome modal
                welcome: "Welcome!",
                welcomeMessage: "Enter your name to get started",
                yourName: "Your Name",
                enterName: "Enter your name",
                continueToTemplates: "Continue to Templates",
                
                // Empty states
                noSections: "No menu sections yet. Start by adding your first section!",
                noItems: "No items in this section. Add your first menu item!",
                
                // File upload
                chooseFile: "Choose File",
                dragDropHint: "Drag & drop files here or click to browse",
                supportedFormats: "Supported: JPG, PNG, WebP for images | GLB for 3D models",
                removeFile: "Remove File",
                
                // Section fields
                sectionName: "Section Name (English)",
                sectionNameAr: "Section Name (Arabic)", 
                sectionDesc: "Section Description (English)",
                sectionDescAr: "Section Description (Arabic)",
                
                // Validation
                nameRequired: "Name is required",
                priceRequired: "Price is required",
                invalidPrice: "Please enter a valid price",
                
                // Success messages
                itemAdded: "Menu item added successfully!",
                itemUpdated: "Menu item updated successfully!",
                sectionAdded: "Menu section added successfully!",
                sectionUpdated: "Menu section updated successfully!",
                menuSaved: "Menu saved successfully!",
            },
            ar: {
                // Main navigation
                title: "منشئ قوائم المطاعم",
                subtitle: "إنشاء قوائم رقمية جميلة ومتعددة اللغات بسهولة السحب والإفلات",
                selectTemplate: "اختر القالب المناسب",
                getStarted: "ابدأ الآن",
                
                // Templates
                "dark-neon": "نيون داكن",
                "elegant-script": "خط أنيق",
                "image-grid": "شبكة صور",
                "minimal-zen": "بساطة زين",
                "dark-neonDesc": "تصميم مستقبلي داكن مع لمسات نيون وتصميم سايبر",
                "elegant-scriptDesc": "مطعم فرنسي راقي مع لمسات ذهبية وخطوط أنيقة",
                "image-gridDesc": "تخطيط يركز على الصور مع طباعة جريئة وألوان نابضة بالحياة",
                "minimal-zenDesc": "تصميم نظيف وواسع مع بساطة واعية",
                useTemplate: "استخدم هذا القالب",
                chooseTemplate: "اختر هذا القالب",
                templateSelected: "تم اختيار القالب!",
                perfectChoice: "اختيار مثالي!",
                selectedTemplate: "لقد اخترت",
                chooseDifferent: "اختر قالب مختلف",
                startBuilding: "ابدأ البناء",
                
                // Editor
                menuEditor: "محرر القائمة",
                restaurantInfo: "معلومات المطعم",
                design: "إعدادات التصميم",
                sections: "أقسام القائمة",
                preview: "معاينة",
                
                // Forms
                restaurantName: "اسم المطعم",
                tagline: "شعار المطعم",
                addSection: "إضافة قسم",
                addItem: "إضافة عنصر قائمة",
                editItem: "تعديل عنصر القائمة",
                editSection: "تعديل القسم",
                
                // Item fields
                itemName: "اسم العنصر (إنجليزي)",
                itemNameAr: "اسم العنصر (عربي)",
                description: "الوصف (إنجليزي)",
                descriptionAr: "الوصف (عربي)",
                price: "السعر (ريال)",
                image: "صورة الطعام",
                model3d: "نموذج ثلاثي الأبعاد (.glb)",
                
                // Item properties
                spicy: "حار 🌶️",
                vegetarian: "نباتي 🌱",
                vegan: "نباتي تماماً 🌿",
                glutenFree: "خالي من الجلوتين",
                popular: "الأكثر طلباً",
                
                // Actions
                save: "حفظ التغييرات",
                cancel: "إلغاء",
                delete: "حذف",
                edit: "تعديل",
                duplicate: "نسخ",
                publish: "نشر القائمة",
                share: "مشاركة القائمة",
                
                // Design controls
                colorScheme: "نظام الألوان",
                fontFamily: "نمط الخط",
                spacing: "تباعد التخطيط",
                headerStyle: "نمط الرأس",
                
                // Preview modes
                desktop: "سطح المكتب",
                mobile: "الهاتف",
                tablet: "اللوحي",
                desktopView: "عرض سطح المكتب",
                mobileView: "عرض الهاتف المحمول",
                tabletView: "عرض الجهاز اللوحي",
                
                // Sharing
                published: "🎉 تم نشر القائمة بنجاح!",
                shareLink: "شارك هذا الرابط مع عملائك:",
                qrCode: "رمز الاستجابة السريعة للوصول السهل",
                copyLink: "نسخ الرابط",
                downloadQR: "تحميل رمز الاستجابة السريعة",
                linkCopied: "تم نسخ الرابط!",
                
                // Status messages
                saving: "جاري الحفظ...",
                loading: "جاري التحميل...",
                uploadingImage: "جاري رفع الصورة...",
                uploading3D: "جاري رفع النموذج ثلاثي الأبعاد...",
                
                // Placeholders
                enterRestaurantName: "أدخل اسم مطعمك",
                enterTagline: "أدخل شعاراً جذاباً",
                enterItemName: "مثال: سلمون مشوي",
                enterDescription: "صف هذا الطبق اللذيذ...",
                enterPrice: "0.00",
                
                // Landing page features
                beautifulTemplates: "قوالب جميلة",
                beautifulTemplatesDesc: "اختر من القوالب المصممة بشكل احترافي",
                multilingualSupport: "دعم متعدد اللغات", 
                multilingualSupportDesc: "دعم للعربية والإنجليزية مع اتجاه النص",
                mobileFriendly: "متوافق مع الهاتف",
                mobileFriendlyDesc: "مثالي على جميع الأجهزة وأحجام الشاشات",
                
                // Welcome modal
                welcome: "مرحباً!",
                welcomeMessage: "أدخل اسمك للبدء",
                yourName: "اسمك",
                enterName: "أدخل اسمك",
                continueToTemplates: "المتابعة إلى القوالب",
                
                // Empty states
                noSections: "لا توجد أقسام في القائمة بعد. ابدأ بإضافة قسمك الأول!",
                noItems: "لا توجد عناصر في هذا القسم. أضف أول عنصر في القائمة!",
                
                // File upload
                chooseFile: "اختر ملف",
                dragDropHint: "اسحب وأفلت الملفات هنا أو انقر للتصفح",
                supportedFormats: "المدعوم: JPG، PNG، WebP للصور | GLB للنماذج ثلاثية الأبعاد",
                removeFile: "إزالة الملف",
                
                // Section fields
                sectionName: "اسم القسم (إنجليزي)",
                sectionNameAr: "اسم القسم (عربي)",
                sectionDesc: "وصف القسم (إنجليزي)",
                sectionDescAr: "وصف القسم (عربي)",
                
                // Validation
                nameRequired: "الاسم مطلوب",
                priceRequired: "السعر مطلوب",
                invalidPrice: "يرجى إدخال سعر صحيح",
                
                // Success messages
                itemAdded: "تم إضافة عنصر القائمة بنجاح!",
                itemUpdated: "تم تحديث عنصر القائمة بنجاح!",
                sectionAdded: "تم إضافة قسم القائمة بنجاح!",
                sectionUpdated: "تم تحديث قسم القائمة بنجاح!",
                menuSaved: "تم حفظ القائمة بنجاح!",
            }
        };

        // Language Context
        const LanguageContext = React.createContext();

        function LanguageProvider({ children }) {
            const [language, setLanguage] = useState('en');
            const isRTL = language === 'ar';
            
            const t = useCallback((key) => {
                return translations[language][key] || key;
            }, [language]);
            
            const toggleLanguage = useCallback(() => {
                const newLanguage = language === 'en' ? 'ar' : 'en';
                const newDirection = newLanguage === 'ar' ? 'rtl' : 'ltr';
                
                // Apply language switch animation to body
                document.body.classList.add('language-switch');
                
                // Instant direction change
                document.documentElement.dir = newDirection;
                document.documentElement.lang = newLanguage;
                
                // Update language state
                setLanguage(newLanguage);
                
                // Remove animation class after animation completes
                setTimeout(() => {
                    document.body.classList.remove('language-switch');
                }, 500);
            }, [language]);
            
            const value = useMemo(() => ({
                language, isRTL, t, toggleLanguage
            }), [language, isRTL, t, toggleLanguage]);
            
            return React.createElement(LanguageContext.Provider, { value }, children);
        }

        function useLanguage() {
            const context = React.useContext(LanguageContext);
            if (!context) {
                throw new Error('useLanguage must be used within LanguageProvider');
            }
            return context;
        }

        // Toast Context for notifications
        const ToastContext = React.createContext();

        function ToastProvider({ children }) {
            const [toasts, setToasts] = useState([]);
            
            const addToast = useCallback((message, type = 'success') => {
                const id = Date.now();
                const newToast = { id, message, type };
                setToasts(prev => [...prev, newToast]);
                
                setTimeout(() => {
                    setToasts(prev => prev.filter(toast => toast.id !== id));
                }, 3000);
            }, []);
            
            const removeToast = useCallback((id) => {
                setToasts(prev => prev.filter(toast => toast.id !== id));
            }, []);
            
            const value = useMemo(() => ({
                toasts, addToast, removeToast
            }), [toasts, addToast, removeToast]);
            
            return React.createElement(ToastContext.Provider, { value }, children);
        }

        function useToast() {
            const context = React.useContext(ToastContext);
            if (!context) {
                throw new Error('useToast must be used within ToastProvider');
            }
            return context;
        }

        // Toast Component
        function Toast({ toast, onRemove }) {
            const { t } = useLanguage();
            
            useEffect(() => {
                const timer = setTimeout(() => {
                    onRemove(toast.id);
                }, 3000);
                
                return () => clearTimeout(timer);
            }, [toast.id, onRemove]);
            
            const bgColor = toast.type === 'error' ? 'bg-red-50 border-red-200' : 
                           toast.type === 'warning' ? 'bg-yellow-50 border-yellow-200' :
                           'bg-green-50 border-green-200';
            
            const textColor = toast.type === 'error' ? 'text-red-800' :
                             toast.type === 'warning' ? 'text-yellow-800' :
                             'text-green-800';
            
            return React.createElement('div', {
                className: `toast ${bgColor} ${textColor}`,
                onClick: () => onRemove(toast.id)
            }, [
                React.createElement('div', {
                    key: 'content',
                    className: 'flex items-center gap-2'
                }, [
                    React.createElement('span', { key: 'icon' }, 
                        toast.type === 'error' ? '❌' :
                        toast.type === 'warning' ? '⚠️' : '✅'
                    ),
                    React.createElement('span', { key: 'message' }, toast.message)
                ]),
                React.createElement('button', {
                    key: 'close',
                    className: 'ml-2 text-gray-400 hover:text-gray-600',
                    onClick: (e) => {
                        e.stopPropagation();
                        onRemove(toast.id);
                    }
                }, '×')
            ]);
        }

        // Visually Unique Templates with Live Previews
        const templates = [
            {
                id: 'dark-neon',
                name: 'Dark Neon',
                description: 'Modern dark theme with neon accents and futuristic vibes',
                colorScheme: 'indigo',
                fontFamily: 'inter',
                headerStyle: 'gradient',
                spacing: 3,
                category: 'modern',
                preview: {
                    theme: 'dark',
                    headerBg: 'linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%)',
                    accentColor: '#00f5ff',
                    secondaryColor: '#ff00aa',
                    typography: 'Inter',
                    buttonStyle: 'neon'
                },
                mockData: {
                    restaurantName: 'NEON BISTRO',
                    tagline: 'Future of Dining',
                    sections: [
                        { 
                            name: 'CYBER STARTERS', 
                            items: [
                                { name: 'Neural Nachos', price: '$18', featured: true },
                                { name: 'Digital Dumplings', price: '$22' }
                            ]
                        },
                        { 
                            name: 'MAIN PROTOCOL', 
                            items: [
                                { name: 'Quantum Burger', price: '$28' },
                                { name: 'Binary Pasta', price: '$24' }
                            ]
                        }
                    ]
                }
            },
            {
                id: 'elegant-script',
                name: 'Elegant Script',
                description: 'Sophisticated script fonts with gold accents and classic elegance',
                colorScheme: 'rose',
                fontFamily: 'serif',
                headerStyle: 'image',
                spacing: 4,
                category: 'elegant',
                preview: {
                    theme: 'light',
                    headerBg: 'linear-gradient(135deg, #f7f1e3 0%, #f5e6d3 50%, #e8d5b7 100%)',
                    accentColor: '#d4af37',
                    secondaryColor: '#8b4513',
                    typography: 'Playfair Display',
                    buttonStyle: 'classic'
                },
                mockData: {
                    restaurantName: 'La Belle Époque',
                    tagline: 'Fine French Cuisine Since 1889',
                    sections: [
                        { 
                            name: 'Les Entrées', 
                            items: [
                                { name: 'Escargots de Bourgogne', price: '€24', special: true },
                                { name: 'Pâté de Foie Gras', price: '€32' }
                            ]
                        },
                        { 
                            name: 'Les Plats Principaux', 
                            items: [
                                { name: 'Bouillabaisse Marseillaise', price: '€45' },
                                { name: 'Bœuf Wellington', price: '€52' }
                            ]
                        }
                    ]
                }
            },
            {
                id: 'image-grid',
                name: 'Image Grid',
                description: 'Photo-focused layout with bold typography and vibrant colors',
                colorScheme: 'amber',
                fontFamily: 'sans',
                headerStyle: 'image',
                spacing: 2,
                category: 'visual',
                preview: {
                    theme: 'vibrant',
                    headerBg: 'linear-gradient(135deg, #ff6b35 0%, #f7931e 50%, #ffd23f 100%)',
                    accentColor: '#ff6b35',
                    secondaryColor: '#2c3e50',
                    typography: 'Montserrat',
                    buttonStyle: 'bold'
                },
                mockData: {
                    restaurantName: 'STREET KITCHEN',
                    tagline: 'Bold Flavors, Fresh Ingredients',
                    sections: [
                        { 
                            name: 'SIGNATURE BOWLS', 
                            items: [
                                { name: 'Korean BBQ Bowl', price: '$16', hasImage: true },
                                { name: 'Med Quinoa Bowl', price: '$14', hasImage: true }
                            ]
                        },
                        { 
                            name: 'CRAFT BURGERS', 
                            items: [
                                { name: 'Truffle Burger', price: '$18', hasImage: true },
                                { name: 'Spicy Jalapeño', price: '$16', hasImage: true }
                            ]
                        }
                    ]
                }
            },
            {
                id: 'minimal-zen',
                name: 'Minimal Zen',
                description: 'Clean, spacious design with subtle elegance and mindful simplicity',
                colorScheme: 'emerald',
                fontFamily: 'sans',
                headerStyle: 'solid',
                spacing: 5,
                category: 'minimal',
                preview: {
                    theme: 'minimal',
                    headerBg: 'linear-gradient(135deg, #ffffff 0%, #f8f9fa 50%, #e9ecef 100%)',
                    accentColor: '#2d3748',
                    secondaryColor: '#718096',
                    typography: 'Inter',
                    buttonStyle: 'minimal'
                },
                mockData: {
                    restaurantName: 'zen',
                    tagline: 'mindful dining',
                    sections: [
                        { 
                            name: 'starters', 
                            items: [
                                { name: 'miso soup', price: '12' },
                                { name: 'edamame', price: '8' }
                            ]
                        },
                        { 
                            name: 'mains', 
                            items: [
                                { name: 'salmon teriyaki', price: '28' },
                                { name: 'vegetable ramen', price: '22' }
                            ]
                        }
                    ]
                }
            }
        ];

        // Local Storage utilities
        const storage = {
            save: (key, data) => {
                try {
                    localStorage.setItem(key, JSON.stringify(data));
                } catch (error) {
                    console.error('Failed to save to localStorage:', error);
                }
            },
            load: (key, defaultValue = null) => {
                try {
                    const stored = localStorage.getItem(key);
                    return stored ? JSON.parse(stored) : defaultValue;
                } catch (error) {
                    console.error('Failed to load from localStorage:', error);
                    return defaultValue;
                }
            },
            remove: (key) => {
                try {
                    localStorage.removeItem(key);
                } catch (error) {
                    console.error('Failed to remove from localStorage:', error);
                }
            }
        };

        // Enhanced File Upload Component with drag & drop
        function FileUpload({ accept, onUpload, currentFile, label, type, className = '' }) {
            const { t } = useLanguage();
            const { addToast } = useToast();
            const fileInputRef = useRef(null);
            const [preview, setPreview] = useState(currentFile || null);
            const [isDragging, setIsDragging] = useState(false);
            const [isUploading, setIsUploading] = useState(false);

            const handleFileSelect = useCallback(async (file) => {
                if (!file) return;
                
                setIsUploading(true);
                addToast(type === '3d' ? t('uploading3D') : t('uploadingImage'), 'info');
                
                try {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const result = e.target.result;
                        setPreview(result);
                        onUpload(result);
                        setIsUploading(false);
                        addToast(`${label} uploaded successfully!`, 'success');
                    };
                    reader.readAsDataURL(file);
                } catch (error) {
                    setIsUploading(false);
                    addToast('Upload failed. Please try again.', 'error');
                }
            }, [onUpload, type, label, t, addToast]);

            const handleDrop = useCallback((e) => {
                e.preventDefault();
                setIsDragging(false);
                
                const files = Array.from(e.dataTransfer.files);
                if (files.length > 0) {
                    handleFileSelect(files[0]);
                }
            }, [handleFileSelect]);

            const handleDragOver = useCallback((e) => {
                e.preventDefault();
                setIsDragging(true);
            }, []);

            const handleDragLeave = useCallback((e) => {
                e.preventDefault();
                setIsDragging(false);
            }, []);

            const renderPreview = () => {
                if (!preview) return null;

                if (type === '3d' && preview.includes('data:')) {
                    return React.createElement('div', {
                        className: 'mt-3 p-4 bg-blue-50 border border-blue-200 rounded-lg text-center'
                    }, [
                        React.createElement('div', {
                            key: 'icon',
                            className: 'text-3xl mb-2'
                        }, '🎮'),
                        React.createElement('p', {
                            key: 'text',
                            className: 'text-blue-700 font-medium'
                        }, '3D Model Ready!')
                    ]);
                } else if (type === 'image' && preview.includes('data:')) {
                    return React.createElement('div', {
                        className: 'mt-3'
                    }, [
                        React.createElement('img', {
                            key: 'preview',
                            src: preview,
                            alt: 'Preview',
                            className: 'w-full h-32 object-cover rounded-lg border border-gray-200'
                        })
                    ]);
                }
                return null;
            };

            return React.createElement('div', {
                className: `space-y-3 ${className}`
            }, [
                React.createElement('label', {
                    key: 'label',
                    className: 'block text-sm font-semibold text-gray-700'
                }, label),
                
                React.createElement('div', {
                    key: 'upload-area',
                    className: `border-2 border-dashed rounded-xl p-6 text-center transition-all ${
                        isDragging ? 'border-blue-400 bg-blue-50' : 'border-gray-300 hover:border-gray-400'
                    }`,
                    onDrop: handleDrop,
                    onDragOver: handleDragOver,
                    onDragLeave: handleDragLeave
                }, [
                    React.createElement('input', {
                        key: 'input',
                        ref: fileInputRef,
                        type: 'file',
                        accept: accept,
                        onChange: (e) => handleFileSelect(e.target.files[0]),
                        className: 'hidden'
                    }),
                    
                    isUploading ? React.createElement('div', {
                        key: 'loading',
                        className: 'flex flex-col items-center'
                    }, [
                        React.createElement('div', {
                            key: 'spinner',
                            className: 'loading-spinner mb-2'
                        }),
                        React.createElement('p', {
                            key: 'text',
                            className: 'text-gray-600'
                        }, t('loading'))
                    ]) : React.createElement('div', {
                        key: 'upload-content',
                        className: 'space-y-3'
                    }, [
                        React.createElement('div', {
                            key: 'icon',
                            className: 'text-4xl'
                        }, type === '3d' ? '🎮' : '📷'),
                        
                        React.createElement('p', {
                            key: 'hint',
                            className: 'text-gray-600'
                        }, t('dragDropHint')),
                        
                        React.createElement('button', {
                            key: 'button',
                            type: 'button',
                            className: 'btn btn-primary',
                            onClick: () => fileInputRef.current?.click()
                        }, t('chooseFile')),
                        
                        React.createElement('p', {
                            key: 'formats',
                            className: 'text-xs text-gray-500'
                        }, t('supportedFormats'))
                    ]),
                    
                    preview && React.createElement('button', {
                        key: 'remove',
                        type: 'button',
                        className: 'btn btn-danger mt-3',
                        onClick: () => {
                            setPreview(null);
                            onUpload('');
                        }
                    }, t('removeFile'))
                ]),
                
                renderPreview()
            ]);
        }

        // Enhanced Template Selection with better previews
        function TemplateSelection({ onSelectTemplate }) {
            const { t, isRTL } = useLanguage();
            const [selectedTemplate, setSelectedTemplate] = useState(null);

            const handleSelectTemplate = (template) => {
                setSelectedTemplate(template.id);
                setTimeout(() => {
                    onSelectTemplate(template);
                }, 300);
            };

            return React.createElement('div', {
                className: `min-h-screen p-8 ${isRTL ? 'rtl' : ''}`,
                dir: isRTL ? 'rtl' : 'ltr'
            }, [
                React.createElement('div', {
                    key: 'header',
                    className: 'text-center mb-16 animate-fade-in'
                }, [
                    React.createElement('h1', {
                        key: 'title',
                        className: 'text-6xl font-bold text-white mb-6 leading-tight'
                    }, t('title')),
                    React.createElement('p', {
                        key: 'subtitle',
                        className: 'text-xl text-white opacity-90 max-w-2xl mx-auto leading-relaxed'
                    }, t('subtitle')),
                    React.createElement('div', {
                        key: 'cta',
                        className: 'mt-8'
                    }, [
                        React.createElement('button', {
                            key: 'get-started',
                            className: 'btn btn-primary text-lg px-8 py-4',
                            onClick: () => document.getElementById('templates').scrollIntoView({ behavior: 'smooth' })
                        }, t('getStarted'))
                    ])
                ]),
                
                React.createElement('div', {
                    key: 'templates',
                    id: 'templates',
                    className: 'max-w-7xl mx-auto'
                }, [
                    React.createElement('h2', {
                        key: 'section-title',
                        className: 'text-3xl font-bold text-white text-center mb-12'
                    }, t('selectTemplate')),
                    
                    React.createElement('div', {
                        key: 'grid',
                        className: 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8'
                    }, templates.map((template, index) => 
                        React.createElement('div', {
                            key: template.id,
                            className: `template-card bg-white rounded-2xl overflow-hidden shadow-xl animate-slide-up ${
                                selectedTemplate === template.id ? 'ring-4 ring-white ring-opacity-50' : ''
                            }`,
                            style: { animationDelay: `${index * 100}ms` }
                        }, [
                            React.createElement('div', {
                                key: 'preview',
                                className: 'h-64 relative overflow-hidden',
                                style: { background: template.preview.headerBg }
                            }, [
                                React.createElement('div', {
                                    key: 'mock-header',
                                    className: 'absolute top-0 left-0 right-0 h-16 flex items-center justify-center text-white font-bold text-lg',
                                    style: { fontFamily: template.preview.typography }
                                }, 'Restaurant Name'),
                                
                                React.createElement('div', {
                                    key: 'mock-content',
                                    className: 'absolute bottom-0 left-0 right-0 bg-white p-4 space-y-2'
                                }, [
                                    React.createElement('div', {
                                        key: 'section',
                                        className: 'font-semibold text-gray-800 text-sm'
                                    }, 'Appetizers'),
                                    React.createElement('div', {
                                        key: 'item1',
                                        className: 'flex justify-between items-center text-xs'
                                    }, [
                                        React.createElement('span', { key: 'name' }, 'Caesar Salad'),
                                        React.createElement('span', { key: 'price' }, '$12')
                                    ]),
                                    React.createElement('div', {
                                        key: 'item2',
                                        className: 'flex justify-between items-center text-xs'
                                    }, [
                                        React.createElement('span', { key: 'name' }, 'Soup of the Day'),
                                        React.createElement('span', { key: 'price' }, '$8')
                                    ])
                                ])
                            ]),
                            
                            React.createElement('div', {
                                key: 'content',
                                className: 'p-6'
                            }, [
                                React.createElement('div', {
                                    key: 'header',
                                    className: 'mb-4'
                                }, [
                                    React.createElement('h3', {
                                        key: 'name',
                                        className: 'text-xl font-bold mb-2'
                                    }, t(template.name.toLowerCase())),
                                    React.createElement('p', {
                                        key: 'desc',
                                        className: 'text-gray-600 text-sm'
                                    }, t(template.name.toLowerCase() + 'Desc'))
                                ]),
                                
                                React.createElement('div', {
                                    key: 'features',
                                    className: 'space-y-2 mb-6'
                                }, [
                                    React.createElement('div', {
                                        key: 'color',
                                        className: 'flex items-center text-sm text-gray-600'
                                    }, [
                                        React.createElement('div', {
                                            key: 'swatch',
                                            className: 'w-3 h-3 rounded-full mr-2',
                                            style: { backgroundColor: template.preview.accentColor }
                                        }),
                                        React.createElement('span', { key: 'label' }, 'Color Scheme')
                                    ]),
                                    React.createElement('div', {
                                        key: 'font',
                                        className: 'flex items-center text-sm text-gray-600'
                                    }, [
                                        React.createElement('span', { key: 'icon', className: 'mr-2' }, '✨'),
                                        React.createElement('span', { key: 'label' }, template.preview.typography)
                                    ])
                                ]),
                                
                                React.createElement('button', {
                                    key: 'button',
                                    className: 'btn btn-primary w-full',
                                    onClick: () => handleSelectTemplate(template),
                                    disabled: selectedTemplate === template.id
                                }, selectedTemplate === template.id ? 'Selected ✓' : t('useTemplate'))
                            ])
                        ])
                    ))
                ])
            ]);
        }

        // Enhanced Item Edit Modal with better validation
        function ItemEditModal({ isOpen, onClose, onSave, item }) {
            const { t, isRTL } = useLanguage();
            const { addToast } = useToast();
            const [formData, setFormData] = useState({
                name: '',
                nameAr: '',
                description: '',
                descriptionAr: '',
                price: '',
                image: '',
                model3d: '',
                isSpicy: false,
                isVegetarian: false,
                isVegan: false,
                isGlutenFree: false,
                isPopular: false
            });
            const [errors, setErrors] = useState({});
            const [isSaving, setIsSaving] = useState(false);

            useEffect(() => {
                if (item) {
                    setFormData({ ...formData, ...item });
                } else {
                    setFormData({
                        name: '',
                        nameAr: '',
                        description: '',
                        descriptionAr: '',
                        price: '',
                        image: '',
                        model3d: '',
                        isSpicy: false,
                        isVegetarian: false,
                        isVegan: false,
                        isGlutenFree: false,
                        isPopular: false
                    });
                }
                setErrors({});
            }, [item, isOpen]);

            const validateForm = () => {
                const newErrors = {};
                
                if (!formData.name.trim()) {
                    newErrors.name = t('nameRequired');
                }
                
                if (!formData.price || parseFloat(formData.price) <= 0) {
                    newErrors.price = t('priceRequired');
                }
                
                setErrors(newErrors);
                return Object.keys(newErrors).length === 0;
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                
                if (!validateForm()) {
                    addToast('Please fix the errors below', 'error');
                    return;
                }
                
                setIsSaving(true);
                
                try {
                    await onSave(formData);
                    addToast(item ? t('itemUpdated') : t('itemAdded'), 'success');
                    onClose();
                } catch (error) {
                    addToast('Failed to save item. Please try again.', 'error');
                } finally {
                    setIsSaving(false);
                }
            };

            if (!isOpen) return null;

            return React.createElement('div', { className: 'modal' },
                React.createElement('div', {
                    className: `modal-content animate-slide-up ${isRTL ? 'rtl' : ''}`,
                    dir: isRTL ? 'rtl' : 'ltr'
                }, [
                    React.createElement('div', {
                        key: 'header',
                        className: 'flex items-center justify-between mb-6'
                    }, [
                        React.createElement('h2', {
                            key: 'title',
                            className: 'text-2xl font-bold text-gray-800'
                        }, item ? t('editItem') : t('addItem')),
                        React.createElement('button', {
                            key: 'close',
                            className: 'text-gray-400 hover:text-gray-600 text-2xl',
                            onClick: onClose
                        }, '×')
                    ]),
                    
                    React.createElement('form', {
                        key: 'form',
                        onSubmit: handleSubmit,
                        className: 'space-y-6'
                    }, [
                        React.createElement('div', {
                            key: 'name-row',
                            className: 'grid grid-cols-1 md:grid-cols-2 gap-4'
                        }, [
                            React.createElement('div', { key: 'name' }, [
                                React.createElement('label', {
                                    key: 'label',
                                    className: 'block text-sm font-semibold text-gray-700 mb-2'
                                }, t('itemName')),
                                React.createElement('input', {
                                    key: 'input',
                                    type: 'text',
                                    className: `input-field ${errors.name ? 'border-red-500' : ''}`,
                                    value: formData.name,
                                    onChange: (e) => setFormData({...formData, name: e.target.value}),
                                    placeholder: t('enterItemName')
                                }),
                                errors.name && React.createElement('p', {
                                    key: 'error',
                                    className: 'text-red-500 text-xs mt-1'
                                }, errors.name)
                            ]),
                            React.createElement('div', { key: 'nameAr' }, [
                                React.createElement('label', {
                                    key: 'label',
                                    className: 'block text-sm font-semibold text-gray-700 mb-2'
                                }, t('itemNameAr')),
                                React.createElement('input', {
                                    key: 'input',
                                    type: 'text',
                                    className: 'input-field',
                                    value: formData.nameAr,
                                    onChange: (e) => setFormData({...formData, nameAr: e.target.value}),
                                    dir: 'rtl',
                                    placeholder: t('enterItemName')
                                })
                            ])
                        ]),
                        
                        React.createElement('div', {
                            key: 'desc-row',
                            className: 'grid grid-cols-1 md:grid-cols-2 gap-4'
                        }, [
                            React.createElement('div', { key: 'desc' }, [
                                React.createElement('label', {
                                    key: 'label',
                                    className: 'block text-sm font-semibold text-gray-700 mb-2'
                                }, t('description')),
                                React.createElement('textarea', {
                                    key: 'input',
                                    className: 'input-field',
                                    rows: 3,
                                    value: formData.description,
                                    onChange: (e) => setFormData({...formData, description: e.target.value}),
                                    placeholder: t('enterDescription')
                                })
                            ]),
                            React.createElement('div', { key: 'descAr' }, [
                                React.createElement('label', {
                                    key: 'label',
                                    className: 'block text-sm font-semibold text-gray-700 mb-2'
                                }, t('descriptionAr')),
                                React.createElement('textarea', {
                                    key: 'input',
                                    className: 'input-field',
                                    rows: 3,
                                    value: formData.descriptionAr,
                                    onChange: (e) => setFormData({...formData, descriptionAr: e.target.value}),
                                    dir: 'rtl',
                                    placeholder: t('enterDescription')
                                })
                            ])
                        ]),
                        
                        React.createElement('div', { key: 'price' }, [
                            React.createElement('label', {
                                key: 'label',
                                className: 'block text-sm font-semibold text-gray-700 mb-2'
                            }, t('price')),
                            React.createElement('input', {
                                key: 'input',
                                type: 'number',
                                step: '0.01',
                                min: '0',
                                className: `input-field ${errors.price ? 'border-red-500' : ''}`,
                                value: formData.price,
                                onChange: (e) => setFormData({...formData, price: e.target.value}),
                                placeholder: t('enterPrice')
                            }),
                            errors.price && React.createElement('p', {
                                key: 'error',
                                className: 'text-red-500 text-xs mt-1'
                            }, errors.price)
                        ]),
                        
                        React.createElement('div', {
                            key: 'uploads',
                            className: 'grid grid-cols-1 md:grid-cols-2 gap-6'
                        }, [
                            React.createElement(FileUpload, {
                                key: 'image-upload',
                                type: 'image',
                                accept: 'image/*',
                                label: t('image'),
                                currentFile: formData.image,
                                onUpload: (url) => setFormData({...formData, image: url})
                            }),
                            React.createElement(FileUpload, {
                                key: '3d-upload',
                                type: '3d',
                                accept: '.glb,.gltf',
                                label: t('model3d'),
                                currentFile: formData.model3d,
                                onUpload: (url) => setFormData({...formData, model3d: url})
                            })
                        ]),
                        
                        React.createElement('div', { key: 'properties' }, [
                            React.createElement('label', {
                                key: 'label',
                                className: 'block text-sm font-semibold text-gray-700 mb-3'
                            }, 'Item Properties'),
                            React.createElement('div', {
                                key: 'checkboxes',
                                className: 'grid grid-cols-2 md:grid-cols-3 gap-3'
                            }, [
                                ['isSpicy', 'spicy'],
                                ['isVegetarian', 'vegetarian'],
                                ['isVegan', 'vegan'],
                                ['isGlutenFree', 'glutenFree'],
                                ['isPopular', 'popular']
                            ].map(([key, labelKey]) => 
                                React.createElement('label', {
                                    key: key,
                                    className: 'flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer transition-colors'
                                }, [
                                    React.createElement('input', {
                                        key: 'input',
                                        type: 'checkbox',
                                        checked: formData[key],
                                        onChange: (e) => setFormData({...formData, [key]: e.target.checked}),
                                        className: 'mr-2 w-4 h-4'
                                    }),
                                    React.createElement('span', {
                                        key: 'label',
                                        className: 'text-sm font-medium'
                                    }, t(labelKey))
                                ])
                            ))
                        ]),
                        
                        React.createElement('div', {
                            key: 'buttons',
                            className: 'flex gap-3 pt-6 border-t border-gray-200'
                        }, [
                            React.createElement('button', {
                                key: 'save',
                                type: 'submit',
                                className: 'btn btn-primary flex-1',
                                disabled: isSaving
                            }, isSaving ? [
                                React.createElement('div', {
                                    key: 'spinner',
                                    className: 'loading-spinner mr-2'
                                }),
                                t('saving')
                            ] : t('save')),
                            React.createElement('button', {
                                key: 'cancel',
                                type: 'button',
                                className: 'btn btn-secondary flex-1',
                                onClick: onClose,
                                disabled: isSaving
                            }, t('cancel'))
                        ])
                    ])
                ])
            );
        }

        // Enhanced Section Edit Modal
        function SectionEditModal({ isOpen, onClose, onSave, section }) {
            const { t, isRTL } = useLanguage();
            const { addToast } = useToast();
            const [formData, setFormData] = useState({
                name: '',
                nameAr: '',
                description: '',
                descriptionAr: ''
            });
            const [errors, setErrors] = useState({});
            const [isSaving, setIsSaving] = useState(false);

            useEffect(() => {
                if (section) {
                    setFormData({ ...formData, ...section });
                } else {
                    setFormData({
                        name: '',
                        nameAr: '',
                        description: '',
                        descriptionAr: ''
                    });
                }
                setErrors({});
            }, [section, isOpen]);

            const validateForm = () => {
                const newErrors = {};
                
                if (!formData.name.trim()) {
                    newErrors.name = t('nameRequired');
                }
                
                setErrors(newErrors);
                return Object.keys(newErrors).length === 0;
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                
                if (!validateForm()) {
                    addToast('Please fix the errors below', 'error');
                    return;
                }
                
                setIsSaving(true);
                
                try {
                    await onSave(formData);
                    addToast(section ? t('sectionUpdated') : t('sectionAdded'), 'success');
                    onClose();
                } catch (error) {
                    addToast('Failed to save section. Please try again.', 'error');
                } finally {
                    setIsSaving(false);
                }
            };

            if (!isOpen) return null;

            return React.createElement('div', { className: 'modal' },
                React.createElement('div', {
                    className: `modal-content animate-slide-up ${isRTL ? 'rtl' : ''}`,
                    dir: isRTL ? 'rtl' : 'ltr'
                }, [
                    React.createElement('div', {
                        key: 'header',
                        className: 'flex items-center justify-between mb-6'
                    }, [
                        React.createElement('h2', {
                            key: 'title',
                            className: 'text-2xl font-bold text-gray-800'
                        }, section ? t('editSection') : t('addSection')),
                        React.createElement('button', {
                            key: 'close',
                            className: 'text-gray-400 hover:text-gray-600 text-2xl',
                            onClick: onClose
                        }, '×')
                    ]),
                    
                    React.createElement('form', {
                        key: 'form',
                        onSubmit: handleSubmit,
                        className: 'space-y-6'
                    }, [
                        React.createElement('div', {
                            key: 'name-row',
                            className: 'grid grid-cols-1 md:grid-cols-2 gap-4'
                        }, [
                            React.createElement('div', { key: 'name' }, [
                                React.createElement('label', {
                                    key: 'label',
                                    className: 'block text-sm font-semibold text-gray-700 mb-2'
                                }, t('sectionName')),
                                React.createElement('input', {
                                    key: 'input',
                                    type: 'text',
                                    className: `input-field ${errors.name ? 'border-red-500' : ''}`,
                                    value: formData.name,
                                    onChange: (e) => setFormData({...formData, name: e.target.value}),
                                    placeholder: 'e.g., Appetizers, Main Courses'
                                }),
                                errors.name && React.createElement('p', {
                                    key: 'error',
                                    className: 'text-red-500 text-xs mt-1'
                                }, errors.name)
                            ]),
                            React.createElement('div', { key: 'nameAr' }, [
                                React.createElement('label', {
                                    key: 'label',
                                    className: 'block text-sm font-semibold text-gray-700 mb-2'
                                }, t('sectionNameAr')),
                                React.createElement('input', {
                                    key: 'input',
                                    type: 'text',
                                    className: 'input-field',
                                    value: formData.nameAr,
                                    onChange: (e) => setFormData({...formData, nameAr: e.target.value}),
                                    dir: 'rtl',
                                    placeholder: 'مثال: المقبلات، الأطباق الرئيسية'
                                })
                            ])
                        ]),
                        
                        React.createElement('div', {
                            key: 'desc-row',
                            className: 'grid grid-cols-1 md:grid-cols-2 gap-4'
                        }, [
                            React.createElement('div', { key: 'desc' }, [
                                React.createElement('label', {
                                    key: 'label',
                                    className: 'block text-sm font-semibold text-gray-700 mb-2'
                                }, t('sectionDesc')),
                                React.createElement('textarea', {
                                    key: 'input',
                                    className: 'input-field',
                                    rows: 3,
                                    value: formData.description,
                                    onChange: (e) => setFormData({...formData, description: e.target.value}),
                                    placeholder: 'Optional description for this section'
                                })
                            ]),
                            React.createElement('div', { key: 'descAr' }, [
                                React.createElement('label', {
                                    key: 'label',
                                    className: 'block text-sm font-semibold text-gray-700 mb-2'
                                }, t('sectionDescAr')),
                                React.createElement('textarea', {
                                    key: 'input',
                                    className: 'input-field',
                                    rows: 3,
                                    value: formData.descriptionAr,
                                    onChange: (e) => setFormData({...formData, descriptionAr: e.target.value}),
                                    dir: 'rtl',
                                    placeholder: 'وصف اختياري لهذا القسم'
                                })
                            ])
                        ]),
                        
                        React.createElement('div', {
                            key: 'buttons',
                            className: 'flex gap-3 pt-6 border-t border-gray-200'
                        }, [
                            React.createElement('button', {
                                key: 'save',
                                type: 'submit',
                                className: 'btn btn-primary flex-1',
                                disabled: isSaving
                            }, isSaving ? [
                                React.createElement('div', {
                                    key: 'spinner',
                                    className: 'loading-spinner mr-2'
                                }),
                                t('saving')
                            ] : t('save')),
                            React.createElement('button', {
                                key: 'cancel',
                                type: 'button',
                                className: 'btn btn-secondary flex-1',
                                onClick: onClose,
                                disabled: isSaving
                            }, t('cancel'))
                        ])
                    ])
                ])
            );
        }

        // Enhanced Menu Preview with better mobile/desktop views
        function MenuPreview({ menu, sections, viewMode, language }) {
            const { t } = useLanguage();
            
            const renderMenuItem = (item) => {
                const displayName = language === 'ar' && item.nameAr ? item.nameAr : item.name;
                const displayDesc = language === 'ar' && item.descriptionAr ? item.descriptionAr : item.description;
                
                return React.createElement('div', {
                    key: item.id,
                    className: 'menu-item p-4 border-b border-gray-100 last:border-b-0'
                }, [
                    React.createElement('div', {
                        key: 'content',
                        className: 'flex justify-between items-start gap-4'
                    }, [
                        React.createElement('div', {
                            key: 'left',
                            className: 'flex-1'
                        }, [
                            React.createElement('div', {
                                key: 'header',
                                className: 'flex items-center gap-2 mb-2'
                            }, [
                                React.createElement('h4', {
                                    key: 'name',
                                    className: 'font-semibold text-gray-800 text-lg'
                                }, displayName),
                                item.isPopular && React.createElement('span', {
                                    key: 'popular',
                                    className: 'bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded-full'
                                }, '⭐ Popular'),
                                item.isSpicy && React.createElement('span', {
                                    key: 'spicy',
                                    className: 'text-red-500 text-lg'
                                }, '🌶️'),
                                item.isVegetarian && React.createElement('span', {
                                    key: 'veg',
                                    className: 'text-green-500 text-lg'
                                }, '🌱'),
                                item.isVegan && React.createElement('span', {
                                    key: 'vegan',
                                    className: 'text-green-600 text-lg'
                                }, '🌿'),
                                item.isGlutenFree && React.createElement('span', {
                                    key: 'gf',
                                    className: 'bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full'
                                }, 'GF')
                            ]),
                            displayDesc && React.createElement('p', {
                                key: 'desc',
                                className: 'text-gray-600 mb-3 leading-relaxed'
                            }, displayDesc),
                            (item.image || item.model3d) && React.createElement('div', {
                                key: 'media',
                                className: 'mb-3'
                            }, [
                                item.image ? React.createElement('img', {
                                    key: 'img',
                                    src: item.image,
                                    alt: displayName,
                                    className: 'w-20 h-20 object-cover rounded-lg border border-gray-200'
                                }) : item.model3d ? React.createElement('div', {
                                    key: '3d',
                                    className: 'inline-flex items-center gap-2 text-sm text-blue-600 bg-blue-50 px-3 py-2 rounded-lg border border-blue-200'
                                }, [
                                    React.createElement('span', { key: 'icon' }, '🎮'),
                                    React.createElement('span', { key: 'text' }, '3D Model Available')
                                ]) : null
                            ])
                        ]),
                        React.createElement('div', {
                            key: 'price',
                            className: 'font-bold text-xl text-gray-800 flex-shrink-0'
                        }, `$${parseFloat(item.price || 0).toFixed(2)}`)
                    ])
                ]);
            };

            const containerClass = viewMode === 'mobile' ? 'max-w-sm mx-auto' : 
                                 viewMode === 'tablet' ? 'max-w-2xl mx-auto' : 
                                 'max-w-4xl mx-auto';

            const fontClass = menu.fontFamily === 'serif' ? 'font-serif' : 
                             menu.fontFamily === 'sans' ? 'font-sans' : '';

            const colorGradient = menu.colorScheme === 'indigo' ? 'from-indigo-500 to-purple-600' :
                                 menu.colorScheme === 'emerald' ? 'from-emerald-500 to-teal-600' :
                                 menu.colorScheme === 'amber' ? 'from-amber-500 to-orange-600' :
                                 'from-rose-500 to-pink-600';

            if (viewMode === 'mobile') {
                return React.createElement('div', {
                    className: 'preview-phone mx-auto'
                }, [
                    React.createElement('div', {
                        key: 'screen',
                        className: 'preview-phone-screen overflow-y-auto'
                    }, [
                        React.createElement('div', {
                            key: 'content',
                            className: `${containerClass} bg-white rounded-lg shadow-lg overflow-hidden h-full ${fontClass}`
                        }, [
                            React.createElement('div', {
                                key: 'header',
                                className: `p-4 text-white bg-gradient-to-r ${colorGradient}`
                            }, [
                                React.createElement('h1', {
                                    key: 'name',
                                    className: 'text-xl font-bold mb-1'
                                }, menu.restaurantName || t('restaurantName')),
                                menu.tagline && React.createElement('p', {
                                    key: 'tagline',
                                    className: 'opacity-90 text-sm'
                                }, menu.tagline)
                            ]),
                            React.createElement('div', {
                                key: 'content',
                                className: 'p-4'
                            }, sections.length > 0 ? sections.map(section => {
                                const sectionName = language === 'ar' && section.nameAr ? section.nameAr : section.name;
                                const sectionDesc = language === 'ar' && section.descriptionAr ? section.descriptionAr : section.description;
                                
                                return React.createElement('div', {
                                    key: section.id,
                                    className: 'mb-6'
                                }, [
                                    React.createElement('h2', {
                                        key: 'title',
                                        className: 'text-lg font-bold text-gray-800 mb-2 border-b border-gray-200 pb-1'
                                    }, sectionName),
                                    sectionDesc && React.createElement('p', {
                                        key: 'desc',
                                        className: 'text-gray-600 mb-3 text-sm'
                                    }, sectionDesc),
                                    React.createElement('div', {
                                        key: 'items'
                                    }, section.items.map(renderMenuItem))
                                ]);
                            }) : React.createElement('div', {
                                key: 'empty',
                                className: 'text-center text-gray-500 py-8'
                            }, t('noSections')))
                        ])
                    ])
                ]);
            }

            return React.createElement('div', {
                className: `${containerClass} bg-white rounded-lg shadow-lg overflow-hidden ${fontClass}`,
                dir: language === 'ar' ? 'rtl' : 'ltr'
            }, [
                React.createElement('div', {
                    key: 'header',
                    className: `p-8 text-white bg-gradient-to-r ${colorGradient}`
                }, [
                    React.createElement('h1', {
                        key: 'name',
                        className: 'text-4xl font-bold mb-3'
                    }, menu.restaurantName || t('restaurantName')),
                    menu.tagline && React.createElement('p', {
                        key: 'tagline',
                        className: 'opacity-90 text-xl'
                    }, menu.tagline)
                ]),
                React.createElement('div', {
                    key: 'content',
                    className: 'p-8'
                }, sections.length > 0 ? sections.map(section => {
                    const sectionName = language === 'ar' && section.nameAr ? section.nameAr : section.name;
                    const sectionDesc = language === 'ar' && section.descriptionAr ? section.descriptionAr : section.description;
                    
                    return React.createElement('div', {
                        key: section.id,
                        className: 'mb-10'
                    }, [
                        React.createElement('h2', {
                            key: 'title',
                            className: 'text-3xl font-bold text-gray-800 mb-4 border-b-2 border-gray-200 pb-3'
                        }, sectionName),
                        sectionDesc && React.createElement('p', {
                            key: 'desc',
                            className: 'text-gray-600 mb-6'
                        }, sectionDesc),
                        React.createElement('div', {
                            key: 'items',
                            className: 'space-y-1'
                        }, section.items.map(renderMenuItem))
                    ]);
                }) : React.createElement('div', {
                    key: 'empty',
                    className: 'text-center text-gray-500 py-12'
                }, [
                    React.createElement('div', {
                        key: 'icon',
                        className: 'text-6xl mb-4'
                    }, '📋'),
                    React.createElement('h3', {
                        key: 'title',
                        className: 'text-xl font-semibold mb-2'
                    }, t('noSections')),
                    React.createElement('p', {
                        key: 'desc',
                        className: 'text-gray-400'
                    }, 'Add your first section to get started!')
                ]))
            ]);
        }

        // Enhanced Share Modal with QR code generation
        function ShareModal({ isOpen, onClose, menu }) {
            const { t, isRTL } = useLanguage();
            const { addToast } = useToast();
            const [qrCodeUrl, setQrCodeUrl] = useState('');
            const [isGeneratingQR, setIsGeneratingQR] = useState(false);
            const canvasRef = useRef(null);
            
            const shareUrl = `https://your-domain.com/menu/${menu.restaurantName?.toLowerCase().replace(/\s+/g, '-') || 'my-restaurant'}`;

            useEffect(() => {
                if (isOpen && typeof QRCode !== 'undefined') {
                    setIsGeneratingQR(true);
                    QRCode.toCanvas(canvasRef.current, shareUrl, {
                        width: 200,
                        margin: 2,
                        color: {
                            dark: '#000000',
                            light: '#FFFFFF'
                        }
                    }, (error) => {
                        setIsGeneratingQR(false);
                        if (error) {
                            console.error('QR Code generation failed:', error);
                            addToast('Failed to generate QR code', 'error');
                        } else {
                            setQrCodeUrl(canvasRef.current.toDataURL());
                        }
                    });
                }
            }, [isOpen, shareUrl, addToast]);

            const copyToClipboard = async () => {
                try {
                    await navigator.clipboard.writeText(shareUrl);
                    addToast(t('linkCopied'), 'success');
                } catch (error) {
                    addToast('Failed to copy link', 'error');
                }
            };

            const downloadQRCode = () => {
                if (qrCodeUrl) {
                    const link = document.createElement('a');
                    link.download = `${menu.restaurantName || 'menu'}-qr-code.png`;
                    link.href = qrCodeUrl;
                    link.click();
                    addToast('QR code downloaded!', 'success');
                }
            };

            if (!isOpen) return null;

            return React.createElement('div', { className: 'modal' },
                React.createElement('div', {
                    className: `modal-content text-center animate-slide-up ${isRTL ? 'rtl' : ''}`,
                    dir: isRTL ? 'rtl' : 'ltr'
                }, [
                    React.createElement('div', {
                        key: 'header',
                        className: 'mb-6'
                    }, [
                        React.createElement('div', {
                            key: 'success-icon',
                            className: 'text-6xl mb-4'
                        }, '🎉'),
                        React.createElement('h2', {
                            key: 'title',
                            className: 'text-3xl font-bold text-green-600 mb-2'
                        }, t('published')),
                        React.createElement('p', {
                            key: 'subtitle',
                            className: 'text-gray-600 text-lg'
                        }, t('shareLink'))
                    ]),
                    
                    React.createElement('div', {
                        key: 'share-section',
                        className: 'space-y-6'
                    }, [
                        React.createElement('div', {
                            key: 'url-container',
                            className: 'bg-gray-50 border-2 border-gray-200 rounded-xl p-4'
                        }, [
                            React.createElement('div', {
                                key: 'url-display',
                                className: 'flex gap-3'
                            }, [
                                React.createElement('input', {
                                    key: 'url',
                                    type: 'text',
                                    value: shareUrl,
                                    readOnly: true,
                                    className: 'flex-1 bg-transparent outline-none text-sm font-mono'
                                }),
                                React.createElement('button', {
                                    key: 'copy',
                                    className: 'btn btn-primary',
                                    onClick: copyToClipboard
                                }, t('copyLink'))
                            ])
                        ]),
                        
                        React.createElement('div', {
                            key: 'qr-section',
                            className: 'space-y-4'
                        }, [
                            React.createElement('h3', {
                                key: 'qr-title',
                                className: 'text-xl font-semibold text-gray-800'
                            }, t('qrCode')),
                            
                            React.createElement('div', {
                                key: 'qr-container',
                                className: 'qr-container mx-auto'
                            }, [
                                isGeneratingQR ? React.createElement('div', {
                                    key: 'loading',
                                    className: 'flex flex-col items-center justify-center w-48 h-48'
                                }, [
                                    React.createElement('div', {
                                        key: 'spinner',
                                        className: 'loading-spinner mb-3'
                                    }),
                                    React.createElement('p', {
                                        key: 'text',
                                        className: 'text-gray-600'
                                    }, 'Generating QR Code...')
                                ]) : React.createElement('canvas', {
                                    key: 'canvas',
                                    ref: canvasRef,
                                    className: 'mx-auto'
                                })
                            ]),
                            
                            qrCodeUrl && React.createElement('button', {
                                key: 'download',
                                className: 'btn btn-secondary',
                                onClick: downloadQRCode
                            }, t('downloadQR'))
                        ]),
                        
                        React.createElement('div', {
                            key: 'social-share',
                            className: 'pt-6 border-t border-gray-200'
                        }, [
                            React.createElement('h4', {
                                key: 'title',
                                className: 'font-semibold mb-3'
                            }, 'Share on Social Media'),
                            React.createElement('div', {
                                key: 'buttons',
                                className: 'flex justify-center gap-3'
                            }, [
                                ['Facebook', '📘', `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareUrl)}`],
                                ['Twitter', '🐦', `https://twitter.com/intent/tweet?url=${encodeURIComponent(shareUrl)}&text=Check out our menu!`],
                                ['WhatsApp', '💬', `https://wa.me/?text=${encodeURIComponent(`Check out our menu: ${shareUrl}`)}`]
                            ].map(([name, icon, url]) => 
                                React.createElement('a', {
                                    key: name,
                                    href: url,
                                    target: '_blank',
                                    rel: 'noopener noreferrer',
                                    className: 'btn btn-secondary flex items-center gap-2'
                                }, [
                                    React.createElement('span', { key: 'icon' }, icon),
                                    React.createElement('span', { key: 'name' }, name)
                                ])
                            ))
                        ])
                    ]),
                    
                    React.createElement('button', {
                        key: 'close',
                        className: 'btn btn-secondary mt-8',
                        onClick: onClose
                    }, t('cancel'))
                ])
            );
        }

        // Main Menu Editor Component
        function MenuEditor({ template, onBack }) {
            const { t, isRTL, language } = useLanguage();
            const { addToast } = useToast();
            
            // State management
            const [menu, setMenu] = useState({
                restaurantName: '',
                tagline: '',
                colorScheme: template.colorScheme,
                fontFamily: template.fontFamily,
                headerStyle: template.headerStyle,
                spacing: template.spacing
            });
            
            const [sections, setSections] = useState([]);
            const [viewMode, setViewMode] = useState('desktop');
            const [editingItem, setEditingItem] = useState(null);
            const [editingSection, setEditingSection] = useState(null);
            const [showItemModal, setShowItemModal] = useState(false);
            const [showSectionModal, setShowSectionModal] = useState(false);
            const [showShareModal, setShowShareModal] = useState(false);
            const [currentSectionId, setCurrentSectionId] = useState(null);
            const [isSaving, setIsSaving] = useState(false);
            const [isViewSwitching, setIsViewSwitching] = useState(false);
            const [expandedSections, setExpandedSections] = useState({
                info: true,
                design: true,
                sections: true
            });

            // Load saved data on component mount
            useEffect(() => {
                const savedMenu = storage.load('currentMenu');
                const savedSections = storage.load('currentSections', []);
                
                if (savedMenu) {
                    setMenu(prev => ({ ...prev, ...savedMenu }));
                }
                if (savedSections.length > 0) {
                    setSections(savedSections);
                }
            }, []);

            // Auto-save functionality
            useEffect(() => {
                const saveData = () => {
                    storage.save('currentMenu', menu);
                    storage.save('currentSections', sections);
                };
                
                const timeoutId = setTimeout(saveData, 1000);
                return () => clearTimeout(timeoutId);
            }, [menu, sections]);

            // ENHANCED DEVICE VIEW SWITCHING WITH ULTRA-SMOOTH TRANSITIONS
            const handleViewModeChange = useCallback((newMode) => {
                if (newMode === viewMode || isViewSwitching) return;
                
                setIsViewSwitching(true);
                
                // Get preview elements for smooth transition
                const previewContainer = document.querySelector('.preview-container');
                const previewContent = document.querySelector('.preview-content');
                
                if (previewContainer && previewContent) {
                    // Add switching class with enhanced transition
                    previewContainer.classList.add('view-switching');
                    
                    // Add subtle haptic feedback simulation through CSS animation
                    previewContainer.style.animation = 'deviceSwitchPulse 0.3s ease-out';
                    
                    // Clear any existing device classes
                    previewContainer.classList.remove('preview-desktop', 'preview-tablet', 'preview-mobile');
                }
                
                // Smoother transition timing
                setTimeout(() => {
                    setViewMode(newMode);
                    
                    if (previewContainer && previewContent) {
                        // Remove switching class and apply new device class
                        previewContainer.classList.remove('view-switching');
                        previewContainer.classList.add(`preview-${newMode}`);
                        
                        // Reset animation
                        previewContainer.style.animation = '';
                        
                        // Clean up device classes after animation completes
                        setTimeout(() => {
                            previewContainer.classList.remove(`preview-${newMode}`);
                            setIsViewSwitching(false);
                        }, 1000);
                    } else {
                        setIsViewSwitching(false);
                    }
                }, 300);
            }, [viewMode, isViewSwitching]);

            // Toggle section expansion
            const toggleSection = useCallback((sectionKey) => {
                setExpandedSections(prev => ({
                    ...prev,
                    [sectionKey]: !prev[sectionKey]
                }));
            }, []);

            // Enhanced customization section component
            const CustomizationSection = ({ title, sectionKey, children }) => {
                const isExpanded = expandedSections[sectionKey];
                
                return React.createElement('div', {
                    className: 'customization-section'
                }, [
                    React.createElement('div', {
                        key: 'header',
                        className: 'section-header',
                        onClick: () => toggleSection(sectionKey)
                    }, [
                        React.createElement('h3', {
                            key: 'title',
                            className: 'section-title'
                        }, title),
                        React.createElement('span', {
                            key: 'toggle',
                            className: `section-toggle ${isExpanded ? 'expanded' : ''}`
                        }, '▼')
                    ]),
                    React.createElement('div', {
                        key: 'content',
                        className: `section-content ${isExpanded ? 'expanded' : ''}`
                    }, children)
                ]);
            };

            // Section management
            const addSection = useCallback(async (sectionData) => {
                const newSection = {
                    id: Date.now(),
                    ...sectionData,
                    items: []
                };
                setSections(prev => [...prev, newSection]);
            }, []);

            const editSection = useCallback(async (sectionData) => {
                setSections(prev => prev.map(s => 
                    s.id === editingSection.id ? { ...s, ...sectionData } : s
                ));
                setEditingSection(null);
            }, [editingSection]);

            const deleteSection = useCallback((sectionId) => {
                setSections(prev => prev.filter(s => s.id !== sectionId));
                addToast('Section deleted successfully', 'success');
            }, [addToast]);

            const duplicateSection = useCallback((section) => {
                const newSection = {
                    ...section,
                    id: Date.now(),
                    name: `${section.name} (Copy)`,
                    nameAr: section.nameAr ? `${section.nameAr} (نسخة)` : '',
                    items: section.items.map(item => ({
                        ...item,
                        id: Date.now() + Math.random()
                    }))
                };
                setSections(prev => [...prev, newSection]);
                addToast('Section duplicated successfully', 'success');
            }, [addToast]);

            // Item management
            const addItem = useCallback(async (itemData) => {
                const newItem = {
                    id: Date.now(),
                    ...itemData
                };
                setSections(prev => prev.map(s => 
                    s.id === currentSectionId 
                        ? { ...s, items: [...s.items, newItem] }
                        : s
                ));
            }, [currentSectionId]);

            const editItem = useCallback(async (itemData) => {
                setSections(prev => prev.map(s => ({
                    ...s,
                    items: s.items.map(i => 
                        i.id === editingItem.id ? { ...i, ...itemData } : i
                    )
                })));
                setEditingItem(null);
            }, [editingItem]);

            const deleteItem = useCallback((sectionId, itemId) => {
                setSections(prev => prev.map(s => 
                    s.id === sectionId 
                        ? { ...s, items: s.items.filter(i => i.id !== itemId) }
                        : s
                ));
                addToast('Item deleted successfully', 'success');
            }, [addToast]);

            const duplicateItem = useCallback((sectionId, item) => {
                const newItem = {
                    ...item,
                    id: Date.now(),
                    name: `${item.name} (Copy)`
                };
                setSections(prev => prev.map(s => 
                    s.id === sectionId 
                        ? { ...s, items: [...s.items, newItem] }
                        : s
                ));
                addToast('Item duplicated successfully', 'success');
            }, [addToast]);

            // Save and publish handlers
            const handleSave = useCallback(async () => {
                setIsSaving(true);
                try {
                    // Simulate saving to server
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    storage.save('publishedMenu', { menu, sections });
                    addToast(t('menuSaved'), 'success');
                } catch (error) {
                    addToast('Failed to save menu', 'error');
                } finally {
                    setIsSaving(false);
                }
            }, [menu, sections, addToast, t]);

            const handlePublish = useCallback(() => {
                if (!menu.restaurantName) {
                    addToast('Please enter a restaurant name before publishing', 'error');
                    return;
                }
                if (sections.length === 0) {
                    addToast('Please add at least one section before publishing', 'error');
                    return;
                }
                
                storage.save('publishedMenu', { menu, sections });
                setShowShareModal(true);
            }, [menu, sections, addToast]);

            return React.createElement('div', {
                className: `min-h-screen bg-gray-50 ${isRTL ? 'rtl' : ''}`,
                dir: isRTL ? 'rtl' : 'ltr'
            }, [
                // Header
                React.createElement('div', {
                    key: 'header',
                    className: 'bg-white shadow-sm border-b px-6 py-4 sticky top-0 z-40'
                }, [
                    React.createElement('div', {
                        key: 'header-content',
                        className: 'flex items-center justify-between max-w-7xl mx-auto'
                    }, [
                        React.createElement('div', {
                            key: 'left',
                            className: 'flex items-center gap-4'
                        }, [
                            React.createElement('button', {
                                key: 'back',
                                className: 'btn btn-secondary',
                                onClick: onBack
                            }, '← ' + (isRTL ? 'رجوع' : 'Back')),
                            React.createElement('h1', {
                                key: 'title',
                                className: 'text-2xl font-bold text-gray-800'
                            }, t('menuEditor'))
                        ]),
                        
                        React.createElement('div', {
                            key: 'right',
                            className: 'flex items-center gap-4'
                        }, [
                            React.createElement('div', {
                                key: 'view-toggle',
                                className: 'view-toggle'
                            }, [
                                ['desktop', '🖥️', t('desktop')],
                                ['tablet', '📱', t('tablet')], 
                                ['mobile', '📱', t('mobile')]
                            ].map(([mode, icon, label]) => 
                                React.createElement('button', {
                                    key: mode,
                                    className: `view-toggle-btn ${viewMode === mode ? 'active' : ''}`,
                                    onClick: () => handleViewModeChange(mode),
                                    disabled: isViewSwitching,
                                    'aria-label': `${t('switchTo')} ${label}`,
                                    'data-mode': mode,
                                    type: 'button'
                                }, [
                                    React.createElement('span', { 
                                        key: 'icon', 
                                        className: 'view-icon'
                                    }, icon),
                                    React.createElement('span', { 
                                        key: 'label', 
                                        className: 'view-label'
                                    }, label)
                                ])
                            )),
                            
                            React.createElement('button', {
                                key: 'save',
                                className: 'btn btn-secondary',
                                onClick: handleSave,
                                disabled: isSaving
                            }, isSaving ? [
                                React.createElement('div', {
                                    key: 'spinner',
                                    className: 'loading-spinner mr-2'
                                }),
                                t('saving')
                            ] : t('save')),
                            
                            React.createElement('button', {
                                key: 'publish',
                                className: 'btn btn-primary',
                                onClick: handlePublish
                            }, t('publish'))
                        ])
                    ])
                ]),

                // Main Content
                React.createElement('div', {
                    key: 'main',
                    className: 'flex max-w-7xl mx-auto min-h-screen'
                }, [
                    // Sidebar
                    React.createElement('div', {
                        key: 'sidebar',
                        className: 'sidebar w-80 p-6 h-screen overflow-y-auto sticky top-16'
                    }, [
                        // Restaurant Info Section
                        React.createElement(CustomizationSection, {
                            key: 'restaurant-info',
                            title: t('restaurantInfo'),
                            sectionKey: 'info'
                        }, [
                            React.createElement('div', { key: 'name', className: 'form-group' }, [
                                React.createElement('label', {
                                    key: 'label',
                                    className: 'form-label'
                                }, t('restaurantName')),
                                React.createElement('input', {
                                    key: `restaurant-name-${Date.now()}`,
                                    type: 'text',
                                    className: 'input-field',
                                    defaultValue: menu.restaurantName || '',
                                    onChange: () => {}, // Prevent React interference
                                    onInput: (e) => {
                                        // Immediate DOM update for live preview
                                        const value = e.target.value;
                                        
                                        // Update all h1 elements that might be restaurant names
                                        document.querySelectorAll('h1').forEach(h1 => {
                                            if (h1.closest('[class*="preview"]') || h1.parentElement.classList.contains('p-4') || h1.parentElement.classList.contains('p-8')) {
                                                h1.textContent = value || 'Restaurant Name';
                                            }
                                        });
                                        
                                        // Debounced state update
                                        clearTimeout(window.nameUpdateTimeout);
                                        window.nameUpdateTimeout = setTimeout(() => {
                                            menu.restaurantName = value;
                                        }, 100);
                                    },
                                    placeholder: t('enterRestaurantName'),
                                    autoComplete: 'off',
                                    spellCheck: 'false'
                                })
                            ]),
                            React.createElement('div', { key: 'tagline', className: 'form-group' }, [
                                React.createElement('label', {
                                    key: 'label',
                                    className: 'form-label'
                                }, t('tagline')),
                                React.createElement('input', {
                                    key: `tagline-${Date.now()}`,
                                    type: 'text',
                                    className: 'input-field',
                                    defaultValue: menu.tagline || '',
                                    onChange: () => {}, // Prevent React interference
                                    onInput: (e) => {
                                        // Immediate DOM update for live preview
                                        const value = e.target.value;
                                        
                                        // Update tagline elements in preview
                                        document.querySelectorAll('p').forEach(p => {
                                            if (p.classList.contains('opacity-90') || 
                                                (p.parentElement && (p.parentElement.classList.contains('p-4') || p.parentElement.classList.contains('p-8')))) {
                                                p.textContent = value || 'Your tagline';
                                            }
                                        });
                                        
                                        // Debounced state update
                                        clearTimeout(window.taglineUpdateTimeout);
                                        window.taglineUpdateTimeout = setTimeout(() => {
                                            menu.tagline = value;
                                        }, 100);
                                    },
                                    placeholder: t('enterTagline'),
                                    autoComplete: 'off',
                                    spellCheck: 'false'
                                })
                            ])
                        ]),

                        // Design Settings Section
                        React.createElement(CustomizationSection, {
                            key: 'design',
                            title: t('design'),
                            sectionKey: 'design'
                        }, [
                            React.createElement('div', { key: 'color', className: 'form-group' }, [
                                React.createElement('label', {
                                    key: 'label',
                                    className: 'form-label'
                                }, t('colorScheme')),
                                React.createElement('div', {
                                    key: 'select-wrapper',
                                    className: 'enhanced-select'
                                }, [
                                    React.createElement('select', {
                                        key: 'select',
                                        value: menu.colorScheme,
                                        onChange: (e) => setMenu(prev => ({...prev, colorScheme: e.target.value}))
                                    }, [
                                        React.createElement('option', { key: 'indigo', value: 'indigo' }, 'Indigo Purple'),
                                        React.createElement('option', { key: 'emerald', value: 'emerald' }, 'Emerald Green'),
                                        React.createElement('option', { key: 'amber', value: 'amber' }, 'Amber Gold'),
                                        React.createElement('option', { key: 'rose', value: 'rose' }, 'Rose Pink')
                                    ])
                                ])
                            ]),
                            React.createElement('div', { key: 'font', className: 'form-group' }, [
                                React.createElement('label', {
                                    key: 'label',
                                    className: 'form-label'
                                }, t('fontFamily')),
                                React.createElement('div', {
                                    key: 'select-wrapper',
                                    className: 'enhanced-select'
                                }, [
                                    React.createElement('select', {
                                        key: 'select',
                                        value: menu.fontFamily,
                                        onChange: (e) => setMenu(prev => ({...prev, fontFamily: e.target.value}))
                                    }, [
                                        React.createElement('option', { key: 'inter', value: 'inter' }, 'Inter (Modern)'),
                                        React.createElement('option', { key: 'serif', value: 'serif' }, 'Playfair (Elegant)'),
                                        React.createElement('option', { key: 'sans', value: 'sans' }, 'System (Clean)')
                                    ])
                                ])
                            ])
                        ]),

                        // Sections
                        React.createElement(CustomizationSection, {
                            key: 'sections',
                            title: t('sections'),
                            sectionKey: 'sections'
                        }, [
                            React.createElement('div', {
                                key: 'header',
                                className: 'flex justify-end mb-4'
                            }, [
                                React.createElement('button', {
                                    key: 'add',
                                    className: 'btn btn-primary text-sm',
                                    onClick: () => {
                                        setEditingSection(null);
                                        setShowSectionModal(true);
                                    }
                                }, '+ ' + t('addSection'))
                            ]),
                            
                            React.createElement('div', {
                                key: 'list',
                                className: 'space-y-3'
                            }, sections.length > 0 ? sections.map(section => 
                                React.createElement('div', {
                                    key: section.id,
                                    className: 'section-card'
                                }, [
                                    React.createElement('div', {
                                        key: 'header',
                                        className: 'flex items-center justify-between mb-3'
                                    }, [
                                        React.createElement('h3', {
                                            key: 'name',
                                            className: 'font-semibold text-gray-800'
                                        }, section.name),
                                        React.createElement('div', {
                                            key: 'actions',
                                            className: 'flex gap-1'
                                        }, [
                                            React.createElement('button', {
                                                key: 'edit',
                                                className: 'text-blue-600 hover:text-blue-800 text-sm p-1',
                                                onClick: () => {
                                                    setEditingSection(section);
                                                    setShowSectionModal(true);
                                                }
                                            }, '✏️'),
                                            React.createElement('button', {
                                                key: 'duplicate',
                                                className: 'text-green-600 hover:text-green-800 text-sm p-1',
                                                onClick: () => duplicateSection(section)
                                            }, '📋'),
                                            React.createElement('button', {
                                                key: 'delete',
                                                className: 'text-red-600 hover:text-red-800 text-sm p-1',
                                                onClick: () => deleteSection(section.id)
                                            }, '🗑️')
                                        ])
                                    ]),
                                    
                                    React.createElement('div', {
                                        key: 'items',
                                        className: 'space-y-2'
                                    }, [
                                        ...section.items.map(item => 
                                            React.createElement('div', {
                                                key: item.id,
                                                className: 'item-card flex items-center justify-between'
                                            }, [
                                                React.createElement('div', {
                                                    key: 'info',
                                                    className: 'flex-1'
                                                }, [
                                                    React.createElement('span', {
                                                        key: 'name',
                                                        className: 'font-medium text-sm'
                                                    }, item.name),
                                                    React.createElement('span', {
                                                        key: 'price',
                                                        className: 'text-gray-600 text-sm ml-2'
                                                    }, `$${item.price}`)
                                                ]),
                                                React.createElement('div', {
                                                    key: 'actions',
                                                    className: 'flex gap-1'
                                                }, [
                                                    React.createElement('button', {
                                                        key: 'edit',
                                                        className: 'text-blue-600 hover:text-blue-800 text-xs p-1',
                                                        onClick: () => {
                                                            setEditingItem(item);
                                                            setShowItemModal(true);
                                                        }
                                                    }, '✏️'),
                                                    React.createElement('button', {
                                                        key: 'duplicate',
                                                        className: 'text-green-600 hover:text-green-800 text-xs p-1',
                                                        onClick: () => duplicateItem(section.id, item)
                                                    }, '📋'),
                                                    React.createElement('button', {
                                                        key: 'delete',
                                                        className: 'text-red-600 hover:text-red-800 text-xs p-1',
                                                        onClick: () => deleteItem(section.id, item.id)
                                                    }, '🗑️')
                                                ])
                                            ])
                                        ),
                                        React.createElement('button', {
                                            key: 'add-item',
                                            className: 'w-full text-left text-sm text-blue-600 hover:text-blue-800 p-2 hover:bg-blue-50 rounded transition-colors',
                                            onClick: () => {
                                                setCurrentSectionId(section.id);
                                                setEditingItem(null);
                                                setShowItemModal(true);
                                            }
                                        }, `+ ${t('addItem')}`)
                                    ])
                                ])
                            ) : React.createElement('div', {
                                key: 'empty',
                                className: 'text-center py-8 text-gray-500'
                            }, [
                                React.createElement('div', {
                                    key: 'icon',
                                    className: 'text-4xl mb-3'
                                }, '📝'),
                                React.createElement('p', {
                                    key: 'text',
                                    className: 'text-sm'
                                }, t('noSections'))
                            ]))
                        ])
                    ]),

                    // Preview Area
                    React.createElement('div', {
                        key: 'preview',
                        className: 'preview-area flex-1 p-6 overflow-y-auto'
                    }, [
                        React.createElement('div', {
                            key: 'preview-container',
                            className: `preview-container ${isViewSwitching ? 'view-switching' : ''}`
                        }, [
                            React.createElement('div', {
                                key: 'device',
                                className: `preview-device ${viewMode}`
                            }, [
                                React.createElement('div', {
                                    key: 'screen',
                                    className: 'preview-screen'
                                }, [
                                    React.createElement('div', {
                                        key: 'content',
                                        className: 'preview-content'
                                    }, [
                                        React.createElement(MenuPreview, {
                                            key: 'preview-component',
                                            menu: menu,
                                            sections: sections,
                                            viewMode: viewMode,
                                            language: language
                                        })
                                    ])
                                ])
                            ])
                        ])
                    ])
                ]),

                // Modals
                React.createElement(ItemEditModal, {
                    key: 'item-modal',
                    isOpen: showItemModal,
                    onClose: () => setShowItemModal(false),
                    onSave: editingItem ? editItem : addItem,
                    item: editingItem
                }),
                React.createElement(SectionEditModal, {
                    key: 'section-modal',
                    isOpen: showSectionModal,
                    onClose: () => setShowSectionModal(false),
                    onSave: editingSection ? editSection : addSection,
                    section: editingSection
                }),
                React.createElement(ShareModal, {
                    key: 'share-modal',
                    isOpen: showShareModal,
                    onClose: () => setShowShareModal(false),
                    menu: menu
                })
            ]);
        }

        // Enhanced Language Toggle Component
        function LanguageToggle() {
            const { language, toggleLanguage } = useLanguage();
            const [isAnimating, setIsAnimating] = useState(false);
            
            const handleToggle = () => {
                if (isAnimating) return;
                
                setIsAnimating(true);
                
                // Add language switch animation to body
                document.body.classList.add('language-switch');
                
                setTimeout(() => {
                    toggleLanguage();
                    setIsAnimating(false);
                    document.body.classList.remove('language-switch');
                }, 200);
            };
            
            return React.createElement('button', {
                className: `language-toggle ${isAnimating ? 'language-switch' : ''}`,
                onClick: handleToggle,
                disabled: isAnimating
            }, language === 'en' ? '🇸🇦 العربية' : '🇺🇸 English');
        }

        // Toast Container
        function ToastContainer() {
            const { toasts, removeToast } = useToast();
            
            return React.createElement('div', {
                className: 'fixed top-20 right-4 z-50 space-y-2'
            }, toasts.map(toast => 
                React.createElement(Toast, {
                    key: toast.id,
                    toast: toast,
                    onRemove: removeToast
                })
            ));
        }

        // Step management with guided flow
        const STEPS = {
            LANDING: 'landing',
            AUTH: 'auth', 
            TEMPLATE: 'template',
            EDITOR: 'editor',
            PREVIEW: 'preview',
            SHARE: 'share'
        };

        // Landing Page Component
        function LandingPage({ onContinue }) {
            const { t, isRTL } = useLanguage();
            
            return React.createElement('div', {
                className: `screen min-h-screen flex items-center justify-center p-8 ${isRTL ? 'rtl' : ''}`,
                dir: isRTL ? 'rtl' : 'ltr'
            }, [
                React.createElement('div', {
                    key: 'content',
                    className: 'text-center max-w-4xl mx-auto animate-fade-in'
                }, [
                    React.createElement('div', {
                        key: 'hero-logo',
                        className: 'hero-logo-container mb-8'
                    }, React.createElement('img', {
                        src: 'Bubble3dARbites.png',
                        alt: 'ARbites Logo',
                        className: 'hero-3d-logo'
                    })),
                    
                    React.createElement('h1', {
                        key: 'title',
                        className: 'text-6xl font-bold text-white mb-6 leading-tight'
                    }, t('title')),
                    
                    React.createElement('p', {
                        key: 'subtitle',
                        className: 'text-xl text-white opacity-90 mb-12 max-w-2xl mx-auto leading-relaxed'
                    }, t('subtitle')),
                    
                    React.createElement('div', {
                        key: 'features',
                        className: 'grid grid-cols-1 md:grid-cols-3 gap-8 mb-12'
                    }, [
                        ['🎨', t('beautifulTemplates'), t('beautifulTemplatesDesc')],
                        ['🌐', t('multilingualSupport'), t('multilingualSupportDesc')],
                        ['📱', t('mobileFriendly'), t('mobileFriendlyDesc')]
                    ].map(([icon, title, desc], index) => 
                        React.createElement('div', {
                            key: index,
                            className: 'glass-effect p-6 rounded-2xl animate-slide-up',
                            style: { animationDelay: `${index * 200}ms` }
                        }, [
                            React.createElement('div', {
                                key: 'icon',
                                className: 'text-4xl mb-4'
                            }, icon),
                            React.createElement('h3', {
                                key: 'title',
                                className: 'text-xl font-bold text-white mb-2'
                            }, title),
                            React.createElement('p', {
                                key: 'desc',
                                className: 'text-white opacity-80'
                            }, desc)
                        ])
                    )),
                    
                    React.createElement('button', {
                        key: 'cta',
                        className: 'btn btn-primary text-xl px-12 py-6',
                        onClick: onContinue
                    }, t('getStarted'))
                ])
            ]);
        }

        // Auth Page Component (simplified for demo)
        function AuthPage({ onContinue }) {
            const { t, isRTL } = useLanguage();
            const [userName, setUserName] = useState('');
            
            const handleSubmit = (e) => {
                e.preventDefault();
                if (userName.trim()) {
                    storage.save('userName', userName);
                    onContinue();
                }
            };
            
            return React.createElement('div', {
                className: `screen min-h-screen flex items-center justify-center p-8 ${isRTL ? 'rtl' : ''}`,
                dir: isRTL ? 'rtl' : 'ltr'
            }, [
                React.createElement('div', {
                    key: 'content',
                    className: 'bg-white rounded-2xl p-8 max-w-md w-full shadow-2xl animate-slide-up'
                }, [
                    React.createElement('div', {
                        key: 'header',
                        className: 'text-center mb-8'
                    }, [
                        React.createElement('div', {
                            key: 'icon',
                            className: 'text-5xl mb-4'
                        }, '👋'),
                        React.createElement('h2', {
                            key: 'title',
                            className: 'text-2xl font-bold text-gray-800 mb-2'
                        }, t('welcome')),
                        React.createElement('p', {
                            key: 'subtitle',
                            className: 'text-gray-600'
                        }, t('welcomeMessage'))
                    ]),
                    
                    React.createElement('form', {
                        key: 'form',
                        onSubmit: handleSubmit,
                        className: 'space-y-6'
                    }, [
                        React.createElement('div', { key: 'input-group' }, [
                            React.createElement('label', {
                                key: 'label',
                                className: 'block text-sm font-semibold text-gray-700 mb-2'
                            }, t('yourName')),
                            React.createElement('input', {
                                key: 'input',
                                type: 'text',
                                className: 'input-field',
                                value: userName,
                                onChange: (e) => setUserName(e.target.value),
                                placeholder: t('enterName'),
                                required: true
                            })
                        ]),
                        
                        React.createElement('button', {
                            key: 'submit',
                            type: 'submit',
                            className: 'btn btn-primary w-full',
                            disabled: !userName.trim()
                        }, t('continueToTemplates'))
                    ])
                ])
            ]);
        }

        // Realistic Template Preview Component - Accurate Mini Layouts
        function RealisticTemplatePreview({ template }) {
            const { mockData, preview } = template;
            
            // Dark Neon Template
            if (template.id === 'dark-neon') {
                return React.createElement('div', {
                    className: 'realistic-preview h-80 relative overflow-hidden rounded-lg',
                    style: {
                        background: 'linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%)',
                        fontFamily: 'Inter, sans-serif'
                    }
                }, [
                    // Neon grid background
                    React.createElement('div', {
                        key: 'grid',
                        className: 'absolute inset-0 opacity-20',
                        style: {
                            backgroundImage: `linear-gradient(${preview.accentColor}40 1px, transparent 1px), linear-gradient(90deg, ${preview.accentColor}40 1px, transparent 1px)`,
                            backgroundSize: '20px 20px'
                        }
                    }),
                    
                    // Header
                    React.createElement('div', {
                        key: 'header',
                        className: 'p-4 text-center relative z-10'
                    }, [
                        React.createElement('h1', {
                            key: 'title',
                            className: 'text-2xl font-bold text-white mb-1',
                            style: {
                                color: preview.accentColor,
                                textShadow: `0 0 20px ${preview.accentColor}80`,
                                letterSpacing: '2px'
                            }
                        }, mockData.restaurantName),
                        React.createElement('div', {
                            key: 'tagline',
                            className: 'text-xs',
                            style: { color: preview.secondaryColor }
                        }, mockData.tagline)
                    ]),
                    
                    // Menu grid
                    React.createElement('div', {
                        key: 'menu',
                        className: 'px-4 pb-4 grid grid-cols-2 gap-2'
                    }, mockData.sections.flatMap(section => 
                        section.items.slice(0, 2).map((item, i) =>
                            React.createElement('div', {
                                key: i,
                                className: 'neon-card p-3 rounded-lg',
                                style: {
                                    background: 'rgba(255,255,255,0.05)',
                                    border: `1px solid ${preview.accentColor}40`,
                                    backdropFilter: 'blur(10px)'
                                }
                            }, [
                                React.createElement('div', {
                                    key: 'name',
                                    className: 'text-white text-xs font-semibold mb-1'
                                }, item.name),
                                React.createElement('div', {
                                    key: 'price',
                                    className: 'text-xs font-mono',
                                    style: { color: preview.secondaryColor }
                                }, item.price),
                                item.featured && React.createElement('div', {
                                    key: 'glow',
                                    className: 'absolute inset-0 rounded-lg pointer-events-none',
                                    style: {
                                        boxShadow: `inset 0 0 20px ${preview.accentColor}30`
                                    }
                                })
                            ])
                        )
                    ))
                ]);
            }
            
            // Elegant Script Template
            if (template.id === 'elegant-script') {
                return React.createElement('div', {
                    className: 'realistic-preview h-80 relative overflow-hidden rounded-lg',
                    style: {
                        background: 'linear-gradient(135deg, #f7f1e3 0%, #f5e6d3 50%, #e8d5b7 100%)',
                        fontFamily: 'Playfair Display, serif'
                    }
                }, [
                    // Elegant pattern
                    React.createElement('div', {
                        key: 'pattern',
                        className: 'absolute inset-0 opacity-10',
                        style: {
                            backgroundImage: `url("data:image/svg+xml,%3Csvg width='40' height='40' viewBox='0 0 40 40' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M20 20c0-11.046-8.954-20-20-20v20h20z' fill='%23d4af37'/%3E%3C/svg%3E")`
                        }
                    }),
                    
                    // Decorative border
                    React.createElement('div', {
                        key: 'border',
                        className: 'absolute inset-2 border-2 border-amber-300/40 rounded-lg'
                    }),
                    
                    // Header with ornate styling
                    React.createElement('div', {
                        key: 'header',
                        className: 'p-6 text-center'
                    }, [
                        React.createElement('h1', {
                            key: 'title',
                            className: 'text-2xl font-bold italic mb-1',
                            style: {
                                color: preview.accentColor,
                                fontFamily: 'Playfair Display, serif'
                            }
                        }, mockData.restaurantName),
                        React.createElement('div', {
                            key: 'ornament',
                            className: 'w-16 h-px mx-auto my-2',
                            style: { background: preview.accentColor }
                        }),
                        React.createElement('p', {
                            key: 'tagline',
                            className: 'text-xs italic',
                            style: { color: preview.secondaryColor }
                        }, mockData.tagline)
                    ]),
                    
                    // Elegant menu layout
                    React.createElement('div', {
                        key: 'menu',
                        className: 'px-6 space-y-3'
                    }, mockData.sections.slice(0, 2).map((section, sIndex) =>
                        React.createElement('div', {
                            key: sIndex,
                            className: 'section'
                        }, [
                            React.createElement('h3', {
                                key: 'section-title',
                                className: 'text-sm font-bold mb-2 text-center',
                                style: { 
                                    color: preview.accentColor,
                                    fontFamily: 'Playfair Display, serif'
                                }
                            }, section.name),
                            React.createElement('div', {
                                key: 'items',
                                className: 'space-y-1'
                            }, section.items.slice(0, 2).map((item, iIndex) =>
                                React.createElement('div', {
                                    key: iIndex,
                                    className: 'flex justify-between items-center py-1 border-b border-amber-200/30'
                                }, [
                                    React.createElement('span', {
                                        key: 'name',
                                        className: 'text-xs flex items-center gap-1',
                                        style: { color: preview.secondaryColor }
                                    }, [
                                        item.name,
                                        item.special && React.createElement('span', {
                                            key: 'star',
                                            style: { color: preview.accentColor }
                                        }, '✦')
                                    ]),
                                    React.createElement('span', {
                                        key: 'price',
                                        className: 'text-xs font-semibold',
                                        style: { color: preview.accentColor }
                                    }, item.price)
                                ])
                            ))
                        ])
                    ))
                ]);
            }
            
            // Image Grid Template
            if (template.id === 'image-grid') {
                return React.createElement('div', {
                    className: 'realistic-preview h-80 relative overflow-hidden rounded-lg',
                    style: {
                        background: 'linear-gradient(135deg, #ff6b35 0%, #f7931e 50%, #ffd23f 100%)',
                        fontFamily: 'Montserrat, sans-serif'
                    }
                }, [
                    // Bold header
                    React.createElement('div', {
                        key: 'header',
                        className: 'p-4 text-center text-white'
                    }, [
                        React.createElement('h1', {
                            key: 'title',
                            className: 'text-2xl font-black uppercase mb-1 tracking-wide',
                            style: { textShadow: '2px 2px 4px rgba(0,0,0,0.3)' }
                        }, mockData.restaurantName),
                        React.createElement('p', {
                            key: 'tagline',
                            className: 'text-xs font-bold uppercase tracking-wider opacity-90'
                        }, mockData.tagline)
                    ]),
                    
                    // Image grid layout
                    React.createElement('div', {
                        key: 'grid',
                        className: 'px-4 grid grid-cols-2 gap-2'
                    }, mockData.sections.flatMap(section => 
                        section.items.slice(0, 2).map((item, i) =>
                            React.createElement('div', {
                                key: i,
                                className: 'relative rounded-lg overflow-hidden',
                                style: {
                                    background: 'linear-gradient(45deg, #2c3e50 0%, #34495e 100%)',
                                    aspectRatio: '4/3'
                                }
                            }, [
                                // Mock image placeholder
                                React.createElement('div', {
                                    key: 'image',
                                    className: 'absolute inset-0 flex items-center justify-center text-4xl opacity-30'
                                }, '🍽️'),
                                
                                // Item info overlay
                                React.createElement('div', {
                                    key: 'overlay',
                                    className: 'absolute bottom-0 left-0 right-0 p-2',
                                    style: {
                                        background: 'linear-gradient(transparent, rgba(0,0,0,0.8))'
                                    }
                                }, [
                                    React.createElement('div', {
                                        key: 'name',
                                        className: 'text-white text-xs font-bold'
                                    }, item.name),
                                    React.createElement('div', {
                                        key: 'price',
                                        className: 'text-xs font-black',
                                        style: { color: preview.accentColor }
                                    }, item.price)
                                ])
                            ])
                        )
                    ))
                ]);
            }
            
            // Minimal Zen Template
            if (template.id === 'minimal-zen') {
                return React.createElement('div', {
                    className: 'realistic-preview h-80 relative overflow-hidden rounded-lg',
                    style: {
                        background: 'linear-gradient(135deg, #ffffff 0%, #f8f9fa 50%, #e9ecef 100%)',
                        fontFamily: 'Inter, sans-serif'
                    }
                }, [
                    // Clean header
                    React.createElement('div', {
                        key: 'header',
                        className: 'p-8 text-center'
                    }, [
                        React.createElement('h1', {
                            key: 'title',
                            className: 'text-xl font-light lowercase tracking-wide mb-2',
                            style: { color: preview.accentColor }
                        }, mockData.restaurantName),
                        React.createElement('p', {
                            key: 'tagline',
                            className: 'text-xs lowercase tracking-wider',
                            style: { color: preview.secondaryColor }
                        }, mockData.tagline)
                    ]),
                    
                    // Minimal menu layout with lots of space
                    React.createElement('div', {
                        key: 'menu',
                        className: 'px-8 space-y-6'
                    }, mockData.sections.slice(0, 2).map((section, sIndex) =>
                        React.createElement('div', {
                            key: sIndex,
                            className: 'section'
                        }, [
                            React.createElement('h3', {
                                key: 'section-title',
                                className: 'text-sm font-medium lowercase tracking-wide mb-3 pb-1',
                                style: { 
                                    color: preview.accentColor,
                                    borderBottom: `1px solid ${preview.secondaryColor}30`
                                }
                            }, section.name),
                            React.createElement('div', {
                                key: 'items',
                                className: 'space-y-3'
                            }, section.items.slice(0, 1).map((item, iIndex) =>
                                React.createElement('div', {
                                    key: iIndex,
                                    className: 'flex justify-between items-baseline'
                                }, [
                                    React.createElement('span', {
                                        key: 'name',
                                        className: 'text-xs lowercase',
                                        style: { color: preview.accentColor }
                                    }, item.name),
                                    React.createElement('div', {
                                        key: 'dots',
                                        className: 'flex-1 mx-2 border-b border-dotted',
                                        style: { borderColor: preview.secondaryColor + '30' }
                                    }),
                                    React.createElement('span', {
                                        key: 'price',
                                        className: 'text-xs font-mono',
                                        style: { color: preview.secondaryColor }
                                    }, item.price)
                                ])
                            ))
                        ])
                    ))
                ]);
            }
            
            // Fallback
            return React.createElement('div', {
                className: 'realistic-preview h-80 bg-gray-100 rounded-lg flex items-center justify-center'
            }, 'Template Preview');
        }

        // Enhanced Template Selection with Live Previews
        function EnhancedTemplateSelection({ onSelectTemplate }) {
            const { t, isRTL } = useLanguage();
            const [selectedTemplate, setSelectedTemplate] = useState(null);
            const [isSelecting, setIsSelecting] = useState(false);
            const [showConfirmation, setShowConfirmation] = useState(false);

            const handleTemplateClick = (template) => {
                if (isSelecting) return;
                
                // INSTANT visual feedback - no delays
                setSelectedTemplate(template.id);
                setShowConfirmation(true);
                
                // Apply template design immediately to live editor
                const previewArea = document.querySelector('.preview-area');
                const editorContainer = document.querySelector('.menu-editor-container');
                
                if (previewArea) {
                    previewArea.style.background = template.preview.headerBg;
                    previewArea.style.fontFamily = template.preview.typography;
                    previewArea.style.color = template.preview.accentColor;
                }
                
                if (editorContainer) {
                    editorContainer.style.setProperty('--template-accent', template.preview.accentColor);
                    editorContainer.style.setProperty('--template-bg', template.preview.headerBg);
                    editorContainer.style.setProperty('--template-font', template.preview.typography);
                }
                
                // Visual confirmation with smooth scroll
                setTimeout(() => {
                    const confirmationElement = document.getElementById('template-confirmation');
                    if (confirmationElement) {
                        confirmationElement.scrollIntoView({ 
                            behavior: 'smooth',
                            block: 'center'
                        });
                    }
                }, 50);
            };

            const handleConfirmSelection = () => {
                if (!selectedTemplate) return;
                
                setIsSelecting(true);
                const template = templates.find(t => t.id === selectedTemplate);
                
                setTimeout(() => {
                    onSelectTemplate(template);
                }, 800);
            };

            const selectedTemplateData = templates.find(t => t.id === selectedTemplate);

            return React.createElement('div', {
                className: `screen min-h-screen p-8 ${isRTL ? 'rtl' : ''}`,
                dir: isRTL ? 'rtl' : 'ltr'
            }, [
                React.createElement('div', {
                    key: 'header',
                    className: 'text-center mb-16 animate-fade-in'
                }, [
                    React.createElement('h1', {
                        key: 'title',
                        className: 'text-5xl font-bold text-white mb-6'
                    }, t('selectTemplate')),
                    React.createElement('p', {
                        key: 'subtitle',
                        className: 'text-xl text-white opacity-90 max-w-2xl mx-auto'
                    }, 'Choose a template that perfectly matches your restaurant style')
                ]),
                
                React.createElement('div', {
                    key: 'templates',
                    className: 'max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-8 mb-16'
                }, templates.map((template, index) => 
                    React.createElement('div', {
                        key: template.id,
                        'data-template-id': template.id,
                        className: `template-card-enhanced ${
                            selectedTemplate === template.id ? 'selected' : ''
                        }`,
                        style: { 
                            animationDelay: `${index * 200}ms`
                        },
                        onClick: () => handleTemplateClick(template)
                    }, [
                        React.createElement('div', {
                            key: 'preview-container',
                            className: 'template-preview-container'
                        }, [
                            React.createElement(RealisticTemplatePreview, {
                                key: 'preview',
                                template: template
                            }),
                            
                            // Overlay on hover
                            React.createElement('div', {
                                key: 'overlay',
                                className: 'template-overlay'
                            }, [
                                React.createElement('div', {
                                    key: 'overlay-content',
                                    className: 'overlay-content'
                                }, [
                                    React.createElement('h3', {
                                        key: 'name',
                                        className: 'text-2xl font-bold text-white mb-2'
                                    }, template.name),
                                    React.createElement('p', {
                                        key: 'desc',
                                        className: 'text-white opacity-90 text-center mb-4'
                                    }, template.description),
                                    React.createElement('div', {
                                        key: 'features',
                                        className: 'flex flex-wrap justify-center gap-2'
                                    }, [
                                        React.createElement('span', {
                                            key: 'theme',
                                            className: 'feature-badge'
                                        }, template.preview.theme),
                                        React.createElement('span', {
                                            key: 'category',
                                            className: 'feature-badge'
                                        }, template.category)
                                    ])
                                ])
                            ])
                        ]),
                        
                        React.createElement('div', {
                            key: 'info',
                            className: 'template-info'
                        }, [
                            React.createElement('h3', {
                                key: 'name',
                                className: 'template-name'
                            }, template.name),
                            React.createElement('p', {
                                key: 'desc',
                                className: 'template-description'
                            }, template.description),
                            React.createElement('div', {
                                key: 'tags',
                                className: 'template-tags'
                            }, [
                                React.createElement('span', {
                                    key: 'category',
                                    className: 'template-tag'
                                }, template.category),
                                React.createElement('span', {
                                    key: 'theme',
                                    className: 'template-tag'
                                }, template.preview.theme)
                            ])
                        ])
                    ])
                )),
                
                // Confirmation Section
                showConfirmation && selectedTemplateData && React.createElement('div', {
                    key: 'confirmation',
                    id: 'template-confirmation',
                    className: 'confirmation-section max-w-2xl mx-auto text-center'
                }, [
                    React.createElement('div', {
                        key: 'content',
                        className: 'confirmation-content'
                    }, [
                        React.createElement('div', {
                            key: 'icon',
                            className: 'confirmation-icon mb-6'
                        }, '✨'),
                        React.createElement('h2', {
                            key: 'title',
                            className: 'text-3xl font-bold text-white mb-4'
                        }, t('perfectChoice')),
                        React.createElement('p', {
                            key: 'desc',
                            className: 'text-xl text-white opacity-90 mb-8'
                        }, `${t('selectedTemplate')} "${t(selectedTemplateData.id)}" ${t('useTemplate').toLowerCase()}`),
                        React.createElement('div', {
                            key: 'actions',
                            className: 'flex gap-4 justify-center'
                        }, [
                            React.createElement('button', {
                                key: 'back',
                                className: 'btn btn-secondary',
                                onClick: () => {
                                    setSelectedTemplate(null);
                                    setShowConfirmation(false);
                                }
                            }, t('chooseDifferent')),
                            React.createElement('button', {
                                key: 'confirm',
                                className: `btn btn-primary ${isSelecting ? 'loading' : ''}`,
                                onClick: handleConfirmSelection,
                                disabled: isSelecting
                            }, isSelecting ? t('loading') : t('startBuilding') + ' →')
                        ])
                    ])
                ])
            ]);
        }

        // Main App Component with guided flow
        function App() {
            const [currentStep, setCurrentStep] = useState(STEPS.LANDING);
            const [selectedTemplate, setSelectedTemplate] = useState(null);
            const [completedSteps, setCompletedSteps] = useState(new Set());
            const [isTransitioning, setIsTransitioning] = useState(false);

            // Step transition with animation
            const transitionToStep = useCallback((nextStep) => {
                if (isTransitioning) return;
                
                setIsTransitioning(true);
                
                // Add fade out animation
                setTimeout(() => {
                    setCurrentStep(nextStep);
                    setCompletedSteps(prev => new Set([...prev, currentStep]));
                    setIsTransitioning(false);
                }, 300);
            }, [currentStep, isTransitioning]);

            // Step handlers
            const handleLandingContinue = () => {
                transitionToStep(STEPS.AUTH);
            };

            const handleAuthContinue = () => {
                transitionToStep(STEPS.TEMPLATE);
            };

            const handleSelectTemplate = (template) => {
                setSelectedTemplate(template);
                transitionToStep(STEPS.EDITOR);
            };

            const handleBackToTemplates = () => {
                transitionToStep(STEPS.TEMPLATE);
                setSelectedTemplate(null);
                storage.remove('currentMenu');
                storage.remove('currentSections');
            };

            // Prevent skipping steps
            const canAccessStep = (step) => {
                const stepOrder = [STEPS.LANDING, STEPS.AUTH, STEPS.TEMPLATE, STEPS.EDITOR];
                const stepIndex = stepOrder.indexOf(step);
                const currentIndex = stepOrder.indexOf(currentStep);
                
                return stepIndex <= currentIndex + 1;
            };

            const renderCurrentStep = () => {
                switch (currentStep) {
                    case STEPS.LANDING:
                        return React.createElement(LandingPage, {
                            onContinue: handleLandingContinue
                        });
                    case STEPS.AUTH:
                        return React.createElement(AuthPage, {
                            onContinue: handleAuthContinue
                        });
                    case STEPS.TEMPLATE:
                        return React.createElement(EnhancedTemplateSelection, {
                            onSelectTemplate: handleSelectTemplate
                        });
                    case STEPS.EDITOR:
                        return React.createElement(MenuEditor, {
                            template: selectedTemplate,
                            onBack: handleBackToTemplates
                        });
                    default:
                        return React.createElement(LandingPage, {
                            onContinue: handleLandingContinue
                        });
                }
            };

            return React.createElement('div', { 
                className: `min-h-screen ${isTransitioning ? 'language-switch' : ''}` 
            }, [
                React.createElement(LanguageToggle, { key: 'lang-toggle' }),
                React.createElement(ToastContainer, { key: 'toasts' }),
                React.createElement('div', { 
                    key: 'content',
                    className: currentStep !== STEPS.LANDING ? 'fade-in' : ''
                }, renderCurrentStep())
            ]);
        }

        // Root App with Providers
        function RootApp() {
            return React.createElement(LanguageProvider, null,
                React.createElement(ToastProvider, null,
                    React.createElement(App)
                )
            );
        }

        // Initialize the app
        ReactDOM.render(React.createElement(RootApp), document.getElementById('root'));
    </script>
</body>
</html>
