<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurant Menu Builder - Create Beautiful Digital Menus</title>
    <meta name="description" content="Create stunning restaurant menus with drag-and-drop interface, 3D models, multilingual support, and QR code generation. Perfect for modern restaurants.">
    
    <!-- External Dependencies -->
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/localforage/1.10.0/localforage.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+Arabic:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .rtl {
            direction: rtl;
            font-family: 'Noto Sans Arabic', sans-serif;
        }
        
        .font-serif {
            font-family: 'Playfair Display', serif;
        }
        
        .font-sans {
            font-family: system-ui, -apple-system, sans-serif;
        }

        /* Simple Enhanced Styles */
        .enhanced-hover {
            transition: all 0.3s ease;
        }

        .enhanced-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        /* Smooth RTL/LTR Transitions */
        .rtl-smooth {
            transition: all 0.3s ease;
        }

        /* Gentle fade-in animation */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .enhanced-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }
        
        .template-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .template-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.1) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .template-card:hover::before {
            opacity: 1;
        }
        
        .template-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
        }
        
        .menu-item {
            transition: all 0.2s ease;
            position: relative;
        }
        
        .menu-item:hover {
            background-color: #f8fafc;
            transform: scale(1.01);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }
        
        .animate-fade-in {
            animation: fadeIn 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .animate-slide-up {
            animation: slideUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        @keyframes fadeIn {
            from { 
                opacity: 0; 
                transform: translateY(30px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }
        
        @keyframes slideUp {
            from { 
                opacity: 0; 
                transform: translateY(20px) scale(0.95); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            }
        }
        
        .btn {
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            border: none;
            outline: none;
            position: relative;
            overflow: hidden;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: white;
            color: #374151;
            border: 2px solid #e5e7eb;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .btn-secondary:hover {
            background: #f9fafb;
            border-color: #9ca3af;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
        }
        
        .btn-danger:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);
        }
        
        .input-field {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.2s ease;
            background: white;
        }
        
        .input-field:focus {
            border-color: #667eea;
            outline: none;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            transform: translateY(-1px);
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            background: white;
            padding: 32px;
            border-radius: 20px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px rgba(0,0,0,0.25);
            position: relative;
        }
        
        .color-scheme-indigo { 
            --primary: #667eea; 
            --secondary: #764ba2; 
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .color-scheme-emerald { 
            --primary: #10b981; 
            --secondary: #059669; 
            --gradient: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        .color-scheme-amber { 
            --primary: #f59e0b; 
            --secondary: #d97706; 
            --gradient: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }
        .color-scheme-rose { 
            --primary: #f43f5e; 
            --secondary: #e11d48; 
            --gradient: linear-gradient(135deg, #f43f5e 0%, #e11d48 100%);
        }
        
        model-viewer {
            width: 100%;
            height: 250px;
            background: linear-gradient(45deg, #f3f4f6, #e5e7eb);
            border-radius: 12px;
            border: 2px solid #e5e7eb;
        }
        
        .drag-handle {
            cursor: grab;
            padding: 8px;
            border-radius: 6px;
            transition: background-color 0.2s;
        }
        
        .drag-handle:hover {
            background-color: #f3f4f6;
        }
        
        .drag-handle:active {
            cursor: grabbing;
        }
        
        .sidebar {
            background: linear-gradient(180deg, #ffffff 0%, #f8fafc 100%);
            border-right: 1px solid #e5e7eb;
            box-shadow: 4px 0 20px rgba(0,0,0,0.1);
        }
        
        .preview-area {
            background: linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%);
        }
        
        .section-card {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 16px;
            transition: all 0.2s ease;
        }
        
        .section-card:hover {
            border-color: #667eea;
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.1);
        }
        
        .item-card {
            background: #f8fafc;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 12px;
            margin: 8px 0;
            transition: all 0.2s ease;
        }
        
        .item-card:hover {
            background: white;
            border-color: #667eea;
            box-shadow: 0 2px 12px rgba(102, 126, 234, 0.1);
        }
        
        .loading-spinner {
            border: 3px solid #f3f4f6;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .qr-container {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            display: inline-block;
        }
        
        .preview-phone {
            width: 375px;
            height: 812px;
            background: #000;
            border-radius: 40px;
            padding: 8px;
            position: relative;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }
        
        .preview-phone::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 140px;
            height: 6px;
            background: #333;
            border-radius: 3px;
        }
        
        .preview-phone-screen {
            width: 100%;
            height: 100%;
            background: white;
            border-radius: 32px;
            overflow: hidden;
            padding-top: 40px;
        }
        
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 16px 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            z-index: 1001;
            animation: slideInRight 0.3s ease;
        }
        
        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .language-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 100;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 8px 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .language-toggle:hover {
            background: rgba(255, 255, 255, 1);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .modal-content {
                width: 95%;
                padding: 24px;
                max-height: 85vh;
            }
            
            .preview-phone {
                width: 300px;
                height: 600px;
            }
            
            .btn {
                padding: 10px 20px;
                font-size: 14px;
            }
            
            .sidebar {
                width: 100%;
                max-width: none;
            }
        }
        
        /* Print Styles */
        @media print {
            .sidebar, .language-toggle, .btn {
                display: none !important;
            }
            
            .preview-area {
                width: 100% !important;
                background: white !important;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback, useMemo } = React;

        // Comprehensive translations with more content
        const translations = {
            en: {
                // Main navigation
                title: "Restaurant Menu Builder",
                subtitle: "Create beautiful, multilingual digital menus with drag-and-drop ease",
                selectTemplate: "Choose Your Template",
                getStarted: "Get Started",
                
                // Templates
                modern: "Modern",
                elegant: "Elegant", 
                casual: "Casual",
                premium: "Premium",
                modernDesc: "Clean, contemporary design perfect for modern establishments",
                elegantDesc: "Sophisticated styling ideal for fine dining restaurants",
                casualDesc: "Friendly, approachable design for family restaurants",
                premiumDesc: "Luxurious experience with golden accents and premium feel",
                useTemplate: "Use This Template",
                
                // Editor
                menuEditor: "Menu Editor",
                restaurantInfo: "Restaurant Information",
                design: "Design Settings",
                sections: "Menu Sections",
                preview: "Preview",
                
                // Forms
                restaurantName: "Restaurant Name",
                tagline: "Restaurant Tagline",
                addSection: "Add Section",
                addItem: "Add Menu Item",
                editItem: "Edit Menu Item",
                editSection: "Edit Section",
                
                // Item fields
                itemName: "Item Name (English)",
                itemNameAr: "Item Name (Arabic)",
                description: "Description (English)",
                descriptionAr: "Description (Arabic)",
                price: "Price ($)",
                image: "Food Image",
                model3d: "3D Model (.glb)",
                
                // Item properties
                spicy: "Spicy 🌶️",
                vegetarian: "Vegetarian 🌱",
                vegan: "Vegan 🌿",
                glutenFree: "Gluten Free",
                popular: "Popular Choice",
                
                // Actions
                save: "Save Changes",
                cancel: "Cancel",
                delete: "Delete",
                edit: "Edit",
                duplicate: "Duplicate",
                publish: "Publish Menu",
                share: "Share Menu",
                
                // Design controls
                colorScheme: "Color Scheme",
                fontFamily: "Font Style",
                spacing: "Layout Spacing",
                headerStyle: "Header Style",
                
                // Preview modes
                desktop: "Desktop View",
                mobile: "Mobile View",
                tablet: "Tablet View",
                
                // Sharing
                published: "🎉 Menu Published Successfully!",
                shareLink: "Share this link with your customers:",
                qrCode: "QR Code for Easy Access",
                copyLink: "Copy Link",
                downloadQR: "Download QR Code",
                linkCopied: "Link copied to clipboard!",
                
                // Status messages
                saving: "Saving...",
                loading: "Loading...",
                uploadingImage: "Uploading image...",
                uploading3D: "Uploading 3D model...",
                
                // Placeholders
                enterRestaurantName: "Enter your restaurant name",
                enterTagline: "Enter a catchy tagline",
                enterItemName: "e.g., Grilled Salmon",
                enterDescription: "Describe this delicious item...",
                enterPrice: "0.00",
                
                // Empty states
                noSections: "No menu sections yet. Start by adding your first section!",
                noItems: "No items in this section. Add your first menu item!",
                
                // File upload
                chooseFile: "Choose File",
                dragDropHint: "Drag & drop files here or click to browse",
                supportedFormats: "Supported: JPG, PNG, WebP for images | GLB for 3D models",
                removeFile: "Remove File",
                
                // Section fields
                sectionName: "Section Name (English)",
                sectionNameAr: "Section Name (Arabic)", 
                sectionDesc: "Section Description (English)",
                sectionDescAr: "Section Description (Arabic)",
                
                // Validation
                nameRequired: "Name is required",
                priceRequired: "Price is required",
                invalidPrice: "Please enter a valid price",
                
                // Success messages
                itemAdded: "Menu item added successfully!",
                itemUpdated: "Menu item updated successfully!",
                sectionAdded: "Menu section added successfully!",
                sectionUpdated: "Menu section updated successfully!",
                menuSaved: "Menu saved successfully!",
            },
            ar: {
                // Main navigation
                title: "منشئ قوائم المطاعم",
                subtitle: "إنشاء قوائم رقمية جميلة ومتعددة اللغات بسهولة السحب والإفلات",
                selectTemplate: "اختر القالب المناسب",
                getStarted: "ابدأ الآن",
                
                // Templates
                modern: "عصري",
                elegant: "أنيق",
                casual: "عادي", 
                premium: "فاخر",
                modernDesc: "تصميم نظيف ومعاصر مثالي للمؤسسات الحديثة",
                elegantDesc: "تصميم راقي مثالي للمطاعم الفاخرة",
                casualDesc: "تصميم ودود ومألوف للمطاعم العائلية",
                premiumDesc: "تجربة فاخرة مع لمسات ذهبية وشعور مميز",
                useTemplate: "استخدم هذا القالب",
                
                // Editor
                menuEditor: "محرر القائمة",
                restaurantInfo: "معلومات المطعم",
                design: "إعدادات التصميم",
                sections: "أقسام القائمة",
                preview: "معاينة",
                
                // Forms
                restaurantName: "اسم المطعم",
                tagline: "شعار المطعم",
                addSection: "إضافة قسم",
                addItem: "إضافة عنصر قائمة",
                editItem: "تعديل عنصر القائمة",
                editSection: "تعديل القسم",
                
                // Item fields
                itemName: "اسم العنصر (إنجليزي)",
                itemNameAr: "اسم العنصر (عربي)",
                description: "الوصف (إنجليزي)",
                descriptionAr: "الوصف (عربي)",
                price: "السعر (ريال)",
                image: "صورة الطعام",
                model3d: "نموذج ثلاثي الأبعاد (.glb)",
                
                // Item properties
                spicy: "حار 🌶️",
                vegetarian: "نباتي 🌱",
                vegan: "نباتي تماماً 🌿",
                glutenFree: "خالي من الجلوتين",
                popular: "الأكثر طلباً",
                
                // Actions
                save: "حفظ التغييرات",
                cancel: "إلغاء",
                delete: "حذف",
                edit: "تعديل",
                duplicate: "نسخ",
                publish: "نشر القائمة",
                share: "مشاركة القائمة",
                
                // Design controls
                colorScheme: "نظام الألوان",
                fontFamily: "نمط الخط",
                spacing: "تباعد التخطيط",
                headerStyle: "نمط الرأس",
                
                // Preview modes
                desktop: "عرض سطح المكتب",
                mobile: "عرض الجوال",
                tablet: "عرض الجهاز اللوحي",
                
                // Sharing
                published: "🎉 تم نشر القائمة بنجاح!",
                shareLink: "شارك هذا الرابط مع عملائك:",
                qrCode: "رمز الاستجابة السريعة للوصول السهل",
                copyLink: "نسخ الرابط",
                downloadQR: "تحميل رمز الاستجابة السريعة",
                linkCopied: "تم نسخ الرابط!",
                
                // Status messages
                saving: "جاري الحفظ...",
                loading: "جاري التحميل...",
                uploadingImage: "جاري رفع الصورة...",
                uploading3D: "جاري رفع النموذج ثلاثي الأبعاد...",
                
                // Placeholders
                enterRestaurantName: "أدخل اسم مطعمك",
                enterTagline: "أدخل شعاراً جذاباً",
                enterItemName: "مثال: سلمون مشوي",
                enterDescription: "صف هذا الطبق اللذيذ...",
                enterPrice: "0.00",
                
                // Empty states
                noSections: "لا توجد أقسام في القائمة بعد. ابدأ بإضافة قسمك الأول!",
                noItems: "لا توجد عناصر في هذا القسم. أضف أول عنصر في القائمة!",
                
                // File upload
                chooseFile: "اختر ملف",
                dragDropHint: "اسحب وأفلت الملفات هنا أو انقر للتصفح",
                supportedFormats: "المدعوم: JPG، PNG، WebP للصور | GLB للنماذج ثلاثية الأبعاد",
                removeFile: "إزالة الملف",
                
                // Section fields
                sectionName: "اسم القسم (إنجليزي)",
                sectionNameAr: "اسم القسم (عربي)",
                sectionDesc: "وصف القسم (إنجليزي)",
                sectionDescAr: "وصف القسم (عربي)",
                
                // Validation
                nameRequired: "الاسم مطلوب",
                priceRequired: "السعر مطلوب",
                invalidPrice: "يرجى إدخال سعر صحيح",
                
                // Success messages
                itemAdded: "تم إضافة عنصر القائمة بنجاح!",
                itemUpdated: "تم تحديث عنصر القائمة بنجاح!",
                sectionAdded: "تم إضافة قسم القائمة بنجاح!",
                sectionUpdated: "تم تحديث قسم القائمة بنجاح!",
                menuSaved: "تم حفظ القائمة بنجاح!",
            }
        };

        // Language Context
        const LanguageContext = React.createContext();

        function LanguageProvider({ children }) {
            const [language, setLanguage] = useState('en');
            const isRTL = language === 'ar';
            
            const t = useCallback((key) => {
                return translations[language][key] || key;
            }, [language]);
            
            const toggleLanguage = useCallback(() => {
                setLanguage(prev => prev === 'en' ? 'ar' : 'en');
            }, []);
            
            const value = useMemo(() => ({
                language, isRTL, t, toggleLanguage
            }), [language, isRTL, t, toggleLanguage]);
            
            return React.createElement(LanguageContext.Provider, { value }, children);
        }

        function useLanguage() {
            const context = React.useContext(LanguageContext);
            if (!context) {
                throw new Error('useLanguage must be used within LanguageProvider');
            }
            return context;
        }

        // Toast Context for notifications
        const ToastContext = React.createContext();

        function ToastProvider({ children }) {
            const [toasts, setToasts] = useState([]);
            
            const addToast = useCallback((message, type = 'success') => {
                const id = Date.now();
                const newToast = { id, message, type };
                setToasts(prev => [...prev, newToast]);
                
                setTimeout(() => {
                    setToasts(prev => prev.filter(toast => toast.id !== id));
                }, 3000);
            }, []);
            
            const removeToast = useCallback((id) => {
                setToasts(prev => prev.filter(toast => toast.id !== id));
            }, []);
            
            const value = useMemo(() => ({
                toasts, addToast, removeToast
            }), [toasts, addToast, removeToast]);
            
            return React.createElement(ToastContext.Provider, { value }, children);
        }

        function useToast() {
            const context = React.useContext(ToastContext);
            if (!context) {
                throw new Error('useToast must be used within ToastProvider');
            }
            return context;
        }

        // Toast Component
        function Toast({ toast, onRemove }) {
            const { t } = useLanguage();
            
            useEffect(() => {
                const timer = setTimeout(() => {
                    onRemove(toast.id);
                }, 3000);
                
                return () => clearTimeout(timer);
            }, [toast.id, onRemove]);
            
            const bgColor = toast.type === 'error' ? 'bg-red-50 border-red-200' : 
                           toast.type === 'warning' ? 'bg-yellow-50 border-yellow-200' :
                           'bg-green-50 border-green-200';
            
            const textColor = toast.type === 'error' ? 'text-red-800' :
                             toast.type === 'warning' ? 'text-yellow-800' :
                             'text-green-800';
            
            return React.createElement('div', {
                className: `toast ${bgColor} ${textColor}`,
                onClick: () => onRemove(toast.id)
            }, [
                React.createElement('div', {
                    key: 'content',
                    className: 'flex items-center gap-2'
                }, [
                    React.createElement('span', { key: 'icon' }, 
                        toast.type === 'error' ? '❌' :
                        toast.type === 'warning' ? '⚠️' : '✅'
                    ),
                    React.createElement('span', { key: 'message' }, toast.message)
                ]),
                React.createElement('button', {
                    key: 'close',
                    className: 'ml-2 text-gray-400 hover:text-gray-600',
                    onClick: (e) => {
                        e.stopPropagation();
                        onRemove(toast.id);
                    }
                }, '×')
            ]);
        }

        // Authentication System
        const AuthContext = React.createContext();

        function AuthProvider({ children }) {
            const [user, setUser] = useState(null);
            const [isLoading, setIsLoading] = useState(false);
            const [showAuthModal, setShowAuthModal] = useState(false);

            const signIn = async (email, password) => {
                setIsLoading(true);
                try {
                    // Simulate API call
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    const userData = { id: 1, email, name: email.split('@')[0] };
                    setUser(userData);
                    localStorage.setItem('user', JSON.stringify(userData));
                    setShowAuthModal(false);
                } catch (error) {
                    throw new Error('Login failed');
                } finally {
                    setIsLoading(false);
                }
            };

            const signUp = async (email, password, name) => {
                setIsLoading(true);
                try {
                    // Simulate API call
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    const userData = { id: 1, email, name };
                    setUser(userData);
                    localStorage.setItem('user', JSON.stringify(userData));
                    setShowAuthModal(false);
                } catch (error) {
                    throw new Error('Sign up failed');
                } finally {
                    setIsLoading(false);
                }
            };

            const signOut = () => {
                setUser(null);
                localStorage.removeItem('user');
            };

            useEffect(() => {
                const savedUser = localStorage.getItem('user');
                if (savedUser) {
                    setUser(JSON.parse(savedUser));
                }
            }, []);

            const value = { user, isLoading, signIn, signUp, signOut, showAuthModal, setShowAuthModal };
            return React.createElement(AuthContext.Provider, { value }, children);
        }

        function useAuth() {
            const context = React.useContext(AuthContext);
            if (!context) {
                throw new Error('useAuth must be used within AuthProvider');
            }
            return context;
        }

        // Customization Context
        const CustomizationContext = React.createContext();

        function CustomizationProvider({ children }) {
            const [customization, setCustomization] = useState({
                fontFamily: 'font-inter',
                titleSize: 'title-size-normal',
                textSize: 'font-size-normal',
                priceSize: 'price-size-normal',
                cardLayout: 'card-layout-classic',
                backgroundColor: '#f7fafc',
                backgroundImage: '',
                buttonColor: '#667eea',
                buttonRadius: '12px',
                customColors: {
                    primary: '#667eea',
                    secondary: '#764ba2',
                    text: '#1a202c'
                }
            });

            const updateCustomization = (updates) => {
                setCustomization(prev => ({ ...prev, ...updates }));
                localStorage.setItem('menuCustomization', JSON.stringify({ ...customization, ...updates }));
            };

            useEffect(() => {
                const saved = localStorage.getItem('menuCustomization');
                if (saved) {
                    setCustomization(JSON.parse(saved));
                }
            }, []);

            const value = { customization, updateCustomization };
            return React.createElement(CustomizationContext.Provider, { value }, children);
        }

        function useCustomization() {
            const context = React.useContext(CustomizationContext);
            if (!context) {
                throw new Error('useCustomization must be used within CustomizationProvider');
            }
            return context;
        }

        // Enhanced 3D Model Viewer Component
        function Enhanced3DViewer({ src, alt, fallbackImage, className = '' }) {
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState(false);
            const [showImage, setShowImage] = useState(false);

            const handleLoad = () => {
                setLoading(false);
            };

            const handleError = () => {
                setLoading(false);
                setError(true);
            };

            const toggleView = () => {
                setShowImage(!showImage);
            };

            if (!src && !fallbackImage) {
                return React.createElement('div', {
                    className: `model-placeholder ${className}`
                }, '🎮');
            }

            return React.createElement('div', {
                className: `model-container ${className}`
            }, [
                loading && React.createElement('div', {
                    key: 'loading',
                    className: 'model-loading'
                }, [
                    React.createElement('div', {
                        key: 'spinner',
                        className: 'loading-spinner'
                    }),
                    React.createElement('span', {
                        key: 'text'
                    }, 'Loading 3D Model...')
                ]),

                (error || showImage) && fallbackImage ? 
                    React.createElement('img', {
                        key: 'fallback',
                        src: fallbackImage,
                        alt: alt,
                        className: 'w-full h-full object-cover'
                    }) : 
                    React.createElement('model-viewer', {
                        key: 'model',
                        src: src,
                        alt: alt,
                        'auto-rotate': true,
                        'camera-controls': true,
                        'disable-zoom': false,
                        onLoad: handleLoad,
                        onError: handleError,
                        style: { width: '100%', height: '250px' }
                    }),

                (src && fallbackImage) && React.createElement('button', {
                    key: 'toggle',
                    className: 'absolute top-2 right-2 btn btn-secondary btn-sm',
                    onClick: toggleView
                }, showImage ? '🎮 3D' : '📷 Photo')
            ]);
        }

        // Authentication Modal Component
        function AuthModal() {
            const { showAuthModal, setShowAuthModal, signIn, signUp, isLoading } = useAuth();
            const { t } = useLanguage();
            const [isSignUp, setIsSignUp] = useState(false);
            const [formData, setFormData] = useState({
                email: '',
                password: '',
                name: ''
            });
            const [error, setError] = useState('');

            const handleSubmit = async (e) => {
                e.preventDefault();
                setError('');
                
                try {
                    if (isSignUp) {
                        await signUp(formData.email, formData.password, formData.name);
                    } else {
                        await signIn(formData.email, formData.password);
                    }
                } catch (err) {
                    setError(err.message);
                }
            };

            const resetForm = () => {
                setFormData({ email: '', password: '', name: '' });
                setError('');
            };

            if (!showAuthModal) return null;

            return React.createElement('div', { 
                className: 'auth-modal',
                onClick: (e) => {
                    if (e.target === e.currentTarget) {
                        setShowAuthModal(false);
                        resetForm();
                    }
                }
            }, [
                React.createElement('div', {
                    key: 'content',
                    className: 'auth-content'
                }, [
                    React.createElement('div', {
                        key: 'header',
                        className: 'text-center mb-8'
                    }, [
                        React.createElement('h2', {
                            key: 'title',
                            className: 'text-3xl font-bold mb-2'
                        }, isSignUp ? 'Create Account' : 'Welcome Back'),
                        React.createElement('p', {
                            key: 'subtitle',
                            className: 'text-gray-600'
                        }, isSignUp ? 'Join thousands of restaurants' : 'Sign in to your account')
                    ]),

                    React.createElement('form', {
                        key: 'form',
                        onSubmit: handleSubmit,
                        className: 'space-y-4'
                    }, [
                        isSignUp && React.createElement('div', { key: 'name' }, [
                            React.createElement('label', {
                                key: 'label',
                                className: 'block text-sm font-semibold mb-2'
                            }, 'Full Name'),
                            React.createElement('input', {
                                key: 'input',
                                type: 'text',
                                className: 'input-field',
                                value: formData.name,
                                onChange: (e) => setFormData({...formData, name: e.target.value}),
                                required: isSignUp,
                                placeholder: 'Enter your full name'
                            })
                        ]),

                        React.createElement('div', { key: 'email' }, [
                            React.createElement('label', {
                                key: 'label',
                                className: 'block text-sm font-semibold mb-2'
                            }, 'Email Address'),
                            React.createElement('input', {
                                key: 'input',
                                type: 'email',
                                className: 'input-field',
                                value: formData.email,
                                onChange: (e) => setFormData({...formData, email: e.target.value}),
                                required: true,
                                placeholder: 'your@email.com'
                            })
                        ]),

                        React.createElement('div', { key: 'password' }, [
                            React.createElement('label', {
                                key: 'label',
                                className: 'block text-sm font-semibold mb-2'
                            }, 'Password'),
                            React.createElement('input', {
                                key: 'input',
                                type: 'password',
                                className: 'input-field',
                                value: formData.password,
                                onChange: (e) => setFormData({...formData, password: e.target.value}),
                                required: true,
                                placeholder: '••••••••'
                            })
                        ]),

                        error && React.createElement('div', {
                            key: 'error',
                            className: 'bg-red-50 border border-red-200 text-red-700 p-3 rounded-lg text-sm'
                        }, error),

                        React.createElement('button', {
                            key: 'submit',
                            type: 'submit',
                            className: 'btn btn-primary w-full',
                            disabled: isLoading
                        }, isLoading ? 
                            React.createElement('div', { className: 'loading-spinner' }) : 
                            (isSignUp ? 'Create Account' : 'Sign In')
                        ),

                        React.createElement('div', {
                            key: 'toggle',
                            className: 'text-center mt-4'
                        }, [
                            React.createElement('span', {
                                key: 'text',
                                className: 'text-gray-600'
                            }, isSignUp ? 'Already have an account?' : "Don't have an account?"),
                            React.createElement('button', {
                                key: 'button',
                                type: 'button',
                                className: 'ml-2 text-blue-600 font-semibold hover:underline',
                                onClick: () => {
                                    setIsSignUp(!isSignUp);
                                    resetForm();
                                }
                            }, isSignUp ? 'Sign In' : 'Sign Up')
                        ])
                    ])
                ])
            ]);
        }

        // Advanced Customization Panel Component
        function CustomizationPanel({ isOpen, onClose }) {
            const { customization, updateCustomization } = useCustomization();
            const { t } = useLanguage();

            const fontOptions = [
                { id: 'font-inter', name: 'Inter', preview: 'Modern & Clean' },
                { id: 'font-poppins', name: 'Poppins', preview: 'Friendly & Round' },
                { id: 'font-playfair', name: 'Playfair', preview: 'Elegant & Sophisticated' },
                { id: 'font-roboto', name: 'Roboto', preview: 'Technical & Modern' },
                { id: 'font-opensans', name: 'Open Sans', preview: 'Clean & Neutral' }
            ];

            const cardLayouts = [
                { id: 'card-layout-classic', name: 'Classic', preview: 'Traditional border style' },
                { id: 'card-layout-modern', name: 'Modern', preview: 'Gradient background with shadow' },
                { id: 'card-layout-compact', name: 'Compact', preview: 'Space-efficient design' }
            ];

            const sizeOptions = [
                { id: 'small', name: 'Small' },
                { id: 'normal', name: 'Normal' },
                { id: 'large', name: 'Large' },
                { id: 'xl', name: 'Extra Large' }
            ];

            if (!isOpen) return null;

            return React.createElement('div', { 
                className: 'modal',
                onClick: (e) => {
                    if (e.target === e.currentTarget) {
                        onClose();
                    }
                }
            }, [
                React.createElement('div', {
                    key: 'content',
                    className: 'modal-content',
                    style: { maxWidth: '800px' }
                }, [
                    React.createElement('div', {
                        key: 'header',
                        className: 'flex items-center justify-between mb-6'
                    }, [
                        React.createElement('h2', {
                            key: 'title',
                            className: 'text-2xl font-bold'
                        }, 'Customize Your Menu'),
                        React.createElement('button', {
                            key: 'close',
                            className: 'text-gray-400 hover:text-gray-600 text-2xl',
                            onClick: onClose
                        }, '×')
                    ]),

                    React.createElement('div', {
                        key: 'content',
                        className: 'grid grid-cols-1 md:grid-cols-2 gap-8'
                    }, [
                        React.createElement('div', {
                            key: 'fonts',
                            className: 'space-y-6'
                        }, [
                            React.createElement('div', { key: 'font-family' }, [
                                React.createElement('h3', {
                                    key: 'title',
                                    className: 'text-lg font-semibold mb-4'
                                }, 'Font Family'),
                                React.createElement('div', {
                                    key: 'options',
                                    className: 'space-y-2'
                                }, fontOptions.map(font => 
                                    React.createElement('label', {
                                        key: font.id,
                                        className: `flex items-center p-3 border rounded-lg cursor-pointer transition-colors ${
                                            customization.fontFamily === font.id ? 'border-blue-500 bg-blue-50' : 'border-gray-200 hover:border-gray-300'
                                        }`
                                    }, [
                                        React.createElement('input', {
                                            key: 'radio',
                                            type: 'radio',
                                            name: 'fontFamily',
                                            value: font.id,
                                            checked: customization.fontFamily === font.id,
                                            onChange: (e) => updateCustomization({ fontFamily: e.target.value }),
                                            className: 'mr-3'
                                        }),
                                        React.createElement('div', { key: 'info' }, [
                                            React.createElement('div', {
                                                key: 'name',
                                                className: `font-semibold ${font.id}`
                                            }, font.name),
                                            React.createElement('div', {
                                                key: 'preview',
                                                className: 'text-sm text-gray-600'
                                            }, font.preview)
                                        ])
                                    ])
                                ))
                            ]),

                            React.createElement('div', { key: 'font-sizes' }, [
                                React.createElement('h3', {
                                    key: 'title',
                                    className: 'text-lg font-semibold mb-4'
                                }, 'Font Sizes'),
                                React.createElement('div', {
                                    key: 'controls',
                                    className: 'space-y-4'
                                }, [
                                    ['titleSize', 'Title Size', 'title-size-'],
                                    ['textSize', 'Text Size', 'font-size-'],
                                    ['priceSize', 'Price Size', 'price-size-']
                                ].map(([key, label, prefix]) => 
                                    React.createElement('div', { key: key }, [
                                        React.createElement('label', {
                                            key: 'label',
                                            className: 'block text-sm font-semibold mb-2'
                                        }, label),
                                        React.createElement('select', {
                                            key: 'select',
                                            className: 'input-field',
                                            value: customization[key].replace(prefix, ''),
                                            onChange: (e) => updateCustomization({ [key]: prefix + e.target.value })
                                        }, sizeOptions.map(size => 
                                            React.createElement('option', {
                                                key: size.id,
                                                value: size.id
                                            }, size.name)
                                        ))
                                    ])
                                ))
                            ])
                        ]),

                        React.createElement('div', {
                            key: 'layout',
                            className: 'space-y-6'
                        }, [
                            React.createElement('div', { key: 'card-layout' }, [
                                React.createElement('h3', {
                                    key: 'title',
                                    className: 'text-lg font-semibold mb-4'
                                }, 'Card Layout'),
                                React.createElement('div', {
                                    key: 'options',
                                    className: 'space-y-2'
                                }, cardLayouts.map(layout => 
                                    React.createElement('label', {
                                        key: layout.id,
                                        className: `flex items-center p-3 border rounded-lg cursor-pointer transition-colors ${
                                            customization.cardLayout === layout.id ? 'border-blue-500 bg-blue-50' : 'border-gray-200 hover:border-gray-300'
                                        }`
                                    }, [
                                        React.createElement('input', {
                                            key: 'radio',
                                            type: 'radio',
                                            name: 'cardLayout',
                                            value: layout.id,
                                            checked: customization.cardLayout === layout.id,
                                            onChange: (e) => updateCustomization({ cardLayout: e.target.value }),
                                            className: 'mr-3'
                                        }),
                                        React.createElement('div', { key: 'info' }, [
                                            React.createElement('div', {
                                                key: 'name',
                                                className: 'font-semibold'
                                            }, layout.name),
                                            React.createElement('div', {
                                                key: 'preview',
                                                className: 'text-sm text-gray-600'
                                            }, layout.preview)
                                        ])
                                    ])
                                ))
                            ]),

                            React.createElement('div', { key: 'colors' }, [
                                React.createElement('h3', {
                                    key: 'title',
                                    className: 'text-lg font-semibold mb-4'
                                }, 'Colors'),
                                React.createElement('div', {
                                    key: 'controls',
                                    className: 'space-y-4'
                                }, [
                                    React.createElement('div', { key: 'bg-color' }, [
                                        React.createElement('label', {
                                            key: 'label',
                                            className: 'block text-sm font-semibold mb-2'
                                        }, 'Background Color'),
                                        React.createElement('input', {
                                            key: 'input',
                                            type: 'color',
                                            className: 'w-full h-10 border rounded-lg cursor-pointer',
                                            value: customization.backgroundColor,
                                            onChange: (e) => updateCustomization({ backgroundColor: e.target.value })
                                        })
                                    ]),
                                    React.createElement('div', { key: 'btn-color' }, [
                                        React.createElement('label', {
                                            key: 'label',
                                            className: 'block text-sm font-semibold mb-2'
                                        }, 'Button Color'),
                                        React.createElement('input', {
                                            key: 'input',
                                            type: 'color',
                                            className: 'w-full h-10 border rounded-lg cursor-pointer',
                                            value: customization.buttonColor,
                                            onChange: (e) => updateCustomization({ buttonColor: e.target.value })
                                        })
                                    ])
                                ])
                            ])
                        ])
                    ]),

                    React.createElement('div', {
                        key: 'actions',
                        className: 'flex gap-3 pt-6 border-t mt-8'
                    }, [
                        React.createElement('button', {
                            key: 'reset',
                            className: 'btn btn-secondary flex-1',
                            onClick: () => {
                                updateCustomization({
                                    fontFamily: 'font-inter',
                                    titleSize: 'title-size-normal',
                                    textSize: 'font-size-normal',
                                    priceSize: 'price-size-normal',
                                    cardLayout: 'card-layout-classic',
                                    backgroundColor: '#f7fafc',
                                    buttonColor: '#667eea'
                                });
                            }
                        }, 'Reset to Defaults'),
                        React.createElement('button', {
                            key: 'apply',
                            className: 'btn btn-primary flex-1',
                            onClick: onClose
                        }, 'Apply Changes')
                    ])
                ])
            ]);
        }

        // Enhanced Templates with more design options
        const templates = [
            {
                id: 'modern',
                name: 'Modern',
                description: 'Clean and contemporary design',
                colorScheme: 'indigo',
                fontFamily: 'inter',
                headerStyle: 'gradient',
                spacing: 3,
                category: 'modern',
                preview: {
                    headerBg: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                    accentColor: '#667eea',
                    typography: 'Inter'
                }
            },
            {
                id: 'elegant',
                name: 'Elegant',
                description: 'Sophisticated fine dining style',
                colorScheme: 'rose',
                fontFamily: 'serif',
                headerStyle: 'solid',
                spacing: 4,
                category: 'elegant',
                preview: {
                    headerBg: 'linear-gradient(135deg, #f43f5e 0%, #e11d48 100%)',
                    accentColor: '#f43f5e',
                    typography: 'Playfair Display'
                }
            },
            {
                id: 'casual',
                name: 'Casual',
                description: 'Friendly family restaurant design',
                colorScheme: 'emerald',
                fontFamily: 'sans',
                headerStyle: 'gradient',
                spacing: 2,
                category: 'casual',
                preview: {
                    headerBg: 'linear-gradient(135deg, #10b981 0%, #059669 100%)',
                    accentColor: '#10b981',
                    typography: 'System UI'
                }
            },
            {
                id: 'premium',
                name: 'Premium',
                description: 'Luxurious premium experience',
                colorScheme: 'amber',
                fontFamily: 'serif',
                headerStyle: 'image',
                spacing: 5,
                category: 'premium',
                preview: {
                    headerBg: 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)',
                    accentColor: '#f59e0b',
                    typography: 'Playfair Display'
                }
            }
        ];

        // Local Storage utilities
        const storage = {
            save: (key, data) => {
                try {
                    localStorage.setItem(key, JSON.stringify(data));
                } catch (error) {
                    console.error('Failed to save to localStorage:', error);
                }
            },
            load: (key, defaultValue = null) => {
                try {
                    const stored = localStorage.getItem(key);
                    return stored ? JSON.parse(stored) : defaultValue;
                } catch (error) {
                    console.error('Failed to load from localStorage:', error);
                    return defaultValue;
                }
            },
            remove: (key) => {
                try {
                    localStorage.removeItem(key);
                } catch (error) {
                    console.error('Failed to remove from localStorage:', error);
                }
            }
        };

        // Enhanced File Upload Component with drag & drop
        function FileUpload({ accept, onUpload, currentFile, label, type, className = '' }) {
            const { t } = useLanguage();
            const { addToast } = useToast();
            const fileInputRef = useRef(null);
            const [preview, setPreview] = useState(currentFile || null);
            const [isDragging, setIsDragging] = useState(false);
            const [isUploading, setIsUploading] = useState(false);

            const handleFileSelect = useCallback(async (file) => {
                if (!file) return;
                
                setIsUploading(true);
                addToast(type === '3d' ? t('uploading3D') : t('uploadingImage'), 'info');
                
                try {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const result = e.target.result;
                        setPreview(result);
                        onUpload(result);
                        setIsUploading(false);
                        addToast(`${label} uploaded successfully!`, 'success');
                    };
                    reader.readAsDataURL(file);
                } catch (error) {
                    setIsUploading(false);
                    addToast('Upload failed. Please try again.', 'error');
                }
            }, [onUpload, type, label, t, addToast]);

            const handleDrop = useCallback((e) => {
                e.preventDefault();
                setIsDragging(false);
                
                const files = Array.from(e.dataTransfer.files);
                if (files.length > 0) {
                    handleFileSelect(files[0]);
                }
            }, [handleFileSelect]);

            const handleDragOver = useCallback((e) => {
                e.preventDefault();
                setIsDragging(true);
            }, []);

            const handleDragLeave = useCallback((e) => {
                e.preventDefault();
                setIsDragging(false);
            }, []);

            const renderPreview = () => {
                if (!preview) return null;

                if (type === '3d' && preview.includes('data:')) {
                    return React.createElement('div', {
                        className: 'mt-3 p-4 bg-blue-50 border border-blue-200 rounded-lg text-center'
                    }, [
                        React.createElement('div', {
                            key: 'icon',
                            className: 'text-3xl mb-2'
                        }, '🎮'),
                        React.createElement('p', {
                            key: 'text',
                            className: 'text-blue-700 font-medium'
                        }, '3D Model Ready!')
                    ]);
                } else if (type === 'image' && preview.includes('data:')) {
                    return React.createElement('div', {
                        className: 'mt-3'
                    }, [
                        React.createElement('img', {
                            key: 'preview',
                            src: preview,
                            alt: 'Preview',
                            className: 'w-full h-32 object-cover rounded-lg border border-gray-200'
                        })
                    ]);
                }
                return null;
            };

            return React.createElement('div', {
                className: `space-y-3 ${className}`
            }, [
                React.createElement('label', {
                    key: 'label',
                    className: 'block text-sm font-semibold text-gray-700'
                }, label),
                
                React.createElement('div', {
                    key: 'upload-area',
                    className: `border-2 border-dashed rounded-xl p-6 text-center transition-all ${
                        isDragging ? 'border-blue-400 bg-blue-50' : 'border-gray-300 hover:border-gray-400'
                    }`,
                    onDrop: handleDrop,
                    onDragOver: handleDragOver,
                    onDragLeave: handleDragLeave
                }, [
                    React.createElement('input', {
                        key: 'input',
                        ref: fileInputRef,
                        type: 'file',
                        accept: accept,
                        onChange: (e) => handleFileSelect(e.target.files[0]),
                        className: 'hidden'
                    }),
                    
                    isUploading ? React.createElement('div', {
                        key: 'loading',
                        className: 'flex flex-col items-center'
                    }, [
                        React.createElement('div', {
                            key: 'spinner',
                            className: 'loading-spinner mb-2'
                        }),
                        React.createElement('p', {
                            key: 'text',
                            className: 'text-gray-600'
                        }, t('loading'))
                    ]) : React.createElement('div', {
                        key: 'upload-content',
                        className: 'space-y-3'
                    }, [
                        React.createElement('div', {
                            key: 'icon',
                            className: 'text-4xl'
                        }, type === '3d' ? '🎮' : '📷'),
                        
                        React.createElement('p', {
                            key: 'hint',
                            className: 'text-gray-600'
                        }, t('dragDropHint')),
                        
                        React.createElement('button', {
                            key: 'button',
                            type: 'button',
                            className: 'btn btn-primary',
                            onClick: () => fileInputRef.current?.click()
                        }, t('chooseFile')),
                        
                        React.createElement('p', {
                            key: 'formats',
                            className: 'text-xs text-gray-500'
                        }, t('supportedFormats'))
                    ]),
                    
                    preview && React.createElement('button', {
                        key: 'remove',
                        type: 'button',
                        className: 'btn btn-danger mt-3',
                        onClick: () => {
                            setPreview(null);
                            onUpload('');
                        }
                    }, t('removeFile'))
                ]),
                
                renderPreview()
            ]);
        }

        // Enhanced Template Selection with better previews
        function TemplateSelection({ onSelectTemplate }) {
            const { t, isRTL } = useLanguage();
            const [selectedTemplate, setSelectedTemplate] = useState(null);

            const handleSelectTemplate = (template) => {
                setSelectedTemplate(template.id);
                setTimeout(() => {
                    onSelectTemplate(template);
                }, 300);
            };

            return React.createElement('div', {
                className: `min-h-screen p-8 ${isRTL ? 'rtl' : ''}`,
                dir: isRTL ? 'rtl' : 'ltr'
            }, [
                React.createElement('div', {
                    key: 'header',
                    className: 'text-center mb-16 animate-fade-in'
                }, [
                    React.createElement('h1', {
                        key: 'title',
                        className: 'text-6xl font-bold text-white mb-6 leading-tight'
                    }, t('title')),
                    React.createElement('p', {
                        key: 'subtitle',
                        className: 'text-xl text-white opacity-90 max-w-2xl mx-auto leading-relaxed'
                    }, t('subtitle')),
                    React.createElement('div', {
                        key: 'cta',
                        className: 'mt-8'
                    }, [
                        React.createElement('button', {
                            key: 'get-started',
                            className: 'btn btn-primary text-lg px-8 py-4',
                            onClick: () => document.getElementById('templates').scrollIntoView({ behavior: 'smooth' })
                        }, t('getStarted'))
                    ])
                ]),
                
                React.createElement('div', {
                    key: 'templates',
                    id: 'templates',
                    className: 'max-w-7xl mx-auto'
                }, [
                    React.createElement('h2', {
                        key: 'section-title',
                        className: 'text-3xl font-bold text-white text-center mb-12'
                    }, t('selectTemplate')),
                    
                    React.createElement('div', {
                        key: 'grid',
                        className: 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8'
                    }, templates.map((template, index) => 
                        React.createElement('div', {
                            key: template.id,
                            className: `template-card bg-white rounded-2xl overflow-hidden shadow-xl animate-slide-up ${
                                selectedTemplate === template.id ? 'ring-4 ring-white ring-opacity-50' : ''
                            }`,
                            style: { animationDelay: `${index * 100}ms` }
                        }, [
                            React.createElement('div', {
                                key: 'preview',
                                className: 'h-64 relative overflow-hidden',
                                style: { background: template.preview.headerBg }
                            }, [
                                React.createElement('div', {
                                    key: 'mock-header',
                                    className: 'absolute top-0 left-0 right-0 h-16 flex items-center justify-center text-white font-bold text-lg',
                                    style: { fontFamily: template.preview.typography }
                                }, 'Restaurant Name'),
                                
                                React.createElement('div', {
                                    key: 'mock-content',
                                    className: 'absolute bottom-0 left-0 right-0 bg-white p-4 space-y-2'
                                }, [
                                    React.createElement('div', {
                                        key: 'section',
                                        className: 'font-semibold text-gray-800 text-sm'
                                    }, 'Appetizers'),
                                    React.createElement('div', {
                                        key: 'item1',
                                        className: 'flex justify-between items-center text-xs'
                                    }, [
                                        React.createElement('span', { key: 'name' }, 'Caesar Salad'),
                                        React.createElement('span', { key: 'price' }, '$12')
                                    ]),
                                    React.createElement('div', {
                                        key: 'item2',
                                        className: 'flex justify-between items-center text-xs'
                                    }, [
                                        React.createElement('span', { key: 'name' }, 'Soup of the Day'),
                                        React.createElement('span', { key: 'price' }, '$8')
                                    ])
                                ])
                            ]),
                            
                            React.createElement('div', {
                                key: 'content',
                                className: 'p-6'
                            }, [
                                React.createElement('div', {
                                    key: 'header',
                                    className: 'mb-4'
                                }, [
                                    React.createElement('h3', {
                                        key: 'name',
                                        className: 'text-xl font-bold mb-2'
                                    }, t(template.name.toLowerCase())),
                                    React.createElement('p', {
                                        key: 'desc',
                                        className: 'text-gray-600 text-sm'
                                    }, t(template.name.toLowerCase() + 'Desc'))
                                ]),
                                
                                React.createElement('div', {
                                    key: 'features',
                                    className: 'space-y-2 mb-6'
                                }, [
                                    React.createElement('div', {
                                        key: 'color',
                                        className: 'flex items-center text-sm text-gray-600'
                                    }, [
                                        React.createElement('div', {
                                            key: 'swatch',
                                            className: 'w-3 h-3 rounded-full mr-2',
                                            style: { backgroundColor: template.preview.accentColor }
                                        }),
                                        React.createElement('span', { key: 'label' }, 'Color Scheme')
                                    ]),
                                    React.createElement('div', {
                                        key: 'font',
                                        className: 'flex items-center text-sm text-gray-600'
                                    }, [
                                        React.createElement('span', { key: 'icon', className: 'mr-2' }, '✨'),
                                        React.createElement('span', { key: 'label' }, template.preview.typography)
                                    ])
                                ]),
                                
                                React.createElement('button', {
                                    key: 'button',
                                    className: 'btn btn-primary w-full',
                                    onClick: () => handleSelectTemplate(template),
                                    disabled: selectedTemplate === template.id
                                }, selectedTemplate === template.id ? 'Selected ✓' : t('useTemplate'))
                            ])
                        ])
                    ))
                ])
            ]);
        }

        // Enhanced Item Edit Modal with better validation
        function ItemEditModal({ isOpen, onClose, onSave, item }) {
            const { t, isRTL } = useLanguage();
            const { addToast } = useToast();
            const [formData, setFormData] = useState({
                name: '',
                nameAr: '',
                description: '',
                descriptionAr: '',
                price: '',
                image: '',
                model3d: '',
                isSpicy: false,
                isVegetarian: false,
                isVegan: false,
                isGlutenFree: false,
                isPopular: false
            });
            const [errors, setErrors] = useState({});
            const [isSaving, setIsSaving] = useState(false);

            useEffect(() => {
                if (item) {
                    setFormData({ ...formData, ...item });
                } else {
                    setFormData({
                        name: '',
                        nameAr: '',
                        description: '',
                        descriptionAr: '',
                        price: '',
                        image: '',
                        model3d: '',
                        isSpicy: false,
                        isVegetarian: false,
                        isVegan: false,
                        isGlutenFree: false,
                        isPopular: false
                    });
                }
                setErrors({});
            }, [item, isOpen]);

            const validateForm = () => {
                const newErrors = {};
                
                if (!formData.name.trim()) {
                    newErrors.name = t('nameRequired');
                }
                
                if (!formData.price || parseFloat(formData.price) <= 0) {
                    newErrors.price = t('priceRequired');
                }
                
                setErrors(newErrors);
                return Object.keys(newErrors).length === 0;
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                
                if (!validateForm()) {
                    addToast('Please fix the errors below', 'error');
                    return;
                }
                
                setIsSaving(true);
                
                try {
                    await onSave(formData);
                    addToast(item ? t('itemUpdated') : t('itemAdded'), 'success');
                    onClose();
                } catch (error) {
                    addToast('Failed to save item. Please try again.', 'error');
                } finally {
                    setIsSaving(false);
                }
            };

            if (!isOpen) return null;

            return React.createElement('div', { className: 'modal' },
                React.createElement('div', {
                    className: `modal-content animate-slide-up ${isRTL ? 'rtl' : ''}`,
                    dir: isRTL ? 'rtl' : 'ltr'
                }, [
                    React.createElement('div', {
                        key: 'header',
                        className: 'flex items-center justify-between mb-6'
                    }, [
                        React.createElement('h2', {
                            key: 'title',
                            className: 'text-2xl font-bold text-gray-800'
                        }, item ? t('editItem') : t('addItem')),
                        React.createElement('button', {
                            key: 'close',
                            className: 'text-gray-400 hover:text-gray-600 text-2xl',
                            onClick: onClose
                        }, '×')
                    ]),
                    
                    React.createElement('form', {
                        key: 'form',
                        onSubmit: handleSubmit,
                        className: 'space-y-6'
                    }, [
                        React.createElement('div', {
                            key: 'name-row',
                            className: 'grid grid-cols-1 md:grid-cols-2 gap-4'
                        }, [
                            React.createElement('div', { key: 'name' }, [
                                React.createElement('label', {
                                    key: 'label',
                                    className: 'block text-sm font-semibold text-gray-700 mb-2'
                                }, t('itemName')),
                                React.createElement('input', {
                                    key: 'input',
                                    type: 'text',
                                    className: `input-field ${errors.name ? 'border-red-500' : ''}`,
                                    value: formData.name,
                                    onChange: (e) => setFormData({...formData, name: e.target.value}),
                                    placeholder: t('enterItemName')
                                }),
                                errors.name && React.createElement('p', {
                                    key: 'error',
                                    className: 'text-red-500 text-xs mt-1'
                                }, errors.name)
                            ]),
                            React.createElement('div', { key: 'nameAr' }, [
                                React.createElement('label', {
                                    key: 'label',
                                    className: 'block text-sm font-semibold text-gray-700 mb-2'
                                }, t('itemNameAr')),
                                React.createElement('input', {
                                    key: 'input',
                                    type: 'text',
                                    className: 'input-field',
                                    value: formData.nameAr,
                                    onChange: (e) => setFormData({...formData, nameAr: e.target.value}),
                                    dir: 'rtl',
                                    placeholder: t('enterItemName')
                                })
                            ])
                        ]),
                        
                        React.createElement('div', {
                            key: 'desc-row',
                            className: 'grid grid-cols-1 md:grid-cols-2 gap-4'
                        }, [
                            React.createElement('div', { key: 'desc' }, [
                                React.createElement('label', {
                                    key: 'label',
                                    className: 'block text-sm font-semibold text-gray-700 mb-2'
                                }, t('description')),
                                React.createElement('textarea', {
                                    key: 'input',
                                    className: 'input-field',
                                    rows: 3,
                                    value: formData.description,
                                    onChange: (e) => setFormData({...formData, description: e.target.value}),
                                    placeholder: t('enterDescription')
                                })
                            ]),
                            React.createElement('div', { key: 'descAr' }, [
                                React.createElement('label', {
                                    key: 'label',
                                    className: 'block text-sm font-semibold text-gray-700 mb-2'
                                }, t('descriptionAr')),
                                React.createElement('textarea', {
                                    key: 'input',
                                    className: 'input-field',
                                    rows: 3,
                                    value: formData.descriptionAr,
                                    onChange: (e) => setFormData({...formData, descriptionAr: e.target.value}),
                                    dir: 'rtl',
                                    placeholder: t('enterDescription')
                                })
                            ])
                        ]),
                        
                        React.createElement('div', { key: 'price' }, [
                            React.createElement('label', {
                                key: 'label',
                                className: 'block text-sm font-semibold text-gray-700 mb-2'
                            }, t('price')),
                            React.createElement('input', {
                                key: 'input',
                                type: 'number',
                                step: '0.01',
                                min: '0',
                                className: `input-field ${errors.price ? 'border-red-500' : ''}`,
                                value: formData.price,
                                onChange: (e) => setFormData({...formData, price: e.target.value}),
                                placeholder: t('enterPrice')
                            }),
                            errors.price && React.createElement('p', {
                                key: 'error',
                                className: 'text-red-500 text-xs mt-1'
                            }, errors.price)
                        ]),
                        
                        React.createElement('div', {
                            key: 'uploads',
                            className: 'grid grid-cols-1 md:grid-cols-2 gap-6'
                        }, [
                            React.createElement(FileUpload, {
                                key: 'image-upload',
                                type: 'image',
                                accept: 'image/*',
                                label: t('image'),
                                currentFile: formData.image,
                                onUpload: (url) => setFormData({...formData, image: url})
                            }),
                            React.createElement(FileUpload, {
                                key: '3d-upload',
                                type: '3d',
                                accept: '.glb,.gltf',
                                label: t('model3d'),
                                currentFile: formData.model3d,
                                onUpload: (url) => setFormData({...formData, model3d: url})
                            })
                        ]),
                        
                        React.createElement('div', { key: 'properties' }, [
                            React.createElement('label', {
                                key: 'label',
                                className: 'block text-sm font-semibold text-gray-700 mb-3'
                            }, 'Item Properties'),
                            React.createElement('div', {
                                key: 'checkboxes',
                                className: 'grid grid-cols-2 md:grid-cols-3 gap-3'
                            }, [
                                ['isSpicy', 'spicy'],
                                ['isVegetarian', 'vegetarian'],
                                ['isVegan', 'vegan'],
                                ['isGlutenFree', 'glutenFree'],
                                ['isPopular', 'popular']
                            ].map(([key, labelKey]) => 
                                React.createElement('label', {
                                    key: key,
                                    className: 'flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer transition-colors'
                                }, [
                                    React.createElement('input', {
                                        key: 'input',
                                        type: 'checkbox',
                                        checked: formData[key],
                                        onChange: (e) => setFormData({...formData, [key]: e.target.checked}),
                                        className: 'mr-2 w-4 h-4'
                                    }),
                                    React.createElement('span', {
                                        key: 'label',
                                        className: 'text-sm font-medium'
                                    }, t(labelKey))
                                ])
                            ))
                        ]),
                        
                        React.createElement('div', {
                            key: 'buttons',
                            className: 'flex gap-3 pt-6 border-t border-gray-200'
                        }, [
                            React.createElement('button', {
                                key: 'save',
                                type: 'submit',
                                className: 'btn btn-primary flex-1',
                                disabled: isSaving
                            }, isSaving ? [
                                React.createElement('div', {
                                    key: 'spinner',
                                    className: 'loading-spinner mr-2'
                                }),
                                t('saving')
                            ] : t('save')),
                            React.createElement('button', {
                                key: 'cancel',
                                type: 'button',
                                className: 'btn btn-secondary flex-1',
                                onClick: onClose,
                                disabled: isSaving
                            }, t('cancel'))
                        ])
                    ])
                ])
            );
        }

        // Enhanced Section Edit Modal
        function SectionEditModal({ isOpen, onClose, onSave, section }) {
            const { t, isRTL } = useLanguage();
            const { addToast } = useToast();
            const [formData, setFormData] = useState({
                name: '',
                nameAr: '',
                description: '',
                descriptionAr: ''
            });
            const [errors, setErrors] = useState({});
            const [isSaving, setIsSaving] = useState(false);

            useEffect(() => {
                if (section) {
                    setFormData({ ...formData, ...section });
                } else {
                    setFormData({
                        name: '',
                        nameAr: '',
                        description: '',
                        descriptionAr: ''
                    });
                }
                setErrors({});
            }, [section, isOpen]);

            const validateForm = () => {
                const newErrors = {};
                
                if (!formData.name.trim()) {
                    newErrors.name = t('nameRequired');
                }
                
                setErrors(newErrors);
                return Object.keys(newErrors).length === 0;
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                
                if (!validateForm()) {
                    addToast('Please fix the errors below', 'error');
                    return;
                }
                
                setIsSaving(true);
                
                try {
                    await onSave(formData);
                    addToast(section ? t('sectionUpdated') : t('sectionAdded'), 'success');
                    onClose();
                } catch (error) {
                    addToast('Failed to save section. Please try again.', 'error');
                } finally {
                    setIsSaving(false);
                }
            };

            if (!isOpen) return null;

            return React.createElement('div', { className: 'modal' },
                React.createElement('div', {
                    className: `modal-content animate-slide-up ${isRTL ? 'rtl' : ''}`,
                    dir: isRTL ? 'rtl' : 'ltr'
                }, [
                    React.createElement('div', {
                        key: 'header',
                        className: 'flex items-center justify-between mb-6'
                    }, [
                        React.createElement('h2', {
                            key: 'title',
                            className: 'text-2xl font-bold text-gray-800'
                        }, section ? t('editSection') : t('addSection')),
                        React.createElement('button', {
                            key: 'close',
                            className: 'text-gray-400 hover:text-gray-600 text-2xl',
                            onClick: onClose
                        }, '×')
                    ]),
                    
                    React.createElement('form', {
                        key: 'form',
                        onSubmit: handleSubmit,
                        className: 'space-y-6'
                    }, [
                        React.createElement('div', {
                            key: 'name-row',
                            className: 'grid grid-cols-1 md:grid-cols-2 gap-4'
                        }, [
                            React.createElement('div', { key: 'name' }, [
                                React.createElement('label', {
                                    key: 'label',
                                    className: 'block text-sm font-semibold text-gray-700 mb-2'
                                }, t('sectionName')),
                                React.createElement('input', {
                                    key: 'input',
                                    type: 'text',
                                    className: `input-field ${errors.name ? 'border-red-500' : ''}`,
                                    value: formData.name,
                                    onChange: (e) => setFormData({...formData, name: e.target.value}),
                                    placeholder: 'e.g., Appetizers, Main Courses'
                                }),
                                errors.name && React.createElement('p', {
                                    key: 'error',
                                    className: 'text-red-500 text-xs mt-1'
                                }, errors.name)
                            ]),
                            React.createElement('div', { key: 'nameAr' }, [
                                React.createElement('label', {
                                    key: 'label',
                                    className: 'block text-sm font-semibold text-gray-700 mb-2'
                                }, t('sectionNameAr')),
                                React.createElement('input', {
                                    key: 'input',
                                    type: 'text',
                                    className: 'input-field',
                                    value: formData.nameAr,
                                    onChange: (e) => setFormData({...formData, nameAr: e.target.value}),
                                    dir: 'rtl',
                                    placeholder: 'مثال: المقبلات، الأطباق الرئيسية'
                                })
                            ])
                        ]),
                        
                        React.createElement('div', {
                            key: 'desc-row',
                            className: 'grid grid-cols-1 md:grid-cols-2 gap-4'
                        }, [
                            React.createElement('div', { key: 'desc' }, [
                                React.createElement('label', {
                                    key: 'label',
                                    className: 'block text-sm font-semibold text-gray-700 mb-2'
                                }, t('sectionDesc')),
                                React.createElement('textarea', {
                                    key: 'input',
                                    className: 'input-field',
                                    rows: 3,
                                    value: formData.description,
                                    onChange: (e) => setFormData({...formData, description: e.target.value}),
                                    placeholder: 'Optional description for this section'
                                })
                            ]),
                            React.createElement('div', { key: 'descAr' }, [
                                React.createElement('label', {
                                    key: 'label',
                                    className: 'block text-sm font-semibold text-gray-700 mb-2'
                                }, t('sectionDescAr')),
                                React.createElement('textarea', {
                                    key: 'input',
                                    className: 'input-field',
                                    rows: 3,
                                    value: formData.descriptionAr,
                                    onChange: (e) => setFormData({...formData, descriptionAr: e.target.value}),
                                    dir: 'rtl',
                                    placeholder: 'وصف اختياري لهذا القسم'
                                })
                            ])
                        ]),
                        
                        React.createElement('div', {
                            key: 'buttons',
                            className: 'flex gap-3 pt-6 border-t border-gray-200'
                        }, [
                            React.createElement('button', {
                                key: 'save',
                                type: 'submit',
                                className: 'btn btn-primary flex-1',
                                disabled: isSaving
                            }, isSaving ? [
                                React.createElement('div', {
                                    key: 'spinner',
                                    className: 'loading-spinner mr-2'
                                }),
                                t('saving')
                            ] : t('save')),
                            React.createElement('button', {
                                key: 'cancel',
                                type: 'button',
                                className: 'btn btn-secondary flex-1',
                                onClick: onClose,
                                disabled: isSaving
                            }, t('cancel'))
                        ])
                    ])
                ])
            );
        }

        // Enhanced Menu Preview with customization support
        function MenuPreview({ menu, sections, viewMode, language }) {
            const { t } = useLanguage();
            const { customization } = useCustomization();
            
            const renderMenuItem = (item) => {
                const displayName = language === 'ar' && item.nameAr ? item.nameAr : item.name;
                const displayDesc = language === 'ar' && item.descriptionAr ? item.descriptionAr : item.description;
                
                return React.createElement('div', {
                    key: item.id,
                    className: `menu-item enhanced-hover section-slide-in ${customization.textSize} ${customization.cardLayout}`
                }, [
                    React.createElement('div', {
                        key: 'content',
                        className: 'flex justify-between items-start gap-4'
                    }, [
                        React.createElement('div', {
                            key: 'left',
                            className: 'flex-1'
                        }, [
                            React.createElement('div', {
                                key: 'header',
                                className: 'flex items-center gap-2 mb-2'
                            }, [
                                React.createElement('h4', {
                                    key: 'name',
                                    className: 'font-semibold text-gray-800 text-lg'
                                }, displayName),
                                item.isPopular && React.createElement('span', {
                                    key: 'popular',
                                    className: 'bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded-full'
                                }, '⭐ Popular'),
                                item.isSpicy && React.createElement('span', {
                                    key: 'spicy',
                                    className: 'text-red-500 text-lg'
                                }, '🌶️'),
                                item.isVegetarian && React.createElement('span', {
                                    key: 'veg',
                                    className: 'text-green-500 text-lg'
                                }, '🌱'),
                                item.isVegan && React.createElement('span', {
                                    key: 'vegan',
                                    className: 'text-green-600 text-lg'
                                }, '🌿'),
                                item.isGlutenFree && React.createElement('span', {
                                    key: 'gf',
                                    className: 'bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full'
                                }, 'GF')
                            ]),
                            displayDesc && React.createElement('p', {
                                key: 'desc',
                                className: 'text-gray-600 mb-3 leading-relaxed'
                            }, displayDesc),
                            (item.image || item.model3d) && React.createElement('div', {
                                key: 'media',
                                className: 'mb-3'
                            }, [
                                item.image ? React.createElement('img', {
                                    key: 'img',
                                    src: item.image,
                                    alt: displayName,
                                    className: 'w-20 h-20 object-cover rounded-lg border border-gray-200'
                                }) : item.model3d ? React.createElement('div', {
                                    key: '3d',
                                    className: 'inline-flex items-center gap-2 text-sm text-blue-600 bg-blue-50 px-3 py-2 rounded-lg border border-blue-200'
                                }, [
                                    React.createElement('span', { key: 'icon' }, '🎮'),
                                    React.createElement('span', { key: 'text' }, '3D Model Available')
                                ]) : null
                            ])
                        ]),
                        React.createElement('div', {
                            key: 'price',
                            className: 'font-bold text-xl text-gray-800 flex-shrink-0'
                        }, `$${parseFloat(item.price || 0).toFixed(2)}`)
                    ])
                ]);
            };

            const containerClass = viewMode === 'mobile' ? 'max-w-sm mx-auto' : 
                                 viewMode === 'tablet' ? 'max-w-2xl mx-auto' : 
                                 'max-w-4xl mx-auto';

            const fontClass = customization.fontFamily || (menu.fontFamily === 'serif' ? 'font-serif' : 
                             menu.fontFamily === 'sans' ? 'font-sans' : '');

            const colorGradient = menu.colorScheme === 'indigo' ? 'from-indigo-500 to-purple-600' :
                                 menu.colorScheme === 'emerald' ? 'from-emerald-500 to-teal-600' :
                                 menu.colorScheme === 'amber' ? 'from-amber-500 to-orange-600' :
                                 'from-rose-500 to-pink-600';

            const customStyle = {
                backgroundColor: customization.backgroundColor,
                backgroundImage: customization.backgroundImage ? `url(${customization.backgroundImage})` : '',
                '--primary-color': customization.customColors.primary,
                '--secondary-color': customization.customColors.secondary
            };

            if (viewMode === 'mobile') {
                return React.createElement('div', {
                    className: 'preview-phone mx-auto'
                }, [
                    React.createElement('div', {
                        key: 'screen',
                        className: 'preview-phone-screen overflow-y-auto'
                    }, [
                        React.createElement('div', {
                            key: 'content',
                            className: `${containerClass} bg-white rounded-lg shadow-lg overflow-hidden h-full ${fontClass}`
                        }, [
                            React.createElement('div', {
                                key: 'header',
                                className: `p-4 text-white bg-gradient-to-r ${colorGradient}`
                            }, [
                                React.createElement('h1', {
                                    key: 'name',
                                    className: 'text-xl font-bold mb-1'
                                }, menu.restaurantName || t('restaurantName')),
                                menu.tagline && React.createElement('p', {
                                    key: 'tagline',
                                    className: 'opacity-90 text-sm'
                                }, menu.tagline)
                            ]),
                            React.createElement('div', {
                                key: 'content',
                                className: 'p-4'
                            }, sections.length > 0 ? sections.map(section => {
                                const sectionName = language === 'ar' && section.nameAr ? section.nameAr : section.name;
                                const sectionDesc = language === 'ar' && section.descriptionAr ? section.descriptionAr : section.description;
                                
                                return React.createElement('div', {
                                    key: section.id,
                                    className: 'mb-6'
                                }, [
                                    React.createElement('h2', {
                                        key: 'title',
                                        className: 'text-lg font-bold text-gray-800 mb-2 border-b border-gray-200 pb-1'
                                    }, sectionName),
                                    sectionDesc && React.createElement('p', {
                                        key: 'desc',
                                        className: 'text-gray-600 mb-3 text-sm'
                                    }, sectionDesc),
                                    React.createElement('div', {
                                        key: 'items'
                                    }, section.items.map(renderMenuItem))
                                ]);
                            }) : React.createElement('div', {
                                key: 'empty',
                                className: 'text-center text-gray-500 py-8'
                            }, t('noSections')))
                        ])
                    ])
                ]);
            }

            return React.createElement('div', {
                className: `${containerClass} bg-white rounded-lg shadow-lg overflow-hidden ${fontClass} ${customization.cardLayout} rtl-smooth`,
                dir: language === 'ar' ? 'rtl' : 'ltr',
                style: customStyle
            }, [
                React.createElement('div', {
                    key: 'header',
                    className: `p-8 text-white bg-gradient-to-r ${colorGradient}`
                }, [
                    React.createElement('h1', {
                        key: 'name',
                        className: 'text-4xl font-bold mb-3'
                    }, menu.restaurantName || t('restaurantName')),
                    menu.tagline && React.createElement('p', {
                        key: 'tagline',
                        className: 'opacity-90 text-xl'
                    }, menu.tagline)
                ]),
                React.createElement('div', {
                    key: 'content',
                    className: 'p-8'
                }, sections.length > 0 ? sections.map(section => {
                    const sectionName = language === 'ar' && section.nameAr ? section.nameAr : section.name;
                    const sectionDesc = language === 'ar' && section.descriptionAr ? section.descriptionAr : section.description;
                    
                    return React.createElement('div', {
                        key: section.id,
                        className: 'mb-10'
                    }, [
                        React.createElement('h2', {
                            key: 'title',
                            className: 'text-3xl font-bold text-gray-800 mb-4 border-b-2 border-gray-200 pb-3'
                        }, sectionName),
                        sectionDesc && React.createElement('p', {
                            key: 'desc',
                            className: 'text-gray-600 mb-6'
                        }, sectionDesc),
                        React.createElement('div', {
                            key: 'items',
                            className: 'space-y-1'
                        }, section.items.map(renderMenuItem))
                    ]);
                }) : React.createElement('div', {
                    key: 'empty',
                    className: 'text-center text-gray-500 py-12'
                }, [
                    React.createElement('div', {
                        key: 'icon',
                        className: 'text-6xl mb-4'
                    }, '📋'),
                    React.createElement('h3', {
                        key: 'title',
                        className: 'text-xl font-semibold mb-2'
                    }, t('noSections')),
                    React.createElement('p', {
                        key: 'desc',
                        className: 'text-gray-400'
                    }, 'Add your first section to get started!')
                ]))
            ]);
        }

        // Enhanced Share Modal with QR code generation
        function ShareModal({ isOpen, onClose, menu }) {
            const { t, isRTL } = useLanguage();
            const { addToast } = useToast();
            const [qrCodeUrl, setQrCodeUrl] = useState('');
            const [isGeneratingQR, setIsGeneratingQR] = useState(false);
            const canvasRef = useRef(null);
            
            const shareUrl = `https://your-domain.com/menu/${menu.restaurantName?.toLowerCase().replace(/\s+/g, '-') || 'my-restaurant'}`;

            useEffect(() => {
                if (isOpen && typeof QRCode !== 'undefined') {
                    setIsGeneratingQR(true);
                    QRCode.toCanvas(canvasRef.current, shareUrl, {
                        width: 200,
                        margin: 2,
                        color: {
                            dark: '#000000',
                            light: '#FFFFFF'
                        }
                    }, (error) => {
                        setIsGeneratingQR(false);
                        if (error) {
                            console.error('QR Code generation failed:', error);
                            addToast('Failed to generate QR code', 'error');
                        } else {
                            setQrCodeUrl(canvasRef.current.toDataURL());
                        }
                    });
                }
            }, [isOpen, shareUrl, addToast]);

            const copyToClipboard = async () => {
                try {
                    await navigator.clipboard.writeText(shareUrl);
                    addToast(t('linkCopied'), 'success');
                } catch (error) {
                    addToast('Failed to copy link', 'error');
                }
            };

            const downloadQRCode = () => {
                if (qrCodeUrl) {
                    const link = document.createElement('a');
                    link.download = `${menu.restaurantName || 'menu'}-qr-code.png`;
                    link.href = qrCodeUrl;
                    link.click();
                    addToast('QR code downloaded!', 'success');
                }
            };

            if (!isOpen) return null;

            return React.createElement('div', { className: 'modal' },
                React.createElement('div', {
                    className: `modal-content text-center animate-slide-up ${isRTL ? 'rtl' : ''}`,
                    dir: isRTL ? 'rtl' : 'ltr'
                }, [
                    React.createElement('div', {
                        key: 'header',
                        className: 'mb-6'
                    }, [
                        React.createElement('div', {
                            key: 'success-icon',
                            className: 'text-6xl mb-4'
                        }, '🎉'),
                        React.createElement('h2', {
                            key: 'title',
                            className: 'text-3xl font-bold text-green-600 mb-2'
                        }, t('published')),
                        React.createElement('p', {
                            key: 'subtitle',
                            className: 'text-gray-600 text-lg'
                        }, t('shareLink'))
                    ]),
                    
                    React.createElement('div', {
                        key: 'share-section',
                        className: 'space-y-6'
                    }, [
                        React.createElement('div', {
                            key: 'url-container',
                            className: 'bg-gray-50 border-2 border-gray-200 rounded-xl p-4'
                        }, [
                            React.createElement('div', {
                                key: 'url-display',
                                className: 'flex gap-3'
                            }, [
                                React.createElement('input', {
                                    key: 'url',
                                    type: 'text',
                                    value: shareUrl,
                                    readOnly: true,
                                    className: 'flex-1 bg-transparent outline-none text-sm font-mono'
                                }),
                                React.createElement('button', {
                                    key: 'copy',
                                    className: 'btn btn-primary',
                                    onClick: copyToClipboard
                                }, t('copyLink'))
                            ])
                        ]),
                        
                        React.createElement('div', {
                            key: 'qr-section',
                            className: 'space-y-4'
                        }, [
                            React.createElement('h3', {
                                key: 'qr-title',
                                className: 'text-xl font-semibold text-gray-800'
                            }, t('qrCode')),
                            
                            React.createElement('div', {
                                key: 'qr-container',
                                className: 'qr-container mx-auto'
                            }, [
                                isGeneratingQR ? React.createElement('div', {
                                    key: 'loading',
                                    className: 'flex flex-col items-center justify-center w-48 h-48'
                                }, [
                                    React.createElement('div', {
                                        key: 'spinner',
                                        className: 'loading-spinner mb-3'
                                    }),
                                    React.createElement('p', {
                                        key: 'text',
                                        className: 'text-gray-600'
                                    }, 'Generating QR Code...')
                                ]) : React.createElement('canvas', {
                                    key: 'canvas',
                                    ref: canvasRef,
                                    className: 'mx-auto'
                                })
                            ]),
                            
                            qrCodeUrl && React.createElement('button', {
                                key: 'download',
                                className: 'btn btn-secondary',
                                onClick: downloadQRCode
                            }, t('downloadQR'))
                        ]),
                        
                        React.createElement('div', {
                            key: 'social-share',
                            className: 'pt-6 border-t border-gray-200'
                        }, [
                            React.createElement('h4', {
                                key: 'title',
                                className: 'font-semibold mb-3'
                            }, 'Share on Social Media'),
                            React.createElement('div', {
                                key: 'buttons',
                                className: 'flex justify-center gap-3'
                            }, [
                                ['Facebook', '📘', `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareUrl)}`],
                                ['Twitter', '🐦', `https://twitter.com/intent/tweet?url=${encodeURIComponent(shareUrl)}&text=Check out our menu!`],
                                ['WhatsApp', '💬', `https://wa.me/?text=${encodeURIComponent(`Check out our menu: ${shareUrl}`)}`]
                            ].map(([name, icon, url]) => 
                                React.createElement('a', {
                                    key: name,
                                    href: url,
                                    target: '_blank',
                                    rel: 'noopener noreferrer',
                                    className: 'btn btn-secondary flex items-center gap-2'
                                }, [
                                    React.createElement('span', { key: 'icon' }, icon),
                                    React.createElement('span', { key: 'name' }, name)
                                ])
                            ))
                        ])
                    ]),
                    
                    React.createElement('button', {
                        key: 'close',
                        className: 'btn btn-secondary mt-8',
                        onClick: onClose
                    }, t('cancel'))
                ])
            );
        }

        // Main Menu Editor Component
        function MenuEditor({ template, onBack }) {
            const { t, isRTL, language } = useLanguage();
            const { addToast } = useToast();
            const { user } = useAuth();
            const { customization } = useCustomization();
            
            // State management
            const [menu, setMenu] = useState({
                restaurantName: '',
                tagline: '',
                colorScheme: template.colorScheme,
                fontFamily: template.fontFamily,
                headerStyle: template.headerStyle,
                spacing: template.spacing
            });
            
            const [sections, setSections] = useState([]);
            const [viewMode, setViewMode] = useState('desktop');
            const [editingItem, setEditingItem] = useState(null);
            const [editingSection, setEditingSection] = useState(null);
            const [showItemModal, setShowItemModal] = useState(false);
            const [showSectionModal, setShowSectionModal] = useState(false);
            const [showShareModal, setShowShareModal] = useState(false);
            const [currentSectionId, setCurrentSectionId] = useState(null);
            const [isSaving, setIsSaving] = useState(false);
            const [showCustomizationPanel, setShowCustomizationPanel] = useState(false);

            // Load saved data on component mount
            useEffect(() => {
                const savedMenu = storage.load('currentMenu');
                const savedSections = storage.load('currentSections', []);
                
                if (savedMenu) {
                    setMenu(prev => ({ ...prev, ...savedMenu }));
                }
                if (savedSections.length > 0) {
                    setSections(savedSections);
                }
            }, []);

            // Auto-save functionality
            useEffect(() => {
                const saveData = () => {
                    storage.save('currentMenu', menu);
                    storage.save('currentSections', sections);
                };
                
                const timeoutId = setTimeout(saveData, 1000);
                return () => clearTimeout(timeoutId);
            }, [menu, sections]);

            // Section management
            const addSection = useCallback(async (sectionData) => {
                const newSection = {
                    id: Date.now(),
                    ...sectionData,
                    items: []
                };
                setSections(prev => [...prev, newSection]);
            }, []);

            const editSection = useCallback(async (sectionData) => {
                setSections(prev => prev.map(s => 
                    s.id === editingSection.id ? { ...s, ...sectionData } : s
                ));
                setEditingSection(null);
            }, [editingSection]);

            const deleteSection = useCallback((sectionId) => {
                setSections(prev => prev.filter(s => s.id !== sectionId));
                addToast('Section deleted successfully', 'success');
            }, [addToast]);

            const duplicateSection = useCallback((section) => {
                const newSection = {
                    ...section,
                    id: Date.now(),
                    name: `${section.name} (Copy)`,
                    nameAr: section.nameAr ? `${section.nameAr} (نسخة)` : '',
                    items: section.items.map(item => ({
                        ...item,
                        id: Date.now() + Math.random()
                    }))
                };
                setSections(prev => [...prev, newSection]);
                addToast('Section duplicated successfully', 'success');
            }, [addToast]);

            // Item management
            const addItem = useCallback(async (itemData) => {
                const newItem = {
                    id: Date.now(),
                    ...itemData
                };
                setSections(prev => prev.map(s => 
                    s.id === currentSectionId 
                        ? { ...s, items: [...s.items, newItem] }
                        : s
                ));
            }, [currentSectionId]);

            const editItem = useCallback(async (itemData) => {
                setSections(prev => prev.map(s => ({
                    ...s,
                    items: s.items.map(i => 
                        i.id === editingItem.id ? { ...i, ...itemData } : i
                    )
                })));
                setEditingItem(null);
            }, [editingItem]);

            const deleteItem = useCallback((sectionId, itemId) => {
                setSections(prev => prev.map(s => 
                    s.id === sectionId 
                        ? { ...s, items: s.items.filter(i => i.id !== itemId) }
                        : s
                ));
                addToast('Item deleted successfully', 'success');
            }, [addToast]);

            const duplicateItem = useCallback((sectionId, item) => {
                const newItem = {
                    ...item,
                    id: Date.now(),
                    name: `${item.name} (Copy)`
                };
                setSections(prev => prev.map(s => 
                    s.id === sectionId 
                        ? { ...s, items: [...s.items, newItem] }
                        : s
                ));
                addToast('Item duplicated successfully', 'success');
            }, [addToast]);

            // Save and publish handlers
            const handleSave = useCallback(async () => {
                setIsSaving(true);
                try {
                    // Simulate saving to server
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    storage.save('publishedMenu', { menu, sections });
                    addToast(t('menuSaved'), 'success');
                } catch (error) {
                    addToast('Failed to save menu', 'error');
                } finally {
                    setIsSaving(false);
                }
            }, [menu, sections, addToast, t]);

            const handlePublish = useCallback(() => {
                if (!menu.restaurantName) {
                    addToast('Please enter a restaurant name before publishing', 'error');
                    return;
                }
                if (sections.length === 0) {
                    addToast('Please add at least one section before publishing', 'error');
                    return;
                }
                
                storage.save('publishedMenu', { menu, sections });
                setShowShareModal(true);
            }, [menu, sections, addToast]);

            return React.createElement('div', {
                className: `min-h-screen bg-gray-50 ${isRTL ? 'rtl' : ''}`,
                dir: isRTL ? 'rtl' : 'ltr'
            }, [
                // Header
                React.createElement('div', {
                    key: 'header',
                    className: 'bg-white shadow-sm border-b px-6 py-4 sticky top-0 z-40'
                }, [
                    React.createElement('div', {
                        key: 'header-content',
                        className: 'flex items-center justify-between max-w-7xl mx-auto'
                    }, [
                        React.createElement('div', {
                            key: 'left',
                            className: 'flex items-center gap-4'
                        }, [
                            React.createElement('button', {
                                key: 'back',
                                className: 'btn btn-secondary',
                                onClick: onBack
                            }, '← ' + (isRTL ? 'رجوع' : 'Back')),
                            React.createElement('h1', {
                                key: 'title',
                                className: 'text-2xl font-bold text-gray-800'
                            }, t('menuEditor'))
                        ]),
                        
                        React.createElement('div', {
                            key: 'right',
                            className: 'flex items-center gap-4'
                        }, [
                            user && React.createElement('span', {
                                key: 'user-info',
                                className: 'text-sm text-gray-600'
                            }, `Welcome, ${user.name}`),

                            React.createElement('button', {
                                key: 'customize',
                                className: 'btn btn-secondary btn-custom',
                                onClick: () => setShowCustomizationPanel(true)
                            }, '🎨 Customize'),

                            React.createElement('div', {
                                key: 'view-toggle',
                                className: 'flex bg-gray-100 rounded-lg p-1'
                            }, [
                                ['desktop', '🖥️'],
                                ['tablet', '📱'],
                                ['mobile', '📱']
                            ].map(([mode, icon]) => 
                                React.createElement('button', {
                                    key: mode,
                                    className: `px-3 py-2 rounded flex items-center gap-2 transition-all enhanced-hover ${
                                        viewMode === mode ? 'bg-white shadow text-blue-600' : 'text-gray-600 hover:text-gray-800'
                                    }`,
                                    onClick: () => setViewMode(mode)
                                }, [
                                    React.createElement('span', { key: 'icon' }, icon),
                                    React.createElement('span', { key: 'text' }, t(mode))
                                ])
                            )),
                            
                            React.createElement('button', {
                                key: 'save',
                                className: 'btn btn-secondary btn-custom',
                                onClick: handleSave,
                                disabled: isSaving,
                                style: { backgroundColor: customization.buttonColor }
                            }, isSaving ? [
                                React.createElement('div', {
                                    key: 'spinner',
                                    className: 'loading-spinner mr-2'
                                }),
                                t('saving')
                            ] : t('save')),
                            
                            React.createElement('button', {
                                key: 'publish',
                                className: 'btn btn-primary btn-custom',
                                onClick: handlePublish,
                                style: { backgroundColor: customization.buttonColor }
                            }, t('publish'))
                        ])
                    ])
                ]),

                // Main Content
                React.createElement('div', {
                    key: 'main',
                    className: 'flex max-w-7xl mx-auto min-h-screen'
                }, [
                    // Sidebar
                    React.createElement('div', {
                        key: 'sidebar',
                        className: 'sidebar w-80 p-6 h-screen overflow-y-auto sticky top-16'
                    }, [
                        // Restaurant Info
                        React.createElement('div', {
                            key: 'restaurant-info',
                            className: 'mb-8'
                        }, [
                            React.createElement('h2', {
                                key: 'title',
                                className: 'font-bold text-lg mb-4 text-gray-800'
                            }, t('restaurantInfo')),
                            React.createElement('div', {
                                key: 'fields',
                                className: 'space-y-4'
                            }, [
                                React.createElement('div', { key: 'name' }, [
                                    React.createElement('label', {
                                        key: 'label',
                                        className: 'block text-sm font-semibold text-gray-700 mb-2'
                                    }, t('restaurantName')),
                                    React.createElement('input', {
                                        key: 'input',
                                        type: 'text',
                                        className: 'input-field',
                                        value: menu.restaurantName,
                                        onChange: (e) => setMenu(prev => ({...prev, restaurantName: e.target.value})),
                                        placeholder: t('enterRestaurantName')
                                    })
                                ]),
                                React.createElement('div', { key: 'tagline' }, [
                                    React.createElement('label', {
                                        key: 'label',
                                        className: 'block text-sm font-semibold text-gray-700 mb-2'
                                    }, t('tagline')),
                                    React.createElement('input', {
                                        key: 'input',
                                        type: 'text',
                                        className: 'input-field',
                                        value: menu.tagline,
                                        onChange: (e) => setMenu(prev => ({...prev, tagline: e.target.value})),
                                        placeholder: t('enterTagline')
                                    })
                                ])
                            ])
                        ]),

                        // Design Settings
                        React.createElement('div', {
                            key: 'design',
                            className: 'mb-8'
                        }, [
                            React.createElement('h2', {
                                key: 'title',
                                className: 'font-bold text-lg mb-4 text-gray-800'
                            }, t('design')),
                            React.createElement('div', {
                                key: 'fields',
                                className: 'space-y-4'
                            }, [
                                React.createElement('div', { key: 'color' }, [
                                    React.createElement('label', {
                                        key: 'label',
                                        className: 'block text-sm font-semibold text-gray-700 mb-2'
                                    }, t('colorScheme')),
                                    React.createElement('select', {
                                        key: 'select',
                                        className: 'input-field',
                                        value: menu.colorScheme,
                                        onChange: (e) => setMenu(prev => ({...prev, colorScheme: e.target.value}))
                                    }, [
                                        React.createElement('option', { key: 'indigo', value: 'indigo' }, 'Indigo Purple'),
                                        React.createElement('option', { key: 'emerald', value: 'emerald' }, 'Emerald Green'),
                                        React.createElement('option', { key: 'amber', value: 'amber' }, 'Amber Gold'),
                                        React.createElement('option', { key: 'rose', value: 'rose' }, 'Rose Pink')
                                    ])
                                ]),
                                React.createElement('div', { key: 'font' }, [
                                    React.createElement('label', {
                                        key: 'label',
                                        className: 'block text-sm font-semibold text-gray-700 mb-2'
                                    }, t('fontFamily')),
                                    React.createElement('select', {
                                        key: 'select',
                                        className: 'input-field',
                                        value: menu.fontFamily,
                                        onChange: (e) => setMenu(prev => ({...prev, fontFamily: e.target.value}))
                                    }, [
                                        React.createElement('option', { key: 'inter', value: 'inter' }, 'Inter (Modern)'),
                                        React.createElement('option', { key: 'serif', value: 'serif' }, 'Playfair (Elegant)'),
                                        React.createElement('option', { key: 'sans', value: 'sans' }, 'System (Clean)')
                                    ])
                                ])
                            ])
                        ]),

                        // Sections
                        React.createElement('div', { key: 'sections' }, [
                            React.createElement('div', {
                                key: 'header',
                                className: 'flex items-center justify-between mb-4'
                            }, [
                                React.createElement('h2', {
                                    key: 'title',
                                    className: 'font-bold text-lg text-gray-800'
                                }, t('sections')),
                                React.createElement('button', {
                                    key: 'add',
                                    className: 'btn btn-primary text-sm',
                                    onClick: () => {
                                        setEditingSection(null);
                                        setShowSectionModal(true);
                                    }
                                }, '+ ' + t('addSection'))
                            ]),
                            
                            React.createElement('div', {
                                key: 'list',
                                className: 'space-y-3'
                            }, sections.length > 0 ? sections.map(section => 
                                React.createElement('div', {
                                    key: section.id,
                                    className: 'section-card'
                                }, [
                                    React.createElement('div', {
                                        key: 'header',
                                        className: 'flex items-center justify-between mb-3'
                                    }, [
                                        React.createElement('h3', {
                                            key: 'name',
                                            className: 'font-semibold text-gray-800'
                                        }, section.name),
                                        React.createElement('div', {
                                            key: 'actions',
                                            className: 'flex gap-1'
                                        }, [
                                            React.createElement('button', {
                                                key: 'edit',
                                                className: 'text-blue-600 hover:text-blue-800 text-sm p-1',
                                                onClick: () => {
                                                    setEditingSection(section);
                                                    setShowSectionModal(true);
                                                }
                                            }, '✏️'),
                                            React.createElement('button', {
                                                key: 'duplicate',
                                                className: 'text-green-600 hover:text-green-800 text-sm p-1',
                                                onClick: () => duplicateSection(section)
                                            }, '📋'),
                                            React.createElement('button', {
                                                key: 'delete',
                                                className: 'text-red-600 hover:text-red-800 text-sm p-1',
                                                onClick: () => deleteSection(section.id)
                                            }, '🗑️')
                                        ])
                                    ]),
                                    
                                    React.createElement('div', {
                                        key: 'items',
                                        className: 'space-y-2'
                                    }, [
                                        ...section.items.map(item => 
                                            React.createElement('div', {
                                                key: item.id,
                                                className: 'item-card flex items-center justify-between'
                                            }, [
                                                React.createElement('div', {
                                                    key: 'info',
                                                    className: 'flex-1'
                                                }, [
                                                    React.createElement('span', {
                                                        key: 'name',
                                                        className: 'font-medium text-sm'
                                                    }, item.name),
                                                    React.createElement('span', {
                                                        key: 'price',
                                                        className: 'text-gray-600 text-sm ml-2'
                                                    }, `$${item.price}`)
                                                ]),
                                                React.createElement('div', {
                                                    key: 'actions',
                                                    className: 'flex gap-1'
                                                }, [
                                                    React.createElement('button', {
                                                        key: 'edit',
                                                        className: 'text-blue-600 hover:text-blue-800 text-xs p-1',
                                                        onClick: () => {
                                                            setEditingItem(item);
                                                            setShowItemModal(true);
                                                        }
                                                    }, '✏️'),
                                                    React.createElement('button', {
                                                        key: 'duplicate',
                                                        className: 'text-green-600 hover:text-green-800 text-xs p-1',
                                                        onClick: () => duplicateItem(section.id, item)
                                                    }, '📋'),
                                                    React.createElement('button', {
                                                        key: 'delete',
                                                        className: 'text-red-600 hover:text-red-800 text-xs p-1',
                                                        onClick: () => deleteItem(section.id, item.id)
                                                    }, '🗑️')
                                                ])
                                            ])
                                        ),
                                        React.createElement('button', {
                                            key: 'add-item',
                                            className: 'w-full text-left text-sm text-blue-600 hover:text-blue-800 p-2 hover:bg-blue-50 rounded transition-colors',
                                            onClick: () => {
                                                setCurrentSectionId(section.id);
                                                setEditingItem(null);
                                                setShowItemModal(true);
                                            }
                                        }, `+ ${t('addItem')}`)
                                    ])
                                ])
                            ) : React.createElement('div', {
                                key: 'empty',
                                className: 'text-center py-8 text-gray-500'
                            }, [
                                React.createElement('div', {
                                    key: 'icon',
                                    className: 'text-4xl mb-3'
                                }, '📝'),
                                React.createElement('p', {
                                    key: 'text',
                                    className: 'text-sm'
                                }, t('noSections'))
                            ]))
                        ])
                    ]),

                    // Preview Area
                    React.createElement('div', {
                        key: 'preview',
                        className: 'preview-area flex-1 p-6 overflow-y-auto'
                    }, [
                        React.createElement(MenuPreview, {
                            key: 'preview-component',
                            menu: menu,
                            sections: sections,
                            viewMode: viewMode,
                            language: language
                        })
                    ])
                ]),

                // Modals
                React.createElement(ItemEditModal, {
                    key: 'item-modal',
                    isOpen: showItemModal,
                    onClose: () => setShowItemModal(false),
                    onSave: editingItem ? editItem : addItem,
                    item: editingItem
                }),
                React.createElement(SectionEditModal, {
                    key: 'section-modal',
                    isOpen: showSectionModal,
                    onClose: () => setShowSectionModal(false),
                    onSave: editingSection ? editSection : addSection,
                    section: editingSection
                }),
                React.createElement(ShareModal, {
                    key: 'share-modal',
                    isOpen: showShareModal,
                    onClose: () => setShowShareModal(false),
                    menu: menu
                }),

                React.createElement(CustomizationPanel, {
                    key: 'customization-panel',
                    isOpen: showCustomizationPanel,
                    onClose: () => setShowCustomizationPanel(false)
                })
            ]);
        }

        // Enhanced Language Toggle Component
        function LanguageToggle() {
            const { language, toggleLanguage } = useLanguage();
            
            return React.createElement('button', {
                className: 'language-toggle enhanced-hover rtl-smooth',
                onClick: toggleLanguage
            }, language === 'en' ? '🇸🇦 العربية' : '🇺🇸 English');
        }

        // User Controls Component
        function UserControls() {
            const { user, signOut, setShowAuthModal } = useAuth();
            const { t } = useLanguage();

            if (!user) {
                return React.createElement('div', {
                    className: 'fixed top-20 right-4 z-50 flex gap-2'
                }, [
                    React.createElement('button', {
                        key: 'login',
                        className: 'btn btn-ghost btn-sm',
                        onClick: () => setShowAuthModal(true)
                    }, 'Sign In'),
                    React.createElement('button', {
                        key: 'signup',
                        className: 'btn btn-primary btn-sm',
                        onClick: () => setShowAuthModal(true)
                    }, 'Sign Up')
                ]);
            }

            return React.createElement('div', {
                className: 'fixed top-20 right-4 z-50 glass-effect rounded-lg p-2'
            }, [
                React.createElement('div', {
                    key: 'user-info',
                    className: 'flex items-center gap-3 px-3 py-2'
                }, [
                    React.createElement('div', {
                        key: 'avatar',
                        className: 'w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-bold'
                    }, user.name.charAt(0).toUpperCase()),
                    React.createElement('span', {
                        key: 'name',
                        className: 'text-white text-sm font-medium'
                    }, user.name)
                ]),
                React.createElement('button', {
                    key: 'signout',
                    className: 'btn btn-ghost btn-sm text-white hover:bg-white hover:bg-opacity-20 w-full',
                    onClick: signOut
                }, 'Sign Out')
            ]);
        }

        // Toast Container
        function ToastContainer() {
            const { toasts, removeToast } = useToast();
            
            return React.createElement('div', {
                className: 'fixed top-20 right-4 z-50 space-y-2'
            }, toasts.map(toast => 
                React.createElement(Toast, {
                    key: toast.id,
                    toast: toast,
                    onRemove: removeToast
                })
            ));
        }

        // Main App Component
        function App() {
            const [currentStep, setCurrentStep] = useState('template');
            const [selectedTemplate, setSelectedTemplate] = useState(null);

            const handleSelectTemplate = (template) => {
                setSelectedTemplate(template);
                setCurrentStep('editor');
            };

            const handleBackToTemplates = () => {
                setCurrentStep('template');
                setSelectedTemplate(null);
                // Clear saved data
                storage.remove('currentMenu');
                storage.remove('currentSections');
            };

            return React.createElement('div', { 
                className: 'min-h-screen',
                style: { 
                    background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                    transition: 'all 0.3s ease'
                }
            }, [
                React.createElement(LanguageToggle, { key: 'lang-toggle' }),
                React.createElement(UserControls, { key: 'user-controls' }),
                React.createElement(ToastContainer, { key: 'toasts' }),
                React.createElement('div', { key: 'content' },
                    currentStep === 'template' 
                        ? React.createElement(TemplateSelection, {
                            onSelectTemplate: handleSelectTemplate
                        })
                        : React.createElement(MenuEditor, {
                            template: selectedTemplate,
                            onBack: handleBackToTemplates
                        })
                )
            ]);
        }

        // Root App with Enhanced Providers
        function RootApp() {
            return React.createElement(AuthProvider, null,
                React.createElement(CustomizationProvider, null,
                    React.createElement(LanguageProvider, null,
                        React.createElement(ToastProvider, null, [
                            React.createElement(App, { key: 'app' }),
                            React.createElement(AuthModal, { key: 'auth-modal' })
                        ])
                    )
                )
            );
        }

        // Initialize the app
        ReactDOM.render(React.createElement(RootApp), document.getElementById('root'));
    </script>
</body>
</html>
